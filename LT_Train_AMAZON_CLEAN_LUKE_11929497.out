args: Namespace(act_func='tanh', anneal_cap=0.005, anneal_steps=500, batch_size=200, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', emb_path='../datasets/', emb_size=10, epochs=1000, gpu='1', in_dims='[300]', lamda=0.03, log_name='log', lr1=0.0005, lr2=0.0001, mean_type='x0', mlp_act_func='tanh', mlp_dims='[300]', n_cate=2, noise_max=0.01, noise_min=0.005, noise_scale=0.01, noise_schedule='linear-var', norm=False, num_workers=0, optimizer1='AdamW', optimizer2='AdamW', out_dims='[]', reparam=True, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, vae_anneal_cap=0.3, vae_anneal_steps=200, w_max=1.0, w_min=0.5, wd1=0.0, wd2=0)
args: Namespace(act_func='tanh', anneal_cap=0.005, anneal_steps=500, batch_size=200, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', emb_path='../datasets/', emb_size=10, epochs=1000, gpu='1', in_dims='[300]', lamda=0.03, log_name='log', lr1=0.0005, lr2=0.0001, mean_type='x0', mlp_act_func='tanh', mlp_dims='[300]', n_cate=2, noise_max=0.01, noise_min=0.005, noise_scale=0.01, noise_schedule='linear-var', norm=False, num_workers=0, optimizer1='AdamW', optimizer2='AdamW', out_dims='[]', reparam=True, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, vae_anneal_cap=0.3, vae_anneal_steps=200, w_max=1.0, w_min=0.5, wd1=0.0, wd2=0)
Starting time:  2023-06-15 16:27:20
user num: 108822
item num: 94949
data ready.
emb_path: ./datasets/amazon-book_clean/item_emb.npy
running k-means on cuda:0..
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:00, ?it/s, center_shift=0.066783, iteration=1, tol=0.000100][running kmeans]: 1it [00:00,  7.33it/s, center_shift=0.002020, iteration=2, tol=0.000100][running kmeans]: 2it [00:00, 14.66it/s, center_shift=0.002020, iteration=2, tol=0.000100][running kmeans]: 2it [00:00, 14.66it/s, center_shift=0.000370, iteration=3, tol=0.000100][running kmeans]: 3it [00:00, 14.66it/s, center_shift=0.000044, iteration=4, tol=0.000100][running kmeans]: 4it [00:00, 19.51it/s, center_shift=0.000044, iteration=4, tol=0.000100]