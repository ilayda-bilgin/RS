wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_101820-gl83mhwf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_noisy_1_Visualization
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/gl83mhwf
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0_learnable', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Visualization', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=1, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=True, w_max=1.0, w_min=0.1, weight_decay=0.0)
Starting time:  2023-06-23 10:18:24
user num: 5949
item num: 3494
data ready.
Embedding size: 10
models ready.
Number of all parameters: 7002654
Start training...
Runing Epoch 001 train loss 5267.7868 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 4654.5959 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 4298.8084 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4020.1168 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0354
0.0333
0.0309
0.0279
 0.0269
0.0476
0.1017
0.1653
 0.0407
0.0464
0.0642
0.0865
 0.0913
0.1007
0.1073
0.1091

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0302
0.0279
0.0238
0.0198
 0.0418
0.0747
0.1419
0.2189
 0.0412
0.0522
0.0762
0.1011
 0.0833
0.0925
0.0987
0.1004

Runing Epoch 005 train loss 3786.0733 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 3564.4580 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3373.1069 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3216.4874 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3064.4935 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0345
0.0348
0.034
0.0315
 0.0289
0.0567
0.1251
0.206
 0.0402
0.0495
0.0735
0.1021
 0.0886
0.0995
0.1073
0.1091

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0336
0.0319
0.0282
0.0241
 0.0509
0.092
0.1836
0.2867
 0.0468
0.0618
0.0941
0.1272
 0.0896
0.1003
0.1073
0.1092

Runing Epoch 010 train loss 2937.8463 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 2815.4922 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 2716.2682 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2624.8163 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2533.3757 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.033
0.0346
0.0345
0.0327
 0.0323
0.0632
0.1394
0.2311
 0.0386
0.05
0.0771
0.1094
 0.0807
0.0924
0.1005
0.1025

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0345
0.0334
0.0304
0.0263
 0.059
0.1064
0.2155
0.3356
 0.0494
0.0674
0.1056
0.1434
 0.0878
0.0991
0.1068
0.1088

Runing Epoch 015 train loss 2449.9594 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2380.3789 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2322.4922 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2260.4820 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 019 train loss 2200.4305 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0326
0.0342
0.0346
0.0331
 0.0342
0.0684
0.1501
0.2479
 0.0386
0.0512
0.0804
0.1147
 0.0784
0.0904
0.0989
0.1009

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0353
0.0342
0.0315
0.0271
 0.0654
0.1161
0.2375
0.3655
 0.0524
0.0718
0.1137
0.1536
 0.0899
0.1014
0.1096
0.1117

Runing Epoch 020 train loss 2163.1829 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2109.3719 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2069.4741 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2027.7353 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 1989.0829 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.032
0.0334
0.0346
0.0332
 0.0357
0.0702
0.1567
0.2606
 0.0381
0.0509
0.0819
0.1177
 0.0755
0.0874
0.0962
0.0984

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0346
0.0321
0.0277
 0.0696
0.1239
0.2503
0.3834
 0.0534
0.0741
0.1177
0.1589
 0.0866
0.0982
0.1066
0.1087

Runing Epoch 025 train loss 1954.8156 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 1924.7393 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 1895.1863 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 1867.8774 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 1838.4067 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0317
0.0336
0.0344
0.0335
 0.0376
0.0712
0.1596
0.2674
 0.0389
0.0518
0.0832
0.1203
 0.0756
0.0882
0.0968
0.099

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.036
0.0354
0.0325
0.0278
 0.0718
0.1279
0.2603
0.3949
 0.0552
0.0767
0.1217
0.163
 0.0893
0.1011
0.1095
0.1116

Runing Epoch 030 train loss 1813.7131 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1793.7667 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1768.4412 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1746.6411 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1727.0166 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0314
0.0333
0.0346
0.0332
 0.0382
0.0726
0.1621
0.2684
 0.0389
0.0521
0.0841
0.1208
 0.0754
0.0875
0.0964
0.0985

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0367
0.0357
0.0325
0.0278
 0.0754
0.1319
0.2645
0.3995
 0.0567
0.0784
0.1233
0.1649
 0.0904
0.1022
0.1106
0.1127

Runing Epoch 035 train loss 1710.8015 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1690.6035 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1676.0780 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 038 train loss 1659.5924 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 039 train loss 1644.2263 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0308
0.0324
0.0341
0.0331
 0.0369
0.0726
0.1647
0.2746
 0.038
0.0512
0.0839
0.1214
 0.0748
0.0868
0.096
0.0982

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0359
0.0329
0.0282
 0.0743
0.1349
0.2719
0.4109
 0.0559
0.079
0.1253
0.1679
 0.089
0.1012
0.1099
0.112

Runing Epoch 040 train loss 1625.5738 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1609.1979 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1598.0066 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1587.7579 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1573.2999 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0307
0.0326
0.034
0.0329
 0.037
0.0754
0.1663
0.2752
 0.0385
0.0526
0.0848
0.1221
 0.0751
0.0876
0.0965
0.0987

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0365
0.0356
0.0328
0.0279
 0.077
0.1364
0.2726
0.412
 0.0587
0.0812
0.1274
0.1699
 0.0939
0.106
0.1146
0.1167

Runing Epoch 045 train loss 1557.2534 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1546.6255 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1538.7455 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1522.8398 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1511.3216 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.03
0.0325
0.034
0.0328
 0.0373
0.0735
0.1679
0.2786
 0.0382
0.0518
0.0851
0.1225
 0.0744
0.0872
0.0962
0.0984

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0363
0.0356
0.0327
0.028
 0.077
0.1369
0.2747
0.4166
 0.0567
0.0794
0.1258
0.1688
 0.088
0.1
0.1086
0.1107

Runing Epoch 050 train loss 1506.5156 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1493.7192 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1484.5436 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1472.4604 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1466.0944 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0306
0.0326
0.0339
0.0327
 0.0378
0.0734
0.1672
0.2778
 0.0387
0.0522
0.0851
0.1225
 0.0756
0.0877
0.0971
0.0992

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0365
0.0355
0.0326
0.028
 0.0777
0.1369
0.2761
0.4137
 0.0578
0.0803
0.1271
0.1693
 0.0902
0.1024
0.1109
0.113

Runing Epoch 055 train loss 1454.0570 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1449.0493 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1440.8881 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1427.4991 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1418.9947 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0308
0.0331
0.0341
0.0328
 0.0385
0.076
0.1713
0.2814
 0.0391
0.0532
0.0863
0.1236
 0.0762
0.0887
0.0979
0.1

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.037
0.0358
0.0328
0.028
 0.0781
0.139
0.2786
0.4193
 0.0586
0.0813
0.1283
0.171
 0.0919
0.104
0.1126
0.1148

Runing Epoch 060 train loss 1407.6691 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1405.9620 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1400.0174 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1392.4348 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1383.8948 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0305
0.0325
0.0336
0.0326
 0.0382
0.0738
0.1665
0.2787
 0.0396
0.0528
0.0852
0.1228
 0.0779
0.0903
0.0992
0.1014

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0366
0.0355
0.0323
0.0279
 0.0782
0.1386
0.2754
0.4177
 0.0579
0.0805
0.1265
0.1697
 0.0895
0.1015
0.1101
0.1123

Runing Epoch 065 train loss 1373.2175 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1365.9686 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1362.7889 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1354.0290 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 069 train loss 1348.0794 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0303
0.0324
0.0336
0.0325
 0.0378
0.0738
0.1679
0.2773
 0.039
0.0524
0.0853
0.1223
 0.0766
0.0889
0.0981
0.1003

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0372
0.0357
0.0327
0.028
 0.0796
0.1402
0.2777
0.4168
 0.0586
0.0813
0.1277
0.1701
 0.09
0.1023
0.1109
0.1131

Runing Epoch 070 train loss 1343.6772 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1336.3150 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 072 train loss 1332.5137 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 073 train loss 1323.3181 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 074 train loss 1319.1301 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0307
0.0327
0.0336
0.0325
 0.0388
0.0755
0.1691
0.2791
 0.0395
0.0531
0.0856
0.1228
 0.0767
0.0889
0.0979
0.1001

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0359
0.0357
0.0323
0.0277
 0.0772
0.1398
0.2769
0.4182
 0.0574
0.0812
0.1272
0.1699
 0.0895
0.1019
0.1106
0.1129

Runing Epoch 075 train loss 1310.0853 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 076 train loss 1310.3202 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 077 train loss 1301.9089 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 078 train loss 1296.8624 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 079 train loss 1292.9643 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 060 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0308
0.0331
0.0341
0.0328
 0.0385
0.076
0.1713
0.2814
 0.0391
0.0532
0.0863
0.1236
 0.0762
0.0887
0.0979
0.1

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.037
0.0358
0.0328
0.028
 0.0781
0.139
0.2786
0.4193
 0.0586
0.0813
0.1283
0.171
 0.0919
0.104
0.1126
0.1148

End time:  2023-06-23 10:20:15
params_per_batch.shape: torch.Size([1184, 5, 10])
Saved params_per_batch.npy to mPHATE/T-DiffRec_ml-1m_noisy_1_Visualization_params_per_batch.npy
params_per_batch shape: (1184, 5, 10)
Calculating M-PHATE...
  Calculating multislice kernel...
  Calculated multislice kernel in 4.77 seconds.
  Calculating graph and diffusion operator...
    Calculating landmark operator...
      Calculating SVD...
/var/spool/slurm/slurmd/job11934589/slurm_script: line 24: 21660 Bus error               python ./T-DiffRec/main.py --data_path ./datasets/ --dataset=ml-1m_noisy --cuda --gpu=1 --run_name=Visualization --mean_type=x0_learnable --visualize_weights
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_102025-se5ss7b7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_noisy_1_Visualization
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/se5ss7b7
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/joblib/externals/loky/backend/resource_tracker.py:310: UserWarning: resource_tracker: There appear to be 16 leaked semlock objects to clean up at shutdown
  warnings.warn(
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/joblib/externals/loky/backend/resource_tracker.py:310: UserWarning: resource_tracker: There appear to be 1 leaked folder objects to clean up at shutdown
  warnings.warn(
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0_learnable', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Visualization', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=1, steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=True, w_max=1.0, w_min=0.1, weight_decay=0.0)
Starting time:  2023-06-23 10:20:29
user num: 108822
item num: 178181
data ready.
Embedding size: 10
models ready.
Number of all parameters: 356552291
Start training...
Runing Epoch 001 train loss 12.3743 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 002 train loss 12.0488 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 003 train loss 11.8799 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 004 train loss 11.7760 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0025
0.0019
0.0013
0.0009
 0.0072
0.0106
0.0161
0.0214
 0.0053
0.0063
0.0078
0.0091
 0.0085
0.0092
0.0098
0.01

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0032
0.0024
0.0015
0.001
 0.0135
0.0188
0.0272
0.035
 0.0092
0.0108
0.013
0.0147
 0.0117
0.0125
0.013
0.0132

Runing Epoch 005 train loss 11.4904 costs 00: 38: 31
------------------------------------------------------
Runing Epoch 006 train loss 11.5565 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 007 train loss 11.3371 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 008 train loss 11.2803 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 009 train loss 11.2438 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.001
0.0008
0.0005
0.0003
 0.0027
0.0039
0.0057
0.0074
 0.0021
0.0024
0.0029
0.0033
 0.0035
0.0038
0.004
0.004

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0014
0.001
0.0006
0.0004
 0.0055
0.0074
0.0101
0.0127
 0.004
0.0045
0.0053
0.0058
 0.0052
0.0055
0.0056
0.0057

Runing Epoch 010 train loss 11.1836 costs 00: 38: 22
------------------------------------------------------
Runing Epoch 011 train loss 11.2123 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 012 train loss 11.1823 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 013 train loss 11.1373 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 014 train loss 11.2331 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0025
0.0021
0.0015
0.0011
 0.0071
0.0113
0.019
0.0263
 0.0051
0.0064
0.0084
0.0101
 0.0081
0.0089
0.0097
0.0099

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0036
0.0027
0.0018
0.0012
 0.0152
0.0216
0.0336
0.0444
 0.0102
0.0122
0.0152
0.0175
 0.0125
0.0134
0.0142
0.0145

Runing Epoch 015 train loss 11.2007 costs 00: 38: 30
------------------------------------------------------
Runing Epoch 016 train loss 11.0856 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 017 train loss 10.9575 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 018 train loss 10.9932 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 019 train loss 11.0226 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0052
0.0041
0.0028
0.002
 0.0161
0.0236
0.0368
0.0491
 0.0114
0.0137
0.0173
0.0202
 0.017
0.0185
0.0196
0.0201

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0073
0.0054
0.0035
0.0024
 0.0311
0.0441
0.065
0.0839
 0.0211
0.0251
0.0305
0.0346
 0.0258
0.0276
0.0289
0.0293

Runing Epoch 020 train loss 11.0337 costs 00: 38: 31
------------------------------------------------------
Runing Epoch 021 train loss 10.9916 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 022 train loss 10.9300 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 023 train loss 10.9208 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 024 train loss 10.9653 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.006
0.0047
0.0032
0.0023
 0.0185
0.0273
0.0418
0.0559
 0.0131
0.0157
0.0197
0.023
 0.0193
0.021
0.0223
0.0228

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0083
0.0061
0.0038
0.0026
 0.0356
0.0499
0.0716
0.0931
 0.024
0.0284
0.034
0.0386
 0.0294
0.0313
0.0327
0.0332

Runing Epoch 025 train loss 10.9808 costs 00: 38: 31
------------------------------------------------------
Runing Epoch 026 train loss 10.9683 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 027 train loss 10.9921 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 028 train loss 11.0349 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 029 train loss 11.0315 costs 00: 01: 03
------------------------------------------------------
wandb: Waiting for W&B process to finish... (failed 255). Press Control-C to abort syncing.
wandb: 
wandb: Run summary:
wandb:                 Epoch 30
wandb:      batch_loss_train 0.04295
wandb: epoch_loss_norm_train 0.04005
wandb:           test MRR@10 0.0294
wandb:          test MRR@100 0.0332
wandb:           test MRR@20 0.0313
wandb:           test MRR@50 0.0327
wandb:          test NDCG@10 0.024
wandb:         test NDCG@100 0.0386
wandb:          test NDCG@20 0.0284
wandb:          test NDCG@50 0.034
wandb:     test Precision@10 0.0083
wandb:    test Precision@100 0.0026
wandb:     test Precision@20 0.0061
wandb:     test Precision@50 0.0038
wandb:        test Recall@10 0.0356
wandb:       test Recall@100 0.0931
wandb:        test Recall@20 0.0499
wandb:        test Recall@50 0.0716
wandb:          valid MRR@10 0.0014
wandb:         valid MRR@100 0.0017
wandb:          valid MRR@20 0.0015
wandb:          valid MRR@50 0.0016
wandb:         valid NDCG@10 0.0007
wandb:        valid NDCG@100 0.0012
wandb:         valid NDCG@20 0.0009
wandb:         valid NDCG@50 0.0011
wandb:    valid Precision@10 0.0004
wandb:   valid Precision@100 0.0001
wandb:    valid Precision@20 0.0003
wandb:    valid Precision@50 0.0002
wandb:       valid Recall@10 0.0009
wandb:      valid Recall@100 0.0029
wandb:       valid Recall@20 0.0014
wandb:       valid Recall@50 0.0021
wandb: 
wandb:  View run T-DiffRec_amazon-book_noisy_1_Visualization at: https://wandb.ai/drs/drs/runs/se5ss7b7
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_102025-se5ss7b7/logs
Traceback (most recent call last):
  File "./T-DiffRec/main.py", line 369, in <module>
    test_results = evaluate(test_loader, test_y_data, mask_tv, eval(args.topN))
  File "./T-DiffRec/main.py", line 313, in evaluate
    prediction = diffusion.p_sample(
  File "/home/lcur2420/RS/T-DiffRec/models/gaussian_diffusion.py", line 147, in p_sample
    t = th.tensor([i] * x_t.shape[0]).to(x_start.device)
KeyboardInterrupt
