wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_175942-mclbeieb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_clean_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/mclbeieb
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 17:59:46
user num: 54574
item num: 34395
data ready.
Embedding size: 10
models ready.
Number of all parameters: 68835555
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 784.9324 costs 00: 00: 12
------------------------------------------------------
Runing Epoch 002 train loss 605.9715 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 003 train loss 561.0948 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 004 train loss 545.9662 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0105
0.008
0.0063
 0.0303
0.0507
0.0942
0.1448
 0.0233
0.03
0.0424
0.0548
 0.0394
0.0435
0.0469
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0091
0.0076
0.0058
0.0045
 0.0379
0.0625
0.115
0.1744
 0.024
0.0314
0.0445
0.0567
 0.0304
0.0337
0.0366
0.0379

Runing Epoch 005 train loss 539.9979 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 006 train loss 534.1066 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 007 train loss 529.4414 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 008 train loss 525.6686 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 009 train loss 522.2290 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0145
0.0122
0.0094
0.0074
 0.036
0.0594
0.1112
0.1705
 0.0275
0.0353
0.0501
0.0646
 0.0462
0.0509
0.0548
0.0563

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0094
0.0069
0.0053
 0.047
0.0768
0.1375
0.2076
 0.0295
0.0386
0.0537
0.0682
 0.0371
0.041
0.0443
0.0457

Runing Epoch 010 train loss 518.1118 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 011 train loss 515.3672 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 012 train loss 512.3477 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 013 train loss 510.1132 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 014 train loss 507.5379 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0151
0.0128
0.0098
0.0077
 0.0374
0.0628
0.1161
0.1779
 0.0284
0.0368
0.0521
0.0672
 0.0476
0.0525
0.0565
0.058

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0118
0.0098
0.0073
0.0056
 0.0493
0.0804
0.1445
0.2165
 0.0309
0.0404
0.0563
0.0712
 0.0386
0.0427
0.0462
0.0476

Runing Epoch 015 train loss 505.5315 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 016 train loss 503.0437 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 017 train loss 502.0185 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 018 train loss 500.4069 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 019 train loss 498.7584 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0152
0.0129
0.0099
0.0078
 0.0375
0.0632
0.1171
0.1787
 0.0285
0.0369
0.0524
0.0675
 0.0474
0.0524
0.0564
0.058

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.012
0.01
0.0074
0.0056
 0.0505
0.0818
0.1466
0.2183
 0.0314
0.041
0.0571
0.072
 0.0389
0.0431
0.0465
0.048

Runing Epoch 020 train loss 497.6710 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 021 train loss 496.6031 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 022 train loss 495.6290 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 023 train loss 494.8528 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 024 train loss 494.1305 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.013
0.01
0.0078
 0.0379
0.0643
0.118
0.1799
 0.0291
0.0378
0.0533
0.0684
 0.049
0.0541
0.0581
0.0597

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.01
0.0074
0.0056
 0.0504
0.0823
0.1469
0.2187
 0.0319
0.0416
0.0577
0.0726
 0.0399
0.0441
0.0476
0.049

Runing Epoch 025 train loss 493.2239 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 026 train loss 492.9408 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 027 train loss 492.0469 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 028 train loss 491.6573 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 029 train loss 491.6835 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.013
0.01
0.0078
 0.038
0.0642
0.1192
0.1812
 0.0292
0.0378
0.0536
0.0687
 0.0494
0.0544
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0075
0.0057
 0.0509
0.0834
0.149
0.2218
 0.032
0.0419
0.0582
0.0733
 0.04
0.0442
0.0477
0.0492

Runing Epoch 030 train loss 491.2753 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 031 train loss 490.4588 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 032 train loss 490.0651 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 033 train loss 490.2431 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 034 train loss 489.3331 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.0131
0.01
0.0078
 0.039
0.0646
0.1188
0.1819
 0.0299
0.0383
0.0539
0.0692
 0.05
0.055
0.059
0.0606

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0074
0.0057
 0.0515
0.0837
0.1484
0.2229
 0.0322
0.042
0.0581
0.0736
 0.0397
0.044
0.0474
0.0489

Runing Epoch 035 train loss 489.0301 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 036 train loss 489.6448 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 037 train loss 489.0417 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 038 train loss 488.8724 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 039 train loss 489.0594 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.01
0.0079
 0.0387
0.0648
0.1192
0.1826
 0.0295
0.0381
0.0538
0.0691
 0.0491
0.0542
0.0582
0.0598

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0075
0.0057
 0.0523
0.0838
0.1504
0.2237
 0.0325
0.0421
0.0587
0.0738
 0.0398
0.044
0.0475
0.049

Runing Epoch 040 train loss 488.6017 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 041 train loss 488.8057 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 042 train loss 488.8276 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 043 train loss 488.5399 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 044 train loss 488.7318 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.0131
0.01
0.0079
 0.0394
0.0647
0.1202
0.1839
 0.0298
0.0382
0.0541
0.0696
 0.0494
0.0544
0.0585
0.0601

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0075
0.0057
 0.0524
0.0836
0.1502
0.2251
 0.0325
0.0421
0.0586
0.0741
 0.0399
0.044
0.0476
0.0491

Runing Epoch 045 train loss 488.4441 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 046 train loss 488.5879 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 047 train loss 488.6273 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 048 train loss 488.4617 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 049 train loss 488.1524 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.0132
0.0101
0.0079
 0.0393
0.0662
0.1218
0.1858
 0.0301
0.0389
0.0548
0.0704
 0.0503
0.0554
0.0595
0.0611

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0103
0.0075
0.0057
 0.0526
0.0853
0.1514
0.2253
 0.0329
0.0428
0.0593
0.0745
 0.0403
0.0446
0.0481
0.0496

Runing Epoch 050 train loss 488.2527 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 051 train loss 488.3448 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 052 train loss 488.2256 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 053 train loss 488.3414 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 054 train loss 487.8764 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0132
0.01
0.0079
 0.0392
0.0656
0.1204
0.1839
 0.0296
0.0384
0.0541
0.0695
 0.0492
0.0544
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0075
0.0057
 0.0517
0.0837
0.1508
0.2254
 0.0324
0.0422
0.0588
0.0742
 0.0399
0.0442
0.0477
0.0492

Runing Epoch 055 train loss 487.7841 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 056 train loss 487.7477 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 057 train loss 487.7239 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 058 train loss 487.9617 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 059 train loss 487.7949 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0157
0.0132
0.0101
0.0079
 0.0401
0.066
0.1221
0.1846
 0.0305
0.039
0.0551
0.0702
 0.0505
0.0555
0.0596
0.0612

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0102
0.0075
0.0057
 0.0525
0.0854
0.1523
0.2248
 0.033
0.043
0.0595
0.0745
 0.0407
0.045
0.0485
0.05

Runing Epoch 060 train loss 487.3548 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 061 train loss 487.4420 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 062 train loss 488.1925 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 063 train loss 488.0625 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 064 train loss 487.8501 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.0131
0.01
0.0078
 0.0397
0.0654
0.12
0.1837
 0.0301
0.0385
0.0543
0.0697
 0.05
0.055
0.059
0.0606

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0102
0.0075
0.0057
 0.0523
0.0846
0.1518
0.2252
 0.0327
0.0425
0.0592
0.0743
 0.0403
0.0446
0.0482
0.0496

Runing Epoch 065 train loss 487.3621 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 066 train loss 487.9117 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 067 train loss 487.6645 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 068 train loss 487.5617 costs 00: 00: 10
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 50
wandb:         batch_loss_train 3.51077
wandb:         best_test MRR@10 0.0403
wandb:        best_test MRR@100 0.0496
wandb:         best_test MRR@20 0.0446
wandb:         best_test MRR@50 0.0481
wandb:        best_test NDCG@10 0.0329
wandb:       best_test NDCG@100 0.0745
wandb:        best_test NDCG@20 0.0428
wandb:        best_test NDCG@50 0.0593
wandb:   best_test Precision@10 0.0124
wandb:  best_test Precision@100 0.0057
wandb:   best_test Precision@20 0.0103
wandb:   best_test Precision@50 0.0075
wandb:      best_test Recall@10 0.0526
wandb:     best_test Recall@100 0.2253
wandb:      best_test Recall@20 0.0853
wandb:      best_test Recall@50 0.1514
wandb:        best_valid MRR@10 0.0503
wandb:       best_valid MRR@100 0.0611
wandb:        best_valid MRR@20 0.0554
wandb:        best_valid MRR@50 0.0595
wandb:       best_valid NDCG@10 0.0301
wandb:      best_valid NDCG@100 0.0704
wandb:       best_valid NDCG@20 0.0389
wandb:       best_valid NDCG@50 0.0548
wandb:  best_valid Precision@10 0.0156
wandb: best_valid Precision@100 0.0079
wandb:  best_valid Precision@20 0.0132
wandb:  best_valid Precision@50 0.0101
wandb:     best_valid Recall@10 0.0393
wandb:    best_valid Recall@100 0.1858
wandb:     best_valid Recall@20 0.0662
wandb:     best_valid Recall@50 0.1218
wandb:    epoch_loss_norm_train 3.5597
wandb:              test MRR@10 0.0403
wandb:             test MRR@100 0.0496
wandb:              test MRR@20 0.0446
wandb:              test MRR@50 0.0482
wandb:             test NDCG@10 0.0327
wandb:            test NDCG@100 0.0743
wandb:             test NDCG@20 0.0425
wandb:             test NDCG@50 0.0592
wandb:        test Precision@10 0.0123
wandb:       test Precision@100 0.0057
wandb:        test Precision@20 0.0102
wandb:        test Precision@50 0.0075
wandb:           test Recall@10 0.0523
wandb:          test Recall@100 0.2252
wandb:           test Recall@20 0.0846
wandb:           test Recall@50 0.1518
wandb:             valid MRR@10 0.05
wandb:            valid MRR@100 0.0606
wandb:             valid MRR@20 0.055
wandb:             valid MRR@50 0.059
wandb:            valid NDCG@10 0.0301
wandb:           valid NDCG@100 0.0697
wandb:            valid NDCG@20 0.0385
wandb:            valid NDCG@50 0.0543
wandb:       valid Precision@10 0.0156
wandb:      valid Precision@100 0.0078
wandb:       valid Precision@20 0.0131
wandb:       valid Precision@50 0.01
wandb:          valid Recall@10 0.0397
wandb:         valid Recall@100 0.1837
wandb:          valid Recall@20 0.0654
wandb:          valid Recall@50 0.12
wandb: 
wandb:  View run T-DiffRec_yelp_clean_2_Reproduction at: https://wandb.ai/drs/drs/runs/mclbeieb
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_175942-mclbeieb/logs
Runing Epoch 069 train loss 487.6785 costs 00: 00: 10
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 050 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.0132
0.0101
0.0079
 0.0393
0.0662
0.1218
0.1858
 0.0301
0.0389
0.0548
0.0704
 0.0503
0.0554
0.0595
0.0611

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0103
0.0075
0.0057
 0.0526
0.0853
0.1514
0.2253
 0.0329
0.0428
0.0593
0.0745
 0.0403
0.0446
0.0481
0.0496

End time:  2023-06-23 18:19:32
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_181947-6xvjz5w3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_noisy_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/6xvjz5w3
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 18:19:51
user num: 54574
item num: 77405
data ready.
Embedding size: 10
models ready.
Number of all parameters: 154898565
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 329.1692 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 002 train loss 268.2750 costs 00: 00: 15
------------------------------------------------------
Runing Epoch 003 train loss 260.3649 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 004 train loss 257.5030 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0102
0.0088
0.0071
0.0057
 0.0264
0.0442
0.085
0.1317
 0.0194
0.025
0.0363
0.0475
 0.0321
0.0358
0.039
0.0404

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0084
0.007
0.0054
0.0043
 0.0344
0.0572
0.1064
0.1647
 0.0216
0.0285
0.0407
0.0528
 0.0274
0.0306
0.0334
0.0347

Runing Epoch 005 train loss 255.6751 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 006 train loss 253.7628 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 007 train loss 252.3687 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 008 train loss 250.4288 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 009 train loss 248.8974 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0117
0.01
0.0079
0.0064
 0.03
0.0502
0.0948
0.1486
 0.022
0.0283
0.0408
0.0536
 0.0366
0.0407
0.0442
0.0456

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0098
0.0081
0.0061
0.0048
 0.0407
0.0659
0.1207
0.1866
 0.0251
0.0329
0.0465
0.0602
 0.0317
0.0352
0.0383
0.0398

Runing Epoch 010 train loss 247.4417 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 011 train loss 246.2680 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 012 train loss 245.0414 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 013 train loss 244.2412 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 014 train loss 243.1719 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0118
0.0102
0.0081
0.0065
 0.0299
0.051
0.0974
0.1506
 0.022
0.0287
0.0416
0.0543
 0.0367
0.0409
0.0445
0.0459

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0099
0.0084
0.0063
0.0049
 0.0409
0.0679
0.1249
0.1894
 0.0254
0.0337
0.0479
0.0614
 0.0323
0.036
0.0392
0.0406

Runing Epoch 015 train loss 242.0526 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 016 train loss 241.0883 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 017 train loss 240.2869 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 018 train loss 239.7752 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 019 train loss 239.0218 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0104
0.0082
0.0066
 0.0322
0.0532
0.1002
0.1549
 0.0233
0.03
0.043
0.0561
 0.0381
0.0424
0.0459
0.0474

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0086
0.0065
0.005
 0.0431
0.0709
0.1298
0.1954
 0.0267
0.0352
0.0499
0.0635
 0.0333
0.037
0.0403
0.0417

Runing Epoch 020 train loss 238.4690 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 021 train loss 238.1744 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 022 train loss 237.9254 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 023 train loss 237.6465 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 024 train loss 236.9964 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0106
0.0083
0.0066
 0.0315
0.0537
0.1007
0.1551
 0.023
0.03
0.0431
0.0561
 0.0377
0.0421
0.0457
0.0472

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0087
0.0065
0.005
 0.0432
0.0713
0.1305
0.1955
 0.0268
0.0354
0.0501
0.0635
 0.0333
0.0371
0.0404
0.0417

Runing Epoch 025 train loss 236.9790 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 026 train loss 236.5024 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 027 train loss 236.1180 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 028 train loss 236.0254 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 029 train loss 235.7531 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0106
0.0083
0.0067
 0.0324
0.0547
0.1018
0.1572
 0.0236
0.0306
0.0438
0.057
 0.0387
0.0431
0.0467
0.0482

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0087
0.0065
0.0051
 0.0445
0.0721
0.131
0.1987
 0.0275
0.036
0.0506
0.0647
 0.034
0.0377
0.041
0.0425

Runing Epoch 030 train loss 235.5338 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 031 train loss 235.5712 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 032 train loss 235.4047 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 033 train loss 235.1350 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 034 train loss 235.2021 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0106
0.0084
0.0067
 0.0322
0.055
0.1037
0.1602
 0.0233
0.0305
0.0441
0.0575
 0.0381
0.0426
0.0462
0.0477

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0088
0.0066
0.0051
 0.0443
0.0728
0.1328
0.2017
 0.0273
0.036
0.0509
0.0651
 0.0338
0.0377
0.041
0.0424

Runing Epoch 035 train loss 234.9739 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 036 train loss 234.9608 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 037 train loss 234.8687 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 038 train loss 234.9526 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 039 train loss 235.1372 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0108
0.0085
0.0068
 0.0333
0.0566
0.1051
0.1619
 0.024
0.0314
0.0449
0.0584
 0.0387
0.0432
0.0468
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0455
0.0743
0.1356
0.2049
 0.0281
0.0369
0.0522
0.0665
 0.0346
0.0384
0.0418
0.0433

Runing Epoch 040 train loss 234.9063 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 041 train loss 234.5954 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 042 train loss 235.0501 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 043 train loss 234.9211 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 044 train loss 234.6974 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0108
0.0084
0.0067
 0.0331
0.056
0.1044
0.161
 0.024
0.0312
0.0447
0.0581
 0.0384
0.0431
0.0467
0.0482

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0089
0.0067
0.0052
 0.045
0.074
0.136
0.205
 0.0278
0.0366
0.052
0.0662
 0.034
0.038
0.0414
0.0429

Runing Epoch 045 train loss 234.6074 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 046 train loss 234.6787 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 047 train loss 234.4904 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 048 train loss 234.5268 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 049 train loss 234.5304 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0067
 0.0334
0.0557
0.1045
0.1611
 0.024
0.0311
0.0445
0.058
 0.0387
0.0431
0.0468
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0455
0.0736
0.1353
0.2044
 0.028
0.0367
0.052
0.0662
 0.0343
0.0381
0.0415
0.0429

Runing Epoch 050 train loss 234.8107 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 051 train loss 234.4989 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 052 train loss 234.5642 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 053 train loss 234.4948 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 054 train loss 234.4662 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0067
 0.0334
0.0561
0.1059
0.1624
 0.0241
0.0312
0.045
0.0584
 0.039
0.0434
0.0471
0.0486

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.009
0.0066
0.0052
 0.0454
0.0744
0.1345
0.2058
 0.0281
0.0369
0.0518
0.0664
 0.0345
0.0384
0.0417
0.0432

Runing Epoch 055 train loss 234.4435 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 056 train loss 234.5495 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 057 train loss 234.4378 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 058 train loss 234.6962 costs 00: 00: 16
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 40
wandb:         batch_loss_train 1.77472
wandb:         best_test MRR@10 0.0346
wandb:        best_test MRR@100 0.0433
wandb:         best_test MRR@20 0.0384
wandb:         best_test MRR@50 0.0418
wandb:        best_test NDCG@10 0.0281
wandb:       best_test NDCG@100 0.0665
wandb:        best_test NDCG@20 0.0369
wandb:        best_test NDCG@50 0.0522
wandb:   best_test Precision@10 0.0106
wandb:  best_test Precision@100 0.0052
wandb:   best_test Precision@20 0.0089
wandb:   best_test Precision@50 0.0067
wandb:      best_test Recall@10 0.0455
wandb:     best_test Recall@100 0.2049
wandb:      best_test Recall@20 0.0743
wandb:      best_test Recall@50 0.1356
wandb:        best_valid MRR@10 0.0387
wandb:       best_valid MRR@100 0.0483
wandb:        best_valid MRR@20 0.0432
wandb:        best_valid MRR@50 0.0468
wandb:       best_valid NDCG@10 0.024
wandb:      best_valid NDCG@100 0.0584
wandb:       best_valid NDCG@20 0.0314
wandb:       best_valid NDCG@50 0.0449
wandb:  best_valid Precision@10 0.0125
wandb: best_valid Precision@100 0.0068
wandb:  best_valid Precision@20 0.0108
wandb:  best_valid Precision@50 0.0085
wandb:     best_valid Recall@10 0.0333
wandb:    best_valid Recall@100 0.1619
wandb:     best_valid Recall@20 0.0566
wandb:     best_valid Recall@50 0.1051
wandb:    epoch_loss_norm_train 1.71157
wandb:              test MRR@10 0.0345
wandb:             test MRR@100 0.0432
wandb:              test MRR@20 0.0384
wandb:              test MRR@50 0.0417
wandb:             test NDCG@10 0.0281
wandb:            test NDCG@100 0.0664
wandb:             test NDCG@20 0.0369
wandb:             test NDCG@50 0.0518
wandb:        test Precision@10 0.0107
wandb:       test Precision@100 0.0052
wandb:        test Precision@20 0.009
wandb:        test Precision@50 0.0066
wandb:           test Recall@10 0.0454
wandb:          test Recall@100 0.2058
wandb:           test Recall@20 0.0744
wandb:           test Recall@50 0.1345
wandb:             valid MRR@10 0.039
wandb:            valid MRR@100 0.0486
wandb:             valid MRR@20 0.0434
wandb:             valid MRR@50 0.0471
wandb:            valid NDCG@10 0.0241
wandb:           valid NDCG@100 0.0584
wandb:            valid NDCG@20 0.0312
wandb:            valid NDCG@50 0.045
wandb:       valid Precision@10 0.0125
wandb:      valid Precision@100 0.0067
wandb:       valid Precision@20 0.0107
wandb:       valid Precision@50 0.0084
wandb:          valid Recall@10 0.0334
wandb:         valid Recall@100 0.1624
wandb:          valid Recall@20 0.0561
wandb:          valid Recall@50 0.1059
wandb: 
wandb:  View run T-DiffRec_yelp_noisy_2_Reproduction at: https://wandb.ai/drs/drs/runs/6xvjz5w3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_181947-6xvjz5w3/logs
Runing Epoch 059 train loss 234.4850 costs 00: 00: 16
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 040 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0108
0.0085
0.0068
 0.0333
0.0566
0.1051
0.1619
 0.024
0.0314
0.0449
0.0584
 0.0387
0.0432
0.0468
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0455
0.0743
0.1356
0.2049
 0.0281
0.0369
0.0522
0.0665
 0.0346
0.0384
0.0418
0.0433

End time:  2023-06-23 18:46:36
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_184649-gfk6l83r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_clean_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/gfk6l83r
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 18:46:52
user num: 5949
item num: 2810
data ready.
Embedding size: 10
models ready.
Number of all parameters: 5633970
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 6243.4628 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 5572.2776 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 5087.3302 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4721.9667 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0589
0.0544
0.0451
0.0368
 0.0407
0.0747
0.147
0.2228
 0.0664
0.074
0.0973
0.1254
 0.1407
0.1508
0.1565
0.158

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0442
0.0389
0.0312
0.0245
 0.0543
0.0953
0.1829
0.2721
 0.0564
0.0685
0.0982
0.1266
 0.1073
0.116
0.1219
0.1236

Runing Epoch 005 train loss 4398.7142 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 4136.4090 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3891.1479 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3691.0291 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3494.6185 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.0604
0.0506
0.0425
 0.0506
0.0906
0.176
0.2715
 0.076
0.0864
0.1149
0.1505
 0.1567
0.1675
0.1736
0.175

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0538
0.0481
0.0386
0.0307
 0.0734
0.1259
0.2384
0.3526
 0.0721
0.0892
0.1276
0.1645
 0.1322
0.1421
0.1487
0.1503

Runing Epoch 010 train loss 3331.8170 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 3193.1936 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 3063.0632 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2936.5375 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2840.3813 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0667
0.0614
0.0523
0.0444
 0.056
0.0981
0.1929
0.2975
 0.0791
0.0906
0.1229
0.1618
 0.1603
0.1718
0.1783
0.1797

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0578
0.0522
0.0422
0.0335
 0.0846
0.1443
0.2723
0.4036
 0.0802
0.1009
0.1447
0.1861
 0.1416
0.1532
0.1598
0.1614

Runing Epoch 015 train loss 2742.7795 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2674.6320 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2576.8121 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2502.2913 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2439.1305 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0666
0.062
0.0532
0.0452
 0.0588
0.1037
0.2028
0.3149
 0.0804
0.0935
0.1278
0.1686
 0.1625
0.1741
0.1809
0.1823

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0611
0.0541
0.0438
0.0346
 0.0944
0.1571
0.2953
0.4301
 0.0872
0.1089
0.1559
0.1987
 0.1498
0.1613
0.1682
0.1697

Runing Epoch 020 train loss 2380.3000 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2321.5689 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2274.6248 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2225.3307 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 2183.7720 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0615
0.0533
0.0456
 0.0603
0.1067
0.2082
0.3245
 0.0806
0.0943
0.1297
0.1718
 0.1608
0.1732
0.1802
0.1817

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0613
0.0549
0.0447
0.0353
 0.0981
0.1651
0.3073
0.4465
 0.0891
0.1124
0.1611
0.205
 0.1523
0.1642
0.1712
0.1726

Runing Epoch 025 train loss 2141.2275 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 2105.9045 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 2061.6917 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 2024.7183 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 2004.3354 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0663
0.0613
0.0535
0.0456
 0.0622
0.1076
0.2128
0.3309
 0.0815
0.0948
0.1314
0.1739
 0.161
0.1729
0.1802
0.1817

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0623
0.0557
0.0457
0.0358
 0.1032
0.1714
0.3194
0.4601
 0.0921
0.1159
0.1666
0.2107
 0.1542
0.1662
0.1732
0.1746

Runing Epoch 030 train loss 1976.6672 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1949.3552 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1925.4626 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1896.2590 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1873.7100 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0662
0.0613
0.0536
0.0457
 0.0631
0.1086
0.2177
0.3349
 0.0811
0.0946
0.1323
0.1748
 0.1593
0.1713
0.1789
0.1804

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0631
0.0566
0.0457
0.036
 0.1064
0.1768
0.3233
0.4663
 0.0936
0.1182
0.1683
0.2132
 0.156
0.1683
0.175
0.1765

Runing Epoch 035 train loss 1856.6871 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1833.4074 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1809.7904 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1785.2930 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1771.9304 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0666
0.0612
0.0536
0.0456
 0.0642
0.1099
0.2185
0.3365
 0.0821
0.0957
0.1332
0.1758
 0.16
0.1719
0.1794
0.1809

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0639
0.0569
0.046
0.0363
 0.1095
0.1798
0.3275
0.4734
 0.096
0.1205
0.1711
0.2167
 0.1584
0.1705
0.1773
0.1787

Runing Epoch 040 train loss 1760.6247 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1736.6939 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1719.8963 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1710.1921 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1698.6190 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0655
0.0606
0.053
0.0454
 0.064
0.111
0.2198
0.3397
 0.0812
0.0954
0.133
0.1761
 0.16
0.1722
0.1797
0.1812

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0637
0.0565
0.046
0.0363
 0.1119
0.1817
0.3328
0.478
 0.0968
0.1212
0.1728
0.2184
 0.1604
0.1722
0.1791
0.1806

Runing Epoch 045 train loss 1682.2925 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1670.6905 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1653.2860 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1645.4720 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1634.9636 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0648
0.0605
0.0528
0.0452
 0.0642
0.1123
0.2211
0.3402
 0.0814
0.0961
0.1337
0.1767
 0.1616
0.1741
0.1817
0.1832

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0569
0.0461
0.0363
 0.1139
0.1852
0.3357
0.481
 0.0984
0.1234
0.175
0.2204
 0.1621
0.174
0.181
0.1824

Runing Epoch 050 train loss 1620.6263 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1610.5956 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1600.8278 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1588.6871 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1586.2287 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0656
0.0607
0.0533
0.0455
 0.0647
0.1126
0.2217
0.3433
 0.0817
0.0962
0.1342
0.1776
 0.1595
0.172
0.1795
0.181

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0644
0.0576
0.0464
0.0366
 0.114
0.1875
0.3388
0.4839
 0.0987
0.1245
0.1762
0.2218
 0.1622
0.1747
0.1815
0.183

Runing Epoch 055 train loss 1569.9832 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1559.2967 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1551.2318 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1539.7642 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1535.2307 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0604
0.0531
0.0456
 0.0658
0.1121
0.2216
0.3439
 0.0818
0.0955
0.1336
0.1774
 0.1597
0.1718
0.1793
0.1809

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0648
0.0574
0.0463
0.0364
 0.1142
0.1884
0.339
0.4835
 0.0989
0.1247
0.1763
0.2216
 0.1602
0.1725
0.1795
0.1809

Runing Epoch 060 train loss 1527.8533 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1516.2837 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1509.7061 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1505.6969 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1492.8779 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0604
0.0532
0.0458
 0.0655
0.1125
0.2223
0.3447
 0.0817
0.0955
0.1337
0.1777
 0.1601
0.1721
0.1798
0.1813

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.065
0.0575
0.0467
0.0365
 0.1139
0.187
0.3417
0.4838
 0.0992
0.1247
0.1774
0.222
 0.1638
0.1759
0.1829
0.1843

Runing Epoch 065 train loss 1488.0444 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1483.3089 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1470.8903 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1465.1559 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 069 train loss 1461.8068 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.0606
0.0527
0.0454
 0.0652
0.1141
0.2206
0.3432
 0.0814
0.0963
0.1332
0.1771
 0.1597
0.172
0.1794
0.181

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0651
0.0575
0.0466
0.0365
 0.1144
0.1899
0.3428
0.4856
 0.0995
0.1257
0.1779
0.2228
 0.1623
0.1744
0.1813
0.1827

Runing Epoch 070 train loss 1451.3052 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1451.9768 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 072 train loss 1444.8515 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 073 train loss 1437.7167 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 074 train loss 1430.8967 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.0604
0.0529
0.0453
 0.0653
0.1132
0.222
0.3445
 0.0813
0.0958
0.1336
0.1774
 0.1595
0.1718
0.1793
0.1808

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0646
0.0572
0.0464
0.0363
 0.1149
0.1892
0.3421
0.4843
 0.0997
0.1257
0.178
0.2227
 0.1639
0.1762
0.1832
0.1846

Runing Epoch 075 train loss 1421.4223 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 076 train loss 1417.3446 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 077 train loss 1414.5563 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 078 train loss 1409.4136 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 079 train loss 1405.0525 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0605
0.053
0.0456
 0.066
0.114
0.2222
0.3452
 0.0821
0.0964
0.1341
0.1781
 0.1599
0.172
0.1795
0.181

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0644
0.0576
0.0465
0.0364
 0.1156
0.1915
0.3426
0.4862
 0.0999
0.1266
0.1784
0.2234
 0.164
0.1764
0.1833
0.1847

Runing Epoch 080 train loss 1399.5158 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 081 train loss 1392.1528 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 082 train loss 1388.2727 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 083 train loss 1385.5884 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 084 train loss 1382.7234 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0652
0.0607
0.0526
0.0452
 0.0655
0.1143
0.2223
0.3455
 0.0808
0.096
0.1334
0.1775
 0.1574
0.1704
0.1776
0.1791

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0581
0.0465
0.0364
 0.1152
0.1938
0.3446
0.4872
 0.1002
0.1278
0.1793
0.2242
 0.1658
0.1786
0.1855
0.1868

Runing Epoch 085 train loss 1378.2193 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 086 train loss 1377.5673 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 087 train loss 1371.8255 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 088 train loss 1368.0828 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 089 train loss 1362.1558 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0665
0.0602
0.0529
0.0455
 0.0658
0.1139
0.2223
0.3458
 0.0821
0.0959
0.1338
0.1779
 0.1601
0.1719
0.1795
0.181

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0644
0.0577
0.0465
0.0364
 0.1151
0.1903
0.3427
0.4878
 0.0999
0.1264
0.1785
0.2238
 0.1646
0.177
0.184
0.1854

Runing Epoch 090 train loss 1361.3415 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 091 train loss 1352.6845 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 092 train loss 1351.2741 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 093 train loss 1343.6094 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 094 train loss 1343.1067 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0657
0.0604
0.0528
0.0452
 0.0659
0.1145
0.2236
0.3456
 0.0816
0.0962
0.1341
0.1778
 0.16
0.1722
0.1797
0.1812

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0645
0.0579
0.0467
0.0365
 0.1148
0.1933
0.3454
0.4887
 0.1004
0.1279
0.18
0.225
 0.1675
0.18
0.1869
0.1883

Runing Epoch 095 train loss 1340.4792 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 096 train loss 1333.6348 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 097 train loss 1331.4099 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 098 train loss 1327.3914 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 099 train loss 1326.1018 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0661
0.0606
0.0528
0.0455
 0.0661
0.1141
0.2231
0.3458
 0.0819
0.0963
0.1341
0.1781
 0.1606
0.173
0.1804
0.1819

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.065
0.0573
0.0465
0.0364
 0.1148
0.19
0.3448
0.4882
 0.1001
0.1262
0.1789
0.224
 0.1657
0.1782
0.1852
0.1865

Runing Epoch 100 train loss 1319.9900 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 101 train loss 1319.6917 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 102 train loss 1315.6263 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 103 train loss 1310.4579 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 104 train loss 1311.9844 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0663
0.0607
0.0527
0.0452
 0.0656
0.1139
0.222
0.3458
 0.0822
0.0964
0.1338
0.1778
 0.162
0.174
0.1815
0.183

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0645
0.0573
0.0464
0.0363
 0.1147
0.1902
0.3425
0.4877
 0.0994
0.1257
0.1779
0.2231
 0.1646
0.1768
0.1837
0.1851

Runing Epoch 105 train loss 1308.7249 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 106 train loss 1303.6305 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 107 train loss 1300.2751 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 108 train loss 1297.6400 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 109 train loss 1297.1416 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.061
0.053
0.0457
 0.0657
0.1145
0.2227
0.347
 0.0815
0.0963
0.1338
0.1782
 0.1592
0.1712
0.1788
0.1803

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0655
0.0581
0.0468
0.0366
 0.1162
0.1912
0.3452
0.4882
 0.1007
0.127
0.1794
0.2244
 0.1656
0.1779
0.1847
0.1861

Runing Epoch 110 train loss 1291.1521 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 111 train loss 1290.1799 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 112 train loss 1283.6937 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 113 train loss 1286.7225 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 95
wandb:         batch_loss_train 86.75582
wandb:         best_test MRR@10 0.1675
wandb:        best_test MRR@100 0.1883
wandb:         best_test MRR@20 0.18
wandb:         best_test MRR@50 0.1869
wandb:        best_test NDCG@10 0.1004
wandb:       best_test NDCG@100 0.225
wandb:        best_test NDCG@20 0.1279
wandb:        best_test NDCG@50 0.18
wandb:   best_test Precision@10 0.0645
wandb:  best_test Precision@100 0.0365
wandb:   best_test Precision@20 0.0579
wandb:   best_test Precision@50 0.0467
wandb:      best_test Recall@10 0.1148
wandb:     best_test Recall@100 0.4887
wandb:      best_test Recall@20 0.1933
wandb:      best_test Recall@50 0.3454
wandb:        best_valid MRR@10 0.16
wandb:       best_valid MRR@100 0.1812
wandb:        best_valid MRR@20 0.1722
wandb:        best_valid MRR@50 0.1797
wandb:       best_valid NDCG@10 0.0816
wandb:      best_valid NDCG@100 0.1778
wandb:       best_valid NDCG@20 0.0962
wandb:       best_valid NDCG@50 0.1341
wandb:  best_valid Precision@10 0.0657
wandb: best_valid Precision@100 0.0452
wandb:  best_valid Precision@20 0.0604
wandb:  best_valid Precision@50 0.0528
wandb:     best_valid Recall@10 0.0659
wandb:    best_valid Recall@100 0.3456
wandb:     best_valid Recall@20 0.1145
wandb:     best_valid Recall@50 0.2236
wandb:    epoch_loss_norm_train 85.41369
wandb:              test MRR@10 0.1656
wandb:             test MRR@100 0.1861
wandb:              test MRR@20 0.1779
wandb:              test MRR@50 0.1847
wandb:             test NDCG@10 0.1007
wandb:            test NDCG@100 0.2244
wandb:             test NDCG@20 0.127
wandb:             test NDCG@50 0.1794
wandb:        test Precision@10 0.0655
wandb:       test Precision@100 0.0366
wandb:        test Precision@20 0.0581
wandb:        test Precision@50 0.0468
wandb:           test Recall@10 0.1162
wandb:          test Recall@100 0.4882
wandb:           test Recall@20 0.1912
wandb:           test Recall@50 0.3452
wandb:             valid MRR@10 0.1592
wandb:            valid MRR@100 0.1803
wandb:             valid MRR@20 0.1712
wandb:             valid MRR@50 0.1788
wandb:            valid NDCG@10 0.0815
wandb:           valid NDCG@100 0.1782
wandb:            valid NDCG@20 0.0963
wandb:            valid NDCG@50 0.1338
wandb:       valid Precision@10 0.066
wandb:      valid Precision@100 0.0457
wandb:       valid Precision@20 0.061
wandb:       valid Precision@50 0.053
wandb:          valid Recall@10 0.0657
wandb:         valid Recall@100 0.347
wandb:          valid Recall@20 0.1145
wandb:          valid Recall@50 0.2227
wandb: 
wandb:  View run T-DiffRec_ml-1m_clean_2_Reproduction at: https://wandb.ai/drs/drs/runs/gfk6l83r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_184649-gfk6l83r/logs
Runing Epoch 114 train loss 1281.2054 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 095 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0657
0.0604
0.0528
0.0452
 0.0659
0.1145
0.2236
0.3456
 0.0816
0.0962
0.1341
0.1778
 0.16
0.1722
0.1797
0.1812

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0645
0.0579
0.0467
0.0365
 0.1148
0.1933
0.3454
0.4887
 0.1004
0.1279
0.18
0.225
 0.1675
0.18
0.1869
0.1883

End time:  2023-06-23 18:49:36
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_185004-f9bmveg2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_noisy_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/f9bmveg2
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 18:50:07
user num: 5949
item num: 3494
data ready.
Embedding size: 10
models ready.
Number of all parameters: 7002654
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 5151.3547 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 4608.2042 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 4272.2694 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 3955.8995 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0358
0.0352
0.0324
0.0291
 0.0305
0.0573
0.1171
0.1899
 0.0422
0.0507
0.0708
0.0958
 0.0934
0.1037
0.1103
0.1122

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.036
0.0325
0.0261
0.0216
 0.0524
0.0885
0.1644
0.2566
 0.0497
0.0619
0.0883
0.1169
 0.0944
0.1036
0.1095
0.1115

Runing Epoch 005 train loss 3726.7846 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 3523.1061 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3339.1306 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3170.6397 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3023.9805 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0359
0.0348
0.0341
0.0318
 0.034
0.0603
0.1334
0.2214
 0.0429
0.0516
0.0769
0.1074
 0.0909
0.1017
0.1094
0.1114

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0348
0.0326
0.0292
0.0249
 0.055
0.0962
0.1994
0.3117
 0.0502
0.0651
0.1007
0.1359
 0.092
0.1022
0.1099
0.112

Runing Epoch 010 train loss 2890.0887 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 2778.1249 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 2668.9801 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2576.4165 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2491.9114 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.035
0.0351
0.0346
0.0333
 0.0363
0.0658
0.1446
0.2446
 0.0419
0.0526
0.0804
0.115
 0.0855
0.0971
0.1052
0.1072

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0341
0.0336
0.0307
0.0268
 0.0592
0.1064
0.2216
0.3536
 0.0508
0.0689
0.1087
0.1492
 0.0893
0.1008
0.109
0.1111

Runing Epoch 015 train loss 2414.9652 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2354.7759 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2278.5651 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2221.7970 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2177.1362 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0336
0.0336
0.0348
0.0339
 0.0368
0.0675
0.1541
0.2604
 0.0411
0.0521
0.0829
0.1196
 0.0839
0.0954
0.1042
0.1063

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0339
0.0338
0.0319
0.0279
 0.0627
0.1134
0.2423
0.3824
 0.0524
0.072
0.116
0.159
 0.0905
0.1021
0.1109
0.113

Runing Epoch 020 train loss 2116.4272 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2075.9712 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2036.2500 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 1995.5684 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 1957.2866 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0325
0.0335
0.0349
0.0335
 0.0379
0.0709
0.1602
0.266
 0.0408
0.053
0.0848
0.1212
 0.0825
0.0943
0.1034
0.1054

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0348
0.0342
0.0322
0.0282
 0.0666
0.1201
0.2534
0.3971
 0.0541
0.0745
0.1199
0.1636
 0.0911
0.1029
0.1118
0.1139

Runing Epoch 025 train loss 1921.8994 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 1891.5697 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 1863.9057 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 1830.7956 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 1807.7543 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0321
0.0332
0.0347
0.0337
 0.0376
0.0713
0.1642
0.2734
 0.04
0.0525
0.0853
0.1228
 0.0806
0.0922
0.1015
0.1035

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0356
0.0353
0.0326
0.0284
 0.0694
0.128
0.2628
0.4075
 0.0555
0.0776
0.1232
0.1672
 0.0923
0.1045
0.1131
0.1152

Runing Epoch 030 train loss 1783.5194 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1761.3352 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1738.7560 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1718.1991 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1698.4428 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0324
0.0329
0.0345
0.0336
 0.0376
0.0722
0.1643
0.2748
 0.0406
0.0529
0.0856
0.1234
 0.0818
0.0934
0.1027
0.1048

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0355
0.0352
0.033
0.0285
 0.0717
0.1285
0.2684
0.4158
 0.0565
0.0782
0.1254
0.1698
 0.0928
0.1049
0.1137
0.1159

Runing Epoch 035 train loss 1680.6341 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1661.2619 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1644.2571 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1630.1565 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1613.7820 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0322
0.0332
0.0345
0.0333
 0.0385
0.0749
0.1669
0.2778
 0.0408
0.0539
0.0865
0.1242
 0.0815
0.0937
0.1027
0.1049

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0355
0.0331
0.0284
 0.0725
0.1328
0.2741
0.4186
 0.0572
0.08
0.1275
0.1713
 0.093
0.1055
0.1143
0.1164

Runing Epoch 040 train loss 1597.5256 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1585.4532 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1567.3778 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1557.6500 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1539.8097 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0316
0.0327
0.0343
0.0331
 0.037
0.073
0.1664
0.28
 0.0402
0.0532
0.0861
0.1244
 0.082
0.094
0.1033
0.1055

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.035
0.0352
0.0328
0.0284
 0.0719
0.1323
0.2744
0.4206
 0.0564
0.0794
0.127
0.1713
 0.0915
0.1041
0.113
0.1151

Runing Epoch 045 train loss 1531.4398 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1516.4312 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1507.6434 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1494.6943 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1486.4153 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0316
0.0324
0.0338
0.0328
 0.0376
0.0735
0.1678
0.2794
 0.0399
0.0528
0.0858
0.1236
 0.0793
0.0914
0.1007
0.1028

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0352
0.035
0.0325
0.0281
 0.0729
0.1346
0.2767
0.4196
 0.0566
0.0798
0.1272
0.1707
 0.0909
0.1037
0.1126
0.1147

Runing Epoch 050 train loss 1475.5071 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1465.8372 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1456.9412 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1442.4075 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1435.6792 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0319
0.0326
0.034
0.0329
 0.0392
0.0741
0.1677
0.2803
 0.0411
0.0538
0.0866
0.1245
 0.0812
0.0933
0.1026
0.1047

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0359
0.0353
0.0328
0.0283
 0.0752
0.1363
0.2757
0.4251
 0.0575
0.0805
0.1275
0.1722
 0.0904
0.1027
0.1115
0.1137

Runing Epoch 055 train loss 1426.6950 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1418.8738 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1414.2004 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1404.0970 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 40
wandb:         batch_loss_train 94.49659
wandb:         best_test MRR@10 0.093
wandb:        best_test MRR@100 0.1164
wandb:         best_test MRR@20 0.1055
wandb:         best_test MRR@50 0.1143
wandb:        best_test NDCG@10 0.0572
wandb:       best_test NDCG@100 0.1713
wandb:        best_test NDCG@20 0.08
wandb:        best_test NDCG@50 0.1275
wandb:   best_test Precision@10 0.0357
wandb:  best_test Precision@100 0.0284
wandb:   best_test Precision@20 0.0355
wandb:   best_test Precision@50 0.0331
wandb:      best_test Recall@10 0.0725
wandb:     best_test Recall@100 0.4186
wandb:      best_test Recall@20 0.1328
wandb:      best_test Recall@50 0.2741
wandb:        best_valid MRR@10 0.0815
wandb:       best_valid MRR@100 0.1049
wandb:        best_valid MRR@20 0.0937
wandb:        best_valid MRR@50 0.1027
wandb:       best_valid NDCG@10 0.0408
wandb:      best_valid NDCG@100 0.1242
wandb:       best_valid NDCG@20 0.0539
wandb:       best_valid NDCG@50 0.0865
wandb:  best_valid Precision@10 0.0322
wandb: best_valid Precision@100 0.0333
wandb:  best_valid Precision@20 0.0332
wandb:  best_valid Precision@50 0.0345
wandb:     best_valid Recall@10 0.0385
wandb:    best_valid Recall@100 0.2778
wandb:     best_valid Recall@20 0.0749
wandb:     best_valid Recall@50 0.1669
wandb:    epoch_loss_norm_train 92.8621
wandb:              test MRR@10 0.0904
wandb:             test MRR@100 0.1137
wandb:              test MRR@20 0.1027
wandb:              test MRR@50 0.1115
wandb:             test NDCG@10 0.0575
wandb:            test NDCG@100 0.1722
wandb:             test NDCG@20 0.0805
wandb:             test NDCG@50 0.1275
wandb:        test Precision@10 0.0359
wandb:       test Precision@100 0.0283
wandb:        test Precision@20 0.0353
wandb:        test Precision@50 0.0328
wandb:           test Recall@10 0.0752
wandb:          test Recall@100 0.4251
wandb:           test Recall@20 0.1363
wandb:           test Recall@50 0.2757
wandb:             valid MRR@10 0.0812
wandb:            valid MRR@100 0.1047
wandb:             valid MRR@20 0.0933
wandb:             valid MRR@50 0.1026
wandb:            valid NDCG@10 0.0411
wandb:           valid NDCG@100 0.1245
wandb:            valid NDCG@20 0.0538
wandb:            valid NDCG@50 0.0866
wandb:       valid Precision@10 0.0319
wandb:      valid Precision@100 0.0329
wandb:       valid Precision@20 0.0326
wandb:       valid Precision@50 0.034
wandb:          valid Recall@10 0.0392
wandb:         valid Recall@100 0.2803
wandb:          valid Recall@20 0.0741
wandb:          valid Recall@50 0.1677
wandb: 
wandb:  View run T-DiffRec_ml-1m_noisy_2_Reproduction at: https://wandb.ai/drs/drs/runs/f9bmveg2
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_185004-f9bmveg2/logs
Runing Epoch 059 train loss 1392.9315 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 040 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0322
0.0332
0.0345
0.0333
 0.0385
0.0749
0.1669
0.2778
 0.0408
0.0539
0.0865
0.1242
 0.0815
0.0937
0.1027
0.1049

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0355
0.0331
0.0284
 0.0725
0.1328
0.2741
0.4186
 0.0572
0.08
0.1275
0.1713
 0.093
0.1055
0.1143
0.1164

End time:  2023-06-23 18:51:33
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_185156-5qb0v2k7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_clean_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/5qb0v2k7
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 18:51:59
user num: 54574
item num: 34395
data ready.
Embedding size: 10
models ready.
Number of all parameters: 68835555
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 784.2434 costs 00: 00: 11
------------------------------------------------------
Runing Epoch 002 train loss 603.9492 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 003 train loss 560.6462 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 004 train loss 547.0945 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0104
0.008
0.0063
 0.0301
0.05
0.0937
0.1441
 0.0234
0.0299
0.0424
0.0548
 0.0397
0.0438
0.0472
0.0486

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.009
0.0076
0.0057
0.0045
 0.0374
0.0617
0.1134
0.1724
 0.0238
0.0312
0.0441
0.0563
 0.0304
0.0337
0.0366
0.0379

Runing Epoch 005 train loss 539.0951 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 006 train loss 534.2219 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 007 train loss 529.7343 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 008 train loss 525.3414 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 009 train loss 521.8794 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0143
0.0121
0.0092
0.0073
 0.0352
0.0584
0.1079
0.1667
 0.0272
0.0347
0.049
0.0634
 0.0457
0.0503
0.0541
0.0556

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0109
0.009
0.0068
0.0053
 0.0447
0.0725
0.134
0.2023
 0.0287
0.0372
0.0525
0.0667
 0.0368
0.0405
0.0438
0.0453

Runing Epoch 010 train loss 519.2177 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 011 train loss 515.8070 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 012 train loss 512.7937 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 013 train loss 510.1476 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 014 train loss 508.2095 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0149
0.0124
0.0096
0.0075
 0.0368
0.0603
0.1119
0.1716
 0.0283
0.036
0.051
0.0656
 0.0477
0.0524
0.0563
0.0579

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0115
0.0096
0.0071
0.0055
 0.0479
0.0772
0.1398
0.2095
 0.0304
0.0394
0.055
0.0695
 0.0385
0.0425
0.0458
0.0473

Runing Epoch 015 train loss 505.4825 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 016 train loss 503.2154 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 017 train loss 502.5657 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 018 train loss 500.5066 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 019 train loss 499.5316 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.015
0.0127
0.0097
0.0076
 0.0373
0.062
0.1136
0.1735
 0.0286
0.0368
0.0517
0.0664
 0.0482
0.0531
0.057
0.0585

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0119
0.0098
0.0073
0.0055
 0.0495
0.0791
0.1433
0.2118
 0.0312
0.0404
0.0564
0.0707
 0.0392
0.0432
0.0466
0.048

Runing Epoch 020 train loss 497.8680 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 021 train loss 496.5407 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 022 train loss 495.0277 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 023 train loss 494.6725 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 024 train loss 493.9822 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0152
0.0128
0.0098
0.0077
 0.0382
0.0627
0.1156
0.1769
 0.0292
0.0373
0.0526
0.0676
 0.0489
0.0537
0.0576
0.0592

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0119
0.0099
0.0073
0.0056
 0.0494
0.0805
0.1445
0.2149
 0.0315
0.0411
0.057
0.0717
 0.0399
0.0441
0.0475
0.0489

Runing Epoch 025 train loss 493.4763 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 026 train loss 492.5989 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 027 train loss 492.3375 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 028 train loss 491.9203 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 029 train loss 491.6571 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0129
0.0099
0.0077
 0.0386
0.0636
0.1171
0.1774
 0.0296
0.0378
0.0532
0.068
 0.0498
0.0548
0.0587
0.0603

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0099
0.0074
0.0056
 0.0509
0.0811
0.1466
0.2172
 0.0322
0.0415
0.0578
0.0725
 0.0402
0.0442
0.0477
0.0492

Runing Epoch 030 train loss 490.9045 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 031 train loss 490.1771 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 032 train loss 490.2912 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 033 train loss 490.5963 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 034 train loss 489.9306 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.0099
0.0078
 0.0393
0.0644
0.1182
0.1804
 0.0299
0.0382
0.0537
0.0689
 0.0498
0.0547
0.0587
0.0603

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0101
0.0074
0.0057
 0.0508
0.083
0.1483
0.2215
 0.0323
0.0421
0.0583
0.0735
 0.0402
0.0445
0.048
0.0495

Runing Epoch 035 train loss 489.3610 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 036 train loss 489.4371 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 037 train loss 489.7679 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 038 train loss 489.4052 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 039 train loss 488.9110 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.013
0.0099
0.0077
 0.0389
0.0645
0.1188
0.1799
 0.0297
0.0381
0.0537
0.0686
 0.0494
0.0543
0.0583
0.0599

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.01
0.0074
0.0056
 0.0517
0.0833
0.148
0.2203
 0.0325
0.0421
0.0582
0.0732
 0.0405
0.0446
0.0481
0.0496

Runing Epoch 040 train loss 488.6412 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 041 train loss 489.2360 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 042 train loss 489.1294 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 043 train loss 488.6905 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 044 train loss 488.8080 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0079
 0.0396
0.0657
0.121
0.1845
 0.0301
0.0387
0.0546
0.07
 0.05
0.0552
0.0592
0.0608

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0101
0.0075
0.0057
 0.0528
0.0843
0.1517
0.2257
 0.0332
0.0427
0.0594
0.0747
 0.0408
0.0449
0.0485
0.05

Runing Epoch 045 train loss 488.1780 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 046 train loss 488.4719 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 047 train loss 488.4295 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 048 train loss 488.2091 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 049 train loss 488.0301 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0078
 0.0393
0.0656
0.1207
0.1842
 0.0299
0.0386
0.0544
0.0698
 0.0497
0.0548
0.0588
0.0605

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0101
0.0075
0.0057
 0.0525
0.0841
0.1512
0.2253
 0.0329
0.0425
0.0592
0.0744
 0.0406
0.0448
0.0484
0.0499

Runing Epoch 050 train loss 488.3002 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 051 train loss 487.8953 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 052 train loss 488.5939 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 053 train loss 488.1797 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 054 train loss 487.5421 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.013
0.01
0.0079
 0.0395
0.0652
0.1202
0.1837
 0.0302
0.0386
0.0544
0.0698
 0.0503
0.0552
0.0592
0.0609

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0101
0.0075
0.0057
 0.0521
0.0833
0.1508
0.2247
 0.0328
0.0423
0.059
0.0742
 0.0406
0.0448
0.0483
0.0498

Runing Epoch 055 train loss 487.7358 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 056 train loss 487.6940 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 057 train loss 487.9282 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 058 train loss 487.3428 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 059 train loss 487.8014 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.0131
0.01
0.0079
 0.0394
0.0655
0.1203
0.1839
 0.0301
0.0387
0.0544
0.0698
 0.0501
0.0552
0.0592
0.0608

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0075
0.0057
 0.0516
0.0835
0.1506
0.224
 0.0326
0.0423
0.059
0.0741
 0.0404
0.0447
0.0482
0.0497

Runing Epoch 060 train loss 487.4489 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 061 train loss 487.6304 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 062 train loss 487.8334 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 063 train loss 487.0970 costs 00: 00: 10
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 45
wandb:         batch_loss_train 3.67065
wandb:         best_test MRR@10 0.0408
wandb:        best_test MRR@100 0.05
wandb:         best_test MRR@20 0.0449
wandb:         best_test MRR@50 0.0485
wandb:        best_test NDCG@10 0.0332
wandb:       best_test NDCG@100 0.0747
wandb:        best_test NDCG@20 0.0427
wandb:        best_test NDCG@50 0.0594
wandb:   best_test Precision@10 0.0124
wandb:  best_test Precision@100 0.0057
wandb:   best_test Precision@20 0.0101
wandb:   best_test Precision@50 0.0075
wandb:      best_test Recall@10 0.0528
wandb:     best_test Recall@100 0.2257
wandb:      best_test Recall@20 0.0843
wandb:      best_test Recall@50 0.1517
wandb:        best_valid MRR@10 0.05
wandb:       best_valid MRR@100 0.0608
wandb:        best_valid MRR@20 0.0552
wandb:        best_valid MRR@50 0.0592
wandb:       best_valid NDCG@10 0.0301
wandb:      best_valid NDCG@100 0.07
wandb:       best_valid NDCG@20 0.0387
wandb:       best_valid NDCG@50 0.0546
wandb:  best_valid Precision@10 0.0154
wandb: best_valid Precision@100 0.0079
wandb:  best_valid Precision@20 0.0131
wandb:  best_valid Precision@50 0.01
wandb:     best_valid Recall@10 0.0396
wandb:    best_valid Recall@100 0.1845
wandb:     best_valid Recall@20 0.0657
wandb:     best_valid Recall@50 0.121
wandb:    epoch_loss_norm_train 3.56233
wandb:              test MRR@10 0.0404
wandb:             test MRR@100 0.0497
wandb:              test MRR@20 0.0447
wandb:              test MRR@50 0.0482
wandb:             test NDCG@10 0.0326
wandb:            test NDCG@100 0.0741
wandb:             test NDCG@20 0.0423
wandb:             test NDCG@50 0.059
wandb:        test Precision@10 0.0122
wandb:       test Precision@100 0.0057
wandb:        test Precision@20 0.0101
wandb:        test Precision@50 0.0075
wandb:           test Recall@10 0.0516
wandb:          test Recall@100 0.224
wandb:           test Recall@20 0.0835
wandb:           test Recall@50 0.1506
wandb:             valid MRR@10 0.0501
wandb:            valid MRR@100 0.0608
wandb:             valid MRR@20 0.0552
wandb:             valid MRR@50 0.0592
wandb:            valid NDCG@10 0.0301
wandb:           valid NDCG@100 0.0698
wandb:            valid NDCG@20 0.0387
wandb:            valid NDCG@50 0.0544
wandb:       valid Precision@10 0.0155
wandb:      valid Precision@100 0.0079
wandb:       valid Precision@20 0.0131
wandb:       valid Precision@50 0.01
wandb:          valid Recall@10 0.0394
wandb:         valid Recall@100 0.1839
wandb:          valid Recall@20 0.0655
wandb:          valid Recall@50 0.1203
wandb: 
wandb:  View run T-DiffRec_yelp_clean_3_Reproduction at: https://wandb.ai/drs/drs/runs/5qb0v2k7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_185156-5qb0v2k7/logs
Runing Epoch 064 train loss 488.0397 costs 00: 00: 10
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 045 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0079
 0.0396
0.0657
0.121
0.1845
 0.0301
0.0387
0.0546
0.07
 0.05
0.0552
0.0592
0.0608

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0101
0.0075
0.0057
 0.0528
0.0843
0.1517
0.2257
 0.0332
0.0427
0.0594
0.0747
 0.0408
0.0449
0.0485
0.05

End time:  2023-06-23 19:10:24
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_191036-ebdicyuw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_noisy_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/ebdicyuw
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 19:10:40
user num: 54574
item num: 77405
data ready.
Embedding size: 10
models ready.
Number of all parameters: 154898565
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 330.9493 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 002 train loss 269.0216 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 003 train loss 260.3972 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 004 train loss 257.7582 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0101
0.0087
0.0069
0.0056
 0.0262
0.0442
0.0826
0.1297
 0.0191
0.0247
0.0355
0.0467
 0.0314
0.0351
0.0382
0.0396

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0083
0.007
0.0053
0.0042
 0.0343
0.0564
0.1056
0.1627
 0.0213
0.0281
0.0402
0.052
 0.0268
0.0299
0.0327
0.034

Runing Epoch 005 train loss 255.6628 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 006 train loss 254.0780 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 007 train loss 252.2031 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 008 train loss 250.9584 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 009 train loss 249.1055 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0116
0.01
0.0078
0.0064
 0.0299
0.0503
0.0949
0.1486
 0.0221
0.0286
0.041
0.0538
 0.0366
0.0408
0.0441
0.0456

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0097
0.0081
0.0061
0.0048
 0.0401
0.0661
0.1221
0.1869
 0.0249
0.0328
0.0468
0.0602
 0.0311
0.0347
0.0378
0.0392

Runing Epoch 010 train loss 247.7804 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 011 train loss 246.5069 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 012 train loss 245.0374 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 013 train loss 244.0209 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 014 train loss 243.0003 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0105
0.0083
0.0067
 0.0319
0.0534
0.102
0.158
 0.0234
0.0302
0.0437
0.057
 0.0383
0.0427
0.0463
0.0478

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0086
0.0065
0.0051
 0.0442
0.0717
0.1305
0.1991
 0.0272
0.0356
0.0502
0.0644
 0.0333
0.0371
0.0403
0.0418

Runing Epoch 015 train loss 242.3676 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 016 train loss 241.4987 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 017 train loss 240.4143 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 018 train loss 239.6871 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 019 train loss 239.1811 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0106
0.0084
0.0068
 0.0322
0.0549
0.1042
0.1609
 0.0237
0.0308
0.0444
0.0579
 0.0389
0.0434
0.047
0.0485

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0087
0.0066
0.0051
 0.0444
0.0726
0.1333
0.2024
 0.0275
0.0361
0.0512
0.0654
 0.0339
0.0378
0.0411
0.0425

Runing Epoch 020 train loss 238.6586 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 021 train loss 238.3516 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 022 train loss 237.5922 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 023 train loss 237.1884 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 024 train loss 237.0949 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0106
0.0084
0.0067
 0.0328
0.0547
0.103
0.1604
 0.0238
0.0307
0.0442
0.0577
 0.0389
0.0432
0.0468
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0088
0.0066
0.0052
 0.0443
0.0727
0.1334
0.2038
 0.0275
0.0362
0.0513
0.0658
 0.0339
0.0378
0.0411
0.0426

Runing Epoch 025 train loss 236.7229 costs 00: 01: 09
------------------------------------------------------
Runing Epoch 026 train loss 236.7667 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 027 train loss 236.4334 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 028 train loss 235.9866 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 029 train loss 236.0161 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0106
0.0083
0.0067
 0.0329
0.055
0.1035
0.1597
 0.0238
0.0307
0.0441
0.0575
 0.0386
0.0429
0.0466
0.0481

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0088
0.0066
0.0051
 0.0444
0.0728
0.1317
0.2013
 0.0278
0.0365
0.0512
0.0655
 0.0344
0.0383
0.0416
0.043

Runing Epoch 030 train loss 235.7706 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 031 train loss 235.8428 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 032 train loss 235.4968 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 033 train loss 235.3031 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 034 train loss 235.0161 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0067
 0.0332
0.0556
0.1053
0.1612
 0.0242
0.0313
0.045
0.0583
 0.0394
0.0439
0.0476
0.0491

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0088
0.0066
0.0052
 0.0462
0.0732
0.135
0.2057
 0.0287
0.037
0.0522
0.0668
 0.0352
0.039
0.0424
0.0438

Runing Epoch 035 train loss 235.2181 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 036 train loss 235.1300 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 037 train loss 235.0165 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 038 train loss 234.7315 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 039 train loss 234.8129 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0067
 0.0332
0.0556
0.1052
0.1619
 0.0241
0.0312
0.0448
0.0583
 0.0392
0.0437
0.0473
0.0488

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0089
0.0067
0.0052
 0.0462
0.0747
0.1357
0.2051
 0.0284
0.0371
0.0522
0.0665
 0.0346
0.0385
0.0418
0.0433

Runing Epoch 040 train loss 235.0575 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 041 train loss 235.0229 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 042 train loss 234.7922 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 043 train loss 234.7859 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 044 train loss 234.9737 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0106
0.0084
0.0067
 0.0329
0.0556
0.104
0.1604
 0.0239
0.0312
0.0446
0.058
 0.039
0.0435
0.0471
0.0486

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0051
 0.0454
0.0733
0.1348
0.2041
 0.0279
0.0365
0.0517
0.066
 0.0343
0.0381
0.0415
0.043

Runing Epoch 045 train loss 234.7882 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 046 train loss 234.8410 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 047 train loss 234.6136 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 048 train loss 234.7506 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 049 train loss 234.6896 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0108
0.0085
0.0068
 0.0328
0.0565
0.1057
0.1633
 0.0239
0.0313
0.045
0.0586
 0.0391
0.0437
0.0474
0.0489

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0451
0.0735
0.1355
0.2063
 0.0278
0.0365
0.0518
0.0664
 0.0343
0.0382
0.0415
0.043

Runing Epoch 050 train loss 234.4705 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 051 train loss 234.5286 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 052 train loss 234.7037 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 053 train loss 234.4024 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 054 train loss 234.4072 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0067
 0.0332
0.0561
0.1051
0.1623
 0.0241
0.0313
0.0449
0.0584
 0.0392
0.0437
0.0473
0.0488

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0457
0.0739
0.136
0.2064
 0.0282
0.0368
0.0521
0.0666
 0.0345
0.0383
0.0417
0.0432

Runing Epoch 055 train loss 234.5501 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 056 train loss 234.6284 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 057 train loss 234.6580 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 058 train loss 234.6188 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 059 train loss 234.5681 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0068
 0.0331
0.0561
0.1058
0.1634
 0.0238
0.0311
0.0449
0.0584
 0.0388
0.0433
0.047
0.0485

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0088
0.0067
0.0052
 0.0454
0.0738
0.136
0.2074
 0.0279
0.0366
0.052
0.0666
 0.0341
0.0379
0.0413
0.0428

Runing Epoch 060 train loss 234.3870 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 061 train loss 234.5717 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 062 train loss 234.3125 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 063 train loss 234.2843 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 064 train loss 234.4180 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0067
 0.0335
0.0563
0.1053
0.1621
 0.024
0.0312
0.0447
0.0582
 0.0389
0.0434
0.0471
0.0485

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0455
0.0737
0.1356
0.2051
 0.0282
0.0368
0.0521
0.0664
 0.0347
0.0385
0.0419
0.0434

Runing Epoch 065 train loss 234.3559 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 066 train loss 234.2699 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 067 train loss 234.5360 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 068 train loss 234.7424 costs 00: 00: 17
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 50
wandb:         batch_loss_train 1.74996
wandb:         best_test MRR@10 0.0343
wandb:        best_test MRR@100 0.043
wandb:         best_test MRR@20 0.0382
wandb:         best_test MRR@50 0.0415
wandb:        best_test NDCG@10 0.0278
wandb:       best_test NDCG@100 0.0664
wandb:        best_test NDCG@20 0.0365
wandb:        best_test NDCG@50 0.0518
wandb:   best_test Precision@10 0.0106
wandb:  best_test Precision@100 0.0052
wandb:   best_test Precision@20 0.0088
wandb:   best_test Precision@50 0.0067
wandb:      best_test Recall@10 0.0451
wandb:     best_test Recall@100 0.2063
wandb:      best_test Recall@20 0.0735
wandb:      best_test Recall@50 0.1355
wandb:        best_valid MRR@10 0.0391
wandb:       best_valid MRR@100 0.0489
wandb:        best_valid MRR@20 0.0437
wandb:        best_valid MRR@50 0.0474
wandb:       best_valid NDCG@10 0.0239
wandb:      best_valid NDCG@100 0.0586
wandb:       best_valid NDCG@20 0.0313
wandb:       best_valid NDCG@50 0.045
wandb:  best_valid Precision@10 0.0125
wandb: best_valid Precision@100 0.0068
wandb:  best_valid Precision@20 0.0108
wandb:  best_valid Precision@50 0.0085
wandb:     best_valid Recall@10 0.0328
wandb:    best_valid Recall@100 0.1633
wandb:     best_valid Recall@20 0.0565
wandb:     best_valid Recall@50 0.1057
wandb:    epoch_loss_norm_train 1.71083
wandb:              test MRR@10 0.0347
wandb:             test MRR@100 0.0434
wandb:              test MRR@20 0.0385
wandb:              test MRR@50 0.0419
wandb:             test NDCG@10 0.0282
wandb:            test NDCG@100 0.0664
wandb:             test NDCG@20 0.0368
wandb:             test NDCG@50 0.0521
wandb:        test Precision@10 0.0106
wandb:       test Precision@100 0.0052
wandb:        test Precision@20 0.0088
wandb:        test Precision@50 0.0067
wandb:           test Recall@10 0.0455
wandb:          test Recall@100 0.2051
wandb:           test Recall@20 0.0737
wandb:           test Recall@50 0.1356
wandb:             valid MRR@10 0.0389
wandb:            valid MRR@100 0.0485
wandb:             valid MRR@20 0.0434
wandb:             valid MRR@50 0.0471
wandb:            valid NDCG@10 0.024
wandb:           valid NDCG@100 0.0582
wandb:            valid NDCG@20 0.0312
wandb:            valid NDCG@50 0.0447
wandb:       valid Precision@10 0.0124
wandb:      valid Precision@100 0.0067
wandb:       valid Precision@20 0.0107
wandb:       valid Precision@50 0.0084
wandb:          valid Recall@10 0.0335
wandb:         valid Recall@100 0.1621
wandb:          valid Recall@20 0.0563
wandb:          valid Recall@50 0.1053
wandb: 
wandb:  View run T-DiffRec_yelp_noisy_3_Reproduction at: https://wandb.ai/drs/drs/runs/ebdicyuw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_191036-ebdicyuw/logs
Runing Epoch 069 train loss 234.3842 costs 00: 00: 16
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 050 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0108
0.0085
0.0068
 0.0328
0.0565
0.1057
0.1633
 0.0239
0.0313
0.045
0.0586
 0.0391
0.0437
0.0474
0.0489

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0451
0.0735
0.1355
0.2063
 0.0278
0.0365
0.0518
0.0664
 0.0343
0.0382
0.0415
0.043

End time:  2023-06-23 19:41:55
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_194208-u890e3q5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_clean_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/u890e3q5
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 19:42:11
user num: 5949
item num: 2810
data ready.
Embedding size: 10
models ready.
Number of all parameters: 5633970
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 6585.1340 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 5655.4826 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 5176.3885 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4823.2128 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.063
0.056
0.0455
0.0366
 0.0458
0.0786
0.1504
0.223
 0.0713
0.078
0.1006
0.1277
 0.1465
0.1557
0.1615
0.163

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0453
0.0404
0.0311
0.0239
 0.0595
0.1021
0.1846
0.263
 0.0598
0.0731
0.1011
0.1267
 0.1114
0.1203
0.126
0.1276

Runing Epoch 005 train loss 4486.9840 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 4225.2544 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3983.1200 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3778.8734 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3584.1628 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0665
0.0603
0.0503
0.0421
 0.0505
0.0894
0.1735
0.2676
 0.0769
0.086
0.1138
0.1488
 0.1586
0.1691
0.1752
0.1767

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.052
0.0464
0.0374
0.0299
 0.0709
0.1206
0.2263
0.3402
 0.0707
0.0869
0.1236
0.16
 0.1289
0.1392
0.1455
0.1473

Runing Epoch 010 train loss 3433.3809 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 3278.4634 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 3157.6733 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 3028.4025 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2919.1599 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.067
0.0613
0.0525
0.0446
 0.0547
0.0953
0.1921
0.3005
 0.0787
0.0892
0.122
0.1616
 0.161
0.1722
0.1791
0.1805

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0566
0.0502
0.0416
0.0332
 0.0817
0.1378
0.2649
0.4001
 0.0784
0.0971
0.1411
0.1832
 0.1395
0.1504
0.1573
0.159

Runing Epoch 015 train loss 2821.7043 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2730.0524 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2651.0466 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2576.6929 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2495.4619 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0664
0.0616
0.0531
0.0454
 0.056
0.1
0.1981
0.3146
 0.0784
0.0905
0.1244
0.1664
 0.1585
0.1703
0.1772
0.1787

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0585
0.053
0.0433
0.0345
 0.0885
0.1502
0.2852
0.4238
 0.0823
0.1039
0.1502
0.1936
 0.1426
0.1542
0.1613
0.1628

Runing Epoch 020 train loss 2450.2732 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2390.9546 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2335.7928 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2282.5390 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 2239.5003 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0665
0.0614
0.0533
0.0457
 0.0598
0.1037
0.207
0.3233
 0.0797
0.0924
0.1279
0.1702
 0.1585
0.1706
0.1775
0.1791

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.061
0.0547
0.0447
0.0352
 0.0961
0.1629
0.3021
0.4423
 0.0872
0.1103
0.1583
0.2021
 0.1474
0.1596
0.1665
0.1679

Runing Epoch 025 train loss 2198.0322 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 2160.6438 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 2124.3905 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 2088.0426 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 2059.1780 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.0609
0.0534
0.0457
 0.0596
0.1049
0.2121
0.3304
 0.0785
0.0918
0.1287
0.1716
 0.155
0.167
0.1741
0.1757

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0601
0.055
0.0452
0.0357
 0.0968
0.167
0.3132
0.4531
 0.0868
0.1117
0.1618
0.206
 0.146
0.159
0.1662
0.1675

Runing Epoch 030 train loss 2023.9759 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1996.6695 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1970.4314 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1944.6534 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1918.8293 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0659
0.0615
0.0537
0.046
 0.0614
0.1095
0.2173
0.3356
 0.0788
0.0934
0.1308
0.1738
 0.1532
0.1652
0.1725
0.174

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0617
0.0564
0.0459
0.0363
 0.1026
0.176
0.3241
0.4669
 0.0905
0.1164
0.167
0.212
 0.1501
0.1632
0.1703
0.1716

Runing Epoch 035 train loss 1901.0880 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1882.6328 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1856.2559 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1839.0815 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1818.0253 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.061
0.0529
0.0456
 0.0611
0.1086
0.2136
0.3351
 0.0791
0.0932
0.1294
0.1732
 0.1538
0.1662
0.1733
0.1748

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0621
0.0566
0.0461
0.0363
 0.1055
0.1783
0.3258
0.4715
 0.0922
0.118
0.1687
0.2142
 0.1546
0.1673
0.1743
0.1757

Runing Epoch 040 train loss 1806.4949 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1782.4120 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1763.9388 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1757.7965 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1741.6431 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0659
0.061
0.0533
0.0458
 0.0633
0.1111
0.2182
0.34
 0.0797
0.094
0.1313
0.1752
 0.1552
0.1673
0.1744
0.1759

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.063
0.0573
0.0463
0.0362
 0.1065
0.1823
0.3288
0.4739
 0.0932
0.1199
0.1703
0.2154
 0.1549
0.1678
0.1747
0.176

Runing Epoch 045 train loss 1729.6091 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1711.0832 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1703.9545 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1687.6462 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1677.5138 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.0609
0.0531
0.0455
 0.0617
0.1093
0.2193
0.3399
 0.0793
0.0935
0.1313
0.1748
 0.1543
0.1665
0.1738
0.1753

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0632
0.0571
0.0465
0.0364
 0.1061
0.1808
0.3339
0.4809
 0.0938
0.12
0.1722
0.2177
 0.1566
0.1691
0.1762
0.1776

Runing Epoch 050 train loss 1661.7196 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1646.6652 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1640.1633 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1626.4550 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1620.6653 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.0612
0.0532
0.0457
 0.0644
0.1118
0.2208
0.3429
 0.0801
0.0948
0.1325
0.1764
 0.155
0.1673
0.1746
0.1761

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0634
0.0571
0.0462
0.0364
 0.1092
0.1827
0.3327
0.4784
 0.0951
0.1211
0.1724
0.2178
 0.1572
0.1699
0.1769
0.1782

Runing Epoch 055 train loss 1606.3705 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1594.8521 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1588.0474 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1582.5557 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1566.8915 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0661
0.0611
0.053
0.0456
 0.0638
0.113
0.2201
0.3433
 0.0803
0.095
0.1321
0.1763
 0.1558
0.1679
0.1751
0.1766

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.058
0.0467
0.0366
 0.1113
0.1865
0.339
0.4845
 0.096
0.1227
0.1746
0.2201
 0.1585
0.1712
0.1781
0.1794

Runing Epoch 060 train loss 1563.6375 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1556.1459 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1546.2027 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1536.0706 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1533.1385 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0662
0.0613
0.0534
0.0458
 0.0638
0.1143
0.222
0.3443
 0.0803
0.0953
0.1329
0.1768
 0.1562
0.1683
0.1756
0.1771

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0579
0.0467
0.0367
 0.1124
0.1891
0.34
0.4875
 0.0961
0.1231
0.1748
0.2207
 0.1568
0.1698
0.1766
0.178

Runing Epoch 065 train loss 1524.7990 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1518.1533 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1512.0994 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1498.1141 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 069 train loss 1497.0851 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.0605
0.0526
0.0452
 0.0649
0.1125
0.2202
0.341
 0.0804
0.0946
0.1319
0.1753
 0.1564
0.1686
0.1759
0.1774

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0576
0.0464
0.0365
 0.1124
0.1901
0.3384
0.4846
 0.0979
0.1251
0.1761
0.2217
 0.1615
0.1743
0.1812
0.1826

Runing Epoch 070 train loss 1490.9366 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1480.5185 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 072 train loss 1475.6934 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 073 train loss 1467.7680 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 074 train loss 1462.8962 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0655
0.0603
0.0528
0.0454
 0.0643
0.1121
0.2209
0.3433
 0.0798
0.094
0.1318
0.1757
 0.1552
0.1674
0.1747
0.1762

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0636
0.0578
0.0467
0.0366
 0.1126
0.1896
0.3404
0.487
 0.0973
0.1246
0.1764
0.2221
 0.1603
0.1734
0.1802
0.1817

Runing Epoch 075 train loss 1455.2714 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 076 train loss 1456.0376 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 077 train loss 1446.2254 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 078 train loss 1442.4238 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 079 train loss 1436.8780 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0647
0.06
0.0525
0.0452
 0.0626
0.111
0.2192
0.3415
 0.0791
0.0936
0.1313
0.175
 0.155
0.1676
0.1751
0.1767

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0637
0.0571
0.0465
0.0364
 0.1116
0.1858
0.3395
0.485
 0.0971
0.1232
0.1757
0.221
 0.1609
0.1734
0.1803
0.1817

Runing Epoch 080 train loss 1426.3778 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 081 train loss 1426.4080 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 082 train loss 1424.1725 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 083 train loss 1414.9721 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 65
wandb:         batch_loss_train 98.71056
wandb:         best_test MRR@10 0.1568
wandb:        best_test MRR@100 0.178
wandb:         best_test MRR@20 0.1698
wandb:         best_test MRR@50 0.1766
wandb:        best_test NDCG@10 0.0961
wandb:       best_test NDCG@100 0.2207
wandb:        best_test NDCG@20 0.1231
wandb:        best_test NDCG@50 0.1748
wandb:   best_test Precision@10 0.0642
wandb:  best_test Precision@100 0.0367
wandb:   best_test Precision@20 0.0579
wandb:   best_test Precision@50 0.0467
wandb:      best_test Recall@10 0.1124
wandb:     best_test Recall@100 0.4875
wandb:      best_test Recall@20 0.1891
wandb:      best_test Recall@50 0.34
wandb:        best_valid MRR@10 0.1562
wandb:       best_valid MRR@100 0.1771
wandb:        best_valid MRR@20 0.1683
wandb:        best_valid MRR@50 0.1756
wandb:       best_valid NDCG@10 0.0803
wandb:      best_valid NDCG@100 0.1768
wandb:       best_valid NDCG@20 0.0953
wandb:       best_valid NDCG@50 0.1329
wandb:  best_valid Precision@10 0.0662
wandb: best_valid Precision@100 0.0458
wandb:  best_valid Precision@20 0.0613
wandb:  best_valid Precision@50 0.0534
wandb:     best_valid Recall@10 0.0638
wandb:    best_valid Recall@100 0.3443
wandb:     best_valid Recall@20 0.1143
wandb:     best_valid Recall@50 0.222
wandb:    epoch_loss_norm_train 94.18666
wandb:              test MRR@10 0.1609
wandb:             test MRR@100 0.1817
wandb:              test MRR@20 0.1734
wandb:              test MRR@50 0.1803
wandb:             test NDCG@10 0.0971
wandb:            test NDCG@100 0.221
wandb:             test NDCG@20 0.1232
wandb:             test NDCG@50 0.1757
wandb:        test Precision@10 0.0637
wandb:       test Precision@100 0.0364
wandb:        test Precision@20 0.0571
wandb:        test Precision@50 0.0465
wandb:           test Recall@10 0.1116
wandb:          test Recall@100 0.485
wandb:           test Recall@20 0.1858
wandb:           test Recall@50 0.3395
wandb:             valid MRR@10 0.155
wandb:            valid MRR@100 0.1767
wandb:             valid MRR@20 0.1676
wandb:             valid MRR@50 0.1751
wandb:            valid NDCG@10 0.0791
wandb:           valid NDCG@100 0.175
wandb:            valid NDCG@20 0.0936
wandb:            valid NDCG@50 0.1313
wandb:       valid Precision@10 0.0647
wandb:      valid Precision@100 0.0452
wandb:       valid Precision@20 0.06
wandb:       valid Precision@50 0.0525
wandb:          valid Recall@10 0.0626
wandb:         valid Recall@100 0.3415
wandb:          valid Recall@20 0.111
wandb:          valid Recall@50 0.2192
wandb: 
wandb:  View run T-DiffRec_ml-1m_clean_3_Reproduction at: https://wandb.ai/drs/drs/runs/u890e3q5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_194208-u890e3q5/logs
Runing Epoch 084 train loss 1412.7999 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 065 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0662
0.0613
0.0534
0.0458
 0.0638
0.1143
0.222
0.3443
 0.0803
0.0953
0.1329
0.1768
 0.1562
0.1683
0.1756
0.1771

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0579
0.0467
0.0367
 0.1124
0.1891
0.34
0.4875
 0.0961
0.1231
0.1748
0.2207
 0.1568
0.1698
0.1766
0.178

End time:  2023-06-23 19:44:11
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_194425-825mvngs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_noisy_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/825mvngs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 19:44:29
user num: 5949
item num: 3494
data ready.
Embedding size: 10
models ready.
Number of all parameters: 7002654
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 5293.6130 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 4664.3213 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 4321.7855 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4028.0173 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0353
0.0341
0.032
0.0287
 0.029
0.0528
0.1113
0.1773
 0.0417
0.0489
0.0687
0.0919
 0.0924
0.1026
0.1095
0.1112

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0326
0.0304
0.0252
0.0207
 0.048
0.0811
0.1557
0.2377
 0.0449
0.0565
0.0824
0.1086
 0.0883
0.0976
0.1035
0.1054

Runing Epoch 005 train loss 3781.5489 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 3570.7417 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3376.5589 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3219.6834 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3082.0076 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0346
0.0347
0.0341
0.0315
 0.0324
0.0597
0.1277
0.2083
 0.0411
0.0507
0.0751
0.1035
 0.0879
0.099
0.1067
0.1085

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0344
0.0329
0.0285
0.0243
 0.055
0.0954
0.187
0.2918
 0.0482
0.0634
0.0957
0.129
 0.089
0.0997
0.1063
0.1083

Runing Epoch 010 train loss 2938.9109 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 2821.7574 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 2724.3372 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2633.1028 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2538.6333 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0344
0.0346
0.0346
0.0324
 0.0359
0.0648
0.1384
0.2294
 0.0416
0.0521
0.0789
0.1106
 0.0858
0.0976
0.1057
0.1076

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0346
0.0335
0.0302
0.0261
 0.0604
0.106
0.2122
0.332
 0.0506
0.0682
0.1054
0.143
 0.0894
0.1004
0.108
0.11

Runing Epoch 015 train loss 2462.6732 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2388.2033 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2326.3858 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2266.9352 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2211.9020 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0336
0.0338
0.0345
0.0331
 0.0365
0.0686
0.1477
0.2487
 0.0416
0.053
0.0818
0.1167
 0.0855
0.0973
0.1058
0.1078

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0347
0.0346
0.0313
0.0273
 0.0629
0.1156
0.2328
0.3626
 0.0519
0.0722
0.1129
0.1533
 0.0904
0.1025
0.1104
0.1125

Runing Epoch 020 train loss 2165.4122 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2115.5537 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2077.3222 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2031.1267 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 1995.3457 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0328
0.0336
0.034
0.0329
 0.0372
0.0697
0.1526
0.255
 0.0407
0.0527
0.0824
0.1178
 0.0814
0.0937
0.1023
0.1044

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0353
0.035
0.0318
0.0276
 0.0672
0.1213
0.2443
0.3788
 0.0541
0.075
0.1171
0.1587
 0.0913
0.1032
0.1114
0.1135

Runing Epoch 025 train loss 1963.5820 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 1936.5287 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 1895.5529 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 1879.6235 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 1845.4576 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0328
0.034
0.0342
0.0332
 0.0382
0.0734
0.1552
0.2651
 0.0409
0.0539
0.0834
0.1206
 0.0817
0.0943
0.1027
0.1049

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0358
0.0351
0.032
0.0279
 0.0707
0.1262
0.2507
0.3914
 0.0548
0.0761
0.1191
0.1621
 0.0901
0.1025
0.1108
0.1129

Runing Epoch 030 train loss 1819.6353 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1794.2358 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1773.4292 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1750.9153 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1734.2510 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0316
0.0333
0.0343
0.0332
 0.0381
0.0723
0.1596
0.2692
 0.0401
0.053
0.0842
0.1213
 0.0802
0.0928
0.1015
0.1036

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0356
0.0324
0.0281
 0.0693
0.1286
0.2581
0.4001
 0.0551
0.0776
0.1218
0.1651
 0.0907
0.1034
0.1117
0.1138

Runing Epoch 035 train loss 1712.2895 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1696.9431 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1678.5874 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1666.4534 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1653.6379 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0311
0.0328
0.0338
0.0327
 0.0367
0.0716
0.161
0.2681
 0.0393
0.0523
0.0838
0.1204
 0.0781
0.0906
0.0995
0.1016

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0363
0.0356
0.0321
0.0279
 0.0717
0.1305
0.2599
0.4009
 0.0563
0.0785
0.1224
0.1653
 0.0919
0.1042
0.1125
0.1145

Runing Epoch 040 train loss 1634.8470 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1620.1599 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1602.6508 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1586.1313 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1571.1191 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0323
0.033
0.0338
0.0326
 0.0403
0.0741
0.1616
0.27
 0.041
0.0534
0.0845
0.1213
 0.0793
0.0915
0.1005
0.1027

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0356
0.0357
0.0323
0.0279
 0.0715
0.1325
0.2642
0.4046
 0.0561
0.0793
0.1239
0.1667
 0.0908
0.1037
0.1121
0.1141

Runing Epoch 045 train loss 1562.8706 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1551.5223 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1542.1245 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1529.3607 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1519.7478 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.032
0.0331
0.0336
0.0325
 0.0396
0.0745
0.1609
0.2716
 0.0412
0.054
0.0848
0.1221
 0.0811
0.0938
0.1024
0.1046

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0364
0.0356
0.0324
0.0278
 0.073
0.1324
0.2667
0.4085
 0.0575
0.0799
0.1252
0.1681
 0.0936
0.1057
0.1142
0.1162

Runing Epoch 050 train loss 1506.9104 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1496.4882 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1485.6045 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1477.6201 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1464.5391 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0317
0.0329
0.0339
0.0328
 0.0398
0.0752
0.1666
0.2778
 0.0412
0.0542
0.0865
0.124
 0.0827
0.0952
0.1043
0.1064

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.036
0.0357
0.0325
0.028
 0.0721
0.1348
0.2711
0.4155
 0.0566
0.08
0.1258
0.1695
 0.0925
0.1053
0.1138
0.1159

Runing Epoch 055 train loss 1460.1018 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1448.0787 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1442.1828 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1436.7513 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1425.0437 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0317
0.0333
0.0336
0.0327
 0.0399
0.0754
0.1663
0.2784
 0.0412
0.0545
0.0862
0.1239
 0.0821
0.0948
0.1036
0.1059

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.036
0.0324
0.028
 0.0733
0.1353
0.2704
0.4157
 0.0575
0.0808
0.1261
0.17
 0.0925
0.105
0.1135
0.1157

Runing Epoch 060 train loss 1420.5622 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1409.2069 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1402.3136 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1393.3778 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1386.9619 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0303
0.0328
0.0331
0.0324
 0.0373
0.075
0.1635
0.2756
 0.0391
0.0532
0.0842
0.1219
 0.0777
0.0908
0.0998
0.102

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0352
0.0324
0.0279
 0.0729
0.134
0.2716
0.4156
 0.0557
0.0786
0.1247
0.1681
 0.0887
0.101
0.1098
0.1119

Runing Epoch 065 train loss 1379.8272 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1374.1260 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1367.3515 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1356.8258 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 069 train loss 1352.3520 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0318
0.0324
0.0334
0.0322
 0.0404
0.0743
0.163
0.2722
 0.0409
0.0531
0.0845
0.1213
 0.0805
0.0926
0.1016
0.1038

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0355
0.0321
0.0276
 0.0744
0.1343
0.2706
0.4104
 0.0565
0.0792
0.1247
0.1672
 0.0883
0.1007
0.1092
0.1114

Runing Epoch 070 train loss 1345.4581 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1339.3481 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 072 train loss 1335.6247 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 073 train loss 1327.3845 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 074 train loss 1323.1595 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0315
0.0328
0.0331
0.0322
 0.0393
0.0761
0.1615
0.276
 0.0404
0.0538
0.0842
0.1221
 0.0801
0.0926
0.1014
0.1037

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0361
0.0354
0.0322
0.0275
 0.0745
0.1349
0.2718
0.4133
 0.0571
0.0798
0.1256
0.1682
 0.0905
0.1029
0.1114
0.1135

Runing Epoch 075 train loss 1320.8689 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 076 train loss 1309.1443 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 077 train loss 1308.4780 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 078 train loss 1299.3522 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 079 train loss 1292.9883 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0323
0.0335
0.0334
0.0322
 0.0411
0.0764
0.1663
0.2738
 0.0419
0.0552
0.0864
0.1228
 0.0826
0.0951
0.1039
0.106

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0369
0.0358
0.0326
0.0278
 0.0751
0.1369
0.2734
0.414
 0.0584
0.0814
0.1274
0.1699
 0.0932
0.1056
0.1143
0.1163

Runing Epoch 080 train loss 1292.7572 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 081 train loss 1285.7412 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 082 train loss 1278.1031 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 083 train loss 1278.5685 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 084 train loss 1271.5399 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0312
0.0329
0.033
0.0321
 0.0394
0.0758
0.1635
0.2745
 0.0403
0.0538
0.0846
0.1218
 0.0795
0.092
0.1008
0.1031

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0363
0.0354
0.0323
0.0275
 0.0746
0.1358
0.2741
0.4126
 0.0568
0.0797
0.126
0.168
 0.0892
0.1014
0.1102
0.1123

Runing Epoch 085 train loss 1263.8962 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 086 train loss 1258.3836 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 087 train loss 1255.3295 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 088 train loss 1251.9071 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 089 train loss 1251.3008 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0318
0.0328
0.0332
0.032
 0.0402
0.0761
0.1637
0.2739
 0.0412
0.0542
0.0851
0.122
 0.0819
0.0942
0.103
0.1053

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0358
0.0358
0.0323
0.0275
 0.074
0.1368
0.2747
0.414
 0.057
0.0806
0.1267
0.1688
 0.091
0.1039
0.1125
0.1145

Runing Epoch 090 train loss 1247.3661 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 091 train loss 1237.5014 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 092 train loss 1237.6824 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 093 train loss 1230.7269 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 094 train loss 1228.9558 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0317
0.0327
0.0332
0.0322
 0.0397
0.0745
0.1641
0.2737
 0.0406
0.0534
0.0847
0.1217
 0.0808
0.093
0.102
0.1042

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0361
0.0323
0.0276
 0.0753
0.1385
0.2714
0.4115
 0.0572
0.0811
0.126
0.1683
 0.091
0.1037
0.1122
0.1143

Runing Epoch 095 train loss 1222.1670 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 096 train loss 1219.8158 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 097 train loss 1216.2848 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 098 train loss 1215.5665 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 80
wandb:         batch_loss_train 82.45275
wandb:         best_test MRR@10 0.0932
wandb:        best_test MRR@100 0.1163
wandb:         best_test MRR@20 0.1056
wandb:         best_test MRR@50 0.1143
wandb:        best_test NDCG@10 0.0584
wandb:       best_test NDCG@100 0.1699
wandb:        best_test NDCG@20 0.0814
wandb:        best_test NDCG@50 0.1274
wandb:   best_test Precision@10 0.0369
wandb:  best_test Precision@100 0.0278
wandb:   best_test Precision@20 0.0358
wandb:   best_test Precision@50 0.0326
wandb:      best_test Recall@10 0.0751
wandb:     best_test Recall@100 0.414
wandb:      best_test Recall@20 0.1369
wandb:      best_test Recall@50 0.2734
wandb:        best_valid MRR@10 0.0826
wandb:       best_valid MRR@100 0.106
wandb:        best_valid MRR@20 0.0951
wandb:        best_valid MRR@50 0.1039
wandb:       best_valid NDCG@10 0.0419
wandb:      best_valid NDCG@100 0.1228
wandb:       best_valid NDCG@20 0.0552
wandb:       best_valid NDCG@50 0.0864
wandb:  best_valid Precision@10 0.0323
wandb: best_valid Precision@100 0.0322
wandb:  best_valid Precision@20 0.0335
wandb:  best_valid Precision@50 0.0334
wandb:     best_valid Recall@10 0.0411
wandb:    best_valid Recall@100 0.2738
wandb:     best_valid Recall@20 0.0764
wandb:     best_valid Recall@50 0.1663
wandb:    epoch_loss_norm_train 80.87562
wandb:              test MRR@10 0.091
wandb:             test MRR@100 0.1143
wandb:              test MRR@20 0.1037
wandb:              test MRR@50 0.1122
wandb:             test NDCG@10 0.0572
wandb:            test NDCG@100 0.1683
wandb:             test NDCG@20 0.0811
wandb:             test NDCG@50 0.126
wandb:        test Precision@10 0.0362
wandb:       test Precision@100 0.0276
wandb:        test Precision@20 0.0361
wandb:        test Precision@50 0.0323
wandb:           test Recall@10 0.0753
wandb:          test Recall@100 0.4115
wandb:           test Recall@20 0.1385
wandb:           test Recall@50 0.2714
wandb:             valid MRR@10 0.0808
wandb:            valid MRR@100 0.1042
wandb:             valid MRR@20 0.093
wandb:             valid MRR@50 0.102
wandb:            valid NDCG@10 0.0406
wandb:           valid NDCG@100 0.1217
wandb:            valid NDCG@20 0.0534
wandb:            valid NDCG@50 0.0847
wandb:       valid Precision@10 0.0317
wandb:      valid Precision@100 0.0322
wandb:       valid Precision@20 0.0327
wandb:       valid Precision@50 0.0332
wandb:          valid Recall@10 0.0397
wandb:         valid Recall@100 0.2737
wandb:          valid Recall@20 0.0745
wandb:          valid Recall@50 0.1641
wandb: 
wandb:  View run T-DiffRec_ml-1m_noisy_3_Reproduction at: https://wandb.ai/drs/drs/runs/825mvngs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_194425-825mvngs/logs
Runing Epoch 099 train loss 1213.1344 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 080 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0323
0.0335
0.0334
0.0322
 0.0411
0.0764
0.1663
0.2738
 0.0419
0.0552
0.0864
0.1228
 0.0826
0.0951
0.1039
0.106

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0369
0.0358
0.0326
0.0278
 0.0751
0.1369
0.2734
0.414
 0.0584
0.0814
0.1274
0.1699
 0.0932
0.1056
0.1143
0.1163

End time:  2023-06-23 19:46:52
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_194705-bzedti2c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_clean_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/bzedti2c
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 19:47:08
user num: 54574
item num: 34395
data ready.
Embedding size: 10
models ready.
Number of all parameters: 68835555
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 785.0091 costs 00: 00: 11
------------------------------------------------------
Runing Epoch 002 train loss 605.5778 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 003 train loss 561.1394 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 004 train loss 546.6948 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0105
0.008
0.0063
 0.03
0.0504
0.0926
0.141
 0.0233
0.03
0.0421
0.054
 0.0395
0.0436
0.047
0.0484

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.009
0.0076
0.0057
0.0044
 0.0368
0.0614
0.1113
0.1698
 0.0235
0.031
0.0434
0.0555
 0.0302
0.0336
0.0364
0.0377

Runing Epoch 005 train loss 539.6238 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 006 train loss 533.8190 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 007 train loss 529.7335 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 008 train loss 525.9904 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 009 train loss 521.8845 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0145
0.0122
0.0093
0.0073
 0.0361
0.0598
0.1107
0.1685
 0.0276
0.0354
0.05
0.0641
 0.0463
0.051
0.0548
0.0563

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0111
0.0091
0.0068
0.0053
 0.0465
0.0742
0.1362
0.2056
 0.0295
0.038
0.0533
0.0677
 0.0372
0.0409
0.0443
0.0457

Runing Epoch 010 train loss 518.8894 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 011 train loss 515.8493 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 012 train loss 512.7146 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 013 train loss 509.6687 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 014 train loss 507.7653 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0151
0.0127
0.0097
0.0076
 0.0375
0.0625
0.1144
0.174
 0.0289
0.037
0.052
0.0666
 0.0485
0.0533
0.0572
0.0588

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0118
0.0098
0.0072
0.0055
 0.049
0.08
0.1433
0.2129
 0.0311
0.0405
0.0563
0.0707
 0.0391
0.0431
0.0465
0.048

Runing Epoch 015 train loss 505.3844 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 016 train loss 503.9919 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 017 train loss 501.2666 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 018 train loss 500.0047 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 019 train loss 498.7051 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0128
0.0098
0.0077
 0.0378
0.0629
0.1157
0.1761
 0.0291
0.0373
0.0525
0.0673
 0.049
0.0539
0.0578
0.0594

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.012
0.0098
0.0073
0.0055
 0.0501
0.0804
0.1437
0.213
 0.0315
0.0407
0.0565
0.0709
 0.0394
0.0434
0.0468
0.0482

Runing Epoch 020 train loss 497.7575 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 021 train loss 496.2755 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 022 train loss 495.2709 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 023 train loss 495.0498 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 024 train loss 493.9976 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0157
0.013
0.0099
0.0078
 0.0394
0.0641
0.1174
0.1783
 0.03
0.0381
0.0534
0.0683
 0.0498
0.0547
0.0587
0.0602

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0074
0.0056
 0.0515
0.0826
0.1465
0.2187
 0.0324
0.0419
0.058
0.0729
 0.0404
0.0446
0.048
0.0495

Runing Epoch 025 train loss 492.9431 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 026 train loss 492.6517 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 027 train loss 492.1384 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 028 train loss 491.9813 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 029 train loss 491.4791 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0129
0.0098
0.0077
 0.0382
0.0635
0.1165
0.1766
 0.0292
0.0374
0.0527
0.0674
 0.0488
0.0537
0.0577
0.0592

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.01
0.0073
0.0056
 0.0509
0.0816
0.1451
0.2151
 0.032
0.0414
0.0572
0.0717
 0.0397
0.0438
0.0472
0.0487

Runing Epoch 030 train loss 491.0728 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 031 train loss 490.1693 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 032 train loss 490.5601 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 033 train loss 490.1964 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 034 train loss 490.4616 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0128
0.0097
0.0076
 0.0384
0.0633
0.1158
0.1762
 0.0291
0.0373
0.0525
0.0671
 0.0485
0.0534
0.0573
0.0589

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.012
0.0099
0.0073
0.0055
 0.0505
0.0821
0.1454
0.2156
 0.0317
0.0414
0.0571
0.0717
 0.0396
0.0437
0.0471
0.0486

Runing Epoch 035 train loss 489.9126 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 036 train loss 489.6928 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 037 train loss 489.3019 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 038 train loss 488.7857 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 039 train loss 488.8342 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.013
0.0099
0.0078
 0.0386
0.0645
0.1171
0.1788
 0.0295
0.038
0.0532
0.0682
 0.0493
0.0543
0.0582
0.0598

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0101
0.0074
0.0056
 0.0508
0.0822
0.1471
0.2179
 0.0321
0.0417
0.0579
0.0726
 0.0402
0.0444
0.0479
0.0493

Runing Epoch 040 train loss 488.5609 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 041 train loss 488.5682 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 042 train loss 488.3571 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 043 train loss 488.5501 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 044 train loss 488.7910 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.013
0.0099
0.0078
 0.0385
0.0643
0.1177
0.1791
 0.0294
0.0379
0.0532
0.0682
 0.0492
0.0543
0.0582
0.0598

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.01
0.0074
0.0056
 0.0509
0.0819
0.1465
0.2186
 0.0321
0.0416
0.0577
0.0726
 0.0398
0.044
0.0474
0.0489

Runing Epoch 045 train loss 488.6974 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 046 train loss 488.1165 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 047 train loss 488.4703 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 048 train loss 487.8825 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 049 train loss 488.5679 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.0132
0.01
0.0078
 0.0392
0.0652
0.1192
0.1819
 0.0298
0.0383
0.0539
0.0691
 0.0494
0.0545
0.0585
0.0601

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0102
0.0075
0.0057
 0.0522
0.0842
0.1486
0.2224
 0.0327
0.0424
0.0585
0.0738
 0.0408
0.045
0.0485
0.05

Runing Epoch 050 train loss 488.3403 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 051 train loss 488.0988 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 052 train loss 487.8804 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 053 train loss 487.7977 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 054 train loss 488.0039 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.0099
0.0078
 0.0387
0.0647
0.1189
0.1808
 0.0294
0.0379
0.0534
0.0685
 0.0488
0.0538
0.0578
0.0594

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0101
0.0074
0.0057
 0.0511
0.083
0.1485
0.2226
 0.032
0.0417
0.058
0.0733
 0.0395
0.0437
0.0472
0.0487

Runing Epoch 055 train loss 487.6688 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 056 train loss 487.6825 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 057 train loss 487.1870 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 058 train loss 487.6218 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 059 train loss 488.2500 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0129
0.01
0.0078
 0.0383
0.0642
0.1195
0.1822
 0.0292
0.0377
0.0536
0.0688
 0.0489
0.0539
0.058
0.0596

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.01
0.0074
0.0056
 0.0514
0.0823
0.1484
0.2221
 0.0321
0.0416
0.0579
0.0731
 0.0398
0.0439
0.0474
0.0489

Runing Epoch 060 train loss 487.2002 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 061 train loss 487.1738 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 062 train loss 487.7575 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 063 train loss 487.8135 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 064 train loss 487.2573 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0078
 0.0391
0.0655
0.1192
0.1826
 0.0297
0.0384
0.0539
0.0692
 0.0492
0.0543
0.0583
0.0599

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0074
0.0057
 0.0519
0.0836
0.1499
0.2242
 0.0325
0.0421
0.0586
0.0739
 0.0403
0.0444
0.0479
0.0494

Runing Epoch 065 train loss 487.3742 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 066 train loss 487.8400 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 067 train loss 487.3681 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 068 train loss 487.8830 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 069 train loss 487.7012 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.013
0.0099
0.0077
 0.0384
0.0643
0.1179
0.1798
 0.0294
0.0379
0.0533
0.0683
 0.0492
0.0542
0.0582
0.0598

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.01
0.0073
0.0056
 0.0511
0.0827
0.1466
0.2198
 0.0321
0.0418
0.0577
0.0727
 0.0402
0.0443
0.0478
0.0493

Runing Epoch 070 train loss 487.8041 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 071 train loss 487.8289 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 072 train loss 487.5858 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 073 train loss 487.4177 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 074 train loss 487.3127 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.01
0.0078
 0.0385
0.0651
0.1193
0.1825
 0.0294
0.0381
0.0537
0.0691
 0.0495
0.0545
0.0586
0.0602

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0102
0.0075
0.0057
 0.0514
0.0841
0.1494
0.2231
 0.0322
0.0422
0.0584
0.0736
 0.04
0.0443
0.0478
0.0492

Runing Epoch 075 train loss 487.2130 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 076 train loss 487.1211 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 077 train loss 488.1583 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 078 train loss 487.3655 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 079 train loss 487.6008 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.013
0.01
0.0078
 0.0389
0.0637
0.119
0.1808
 0.0297
0.0378
0.0536
0.0687
 0.0497
0.0545
0.0586
0.0602

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0074
0.0056
 0.0517
0.083
0.1487
0.2199
 0.0323
0.0419
0.0581
0.0729
 0.0398
0.044
0.0475
0.0489

Runing Epoch 080 train loss 487.9335 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 081 train loss 488.1370 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 082 train loss 487.1085 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 083 train loss 487.2841 costs 00: 00: 10
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 65
wandb:         batch_loss_train 3.40899
wandb:         best_test MRR@10 0.0403
wandb:        best_test MRR@100 0.0494
wandb:         best_test MRR@20 0.0444
wandb:         best_test MRR@50 0.0479
wandb:        best_test NDCG@10 0.0325
wandb:       best_test NDCG@100 0.0739
wandb:        best_test NDCG@20 0.0421
wandb:        best_test NDCG@50 0.0586
wandb:   best_test Precision@10 0.0123
wandb:  best_test Precision@100 0.0057
wandb:   best_test Precision@20 0.0101
wandb:   best_test Precision@50 0.0074
wandb:      best_test Recall@10 0.0519
wandb:     best_test Recall@100 0.2242
wandb:      best_test Recall@20 0.0836
wandb:      best_test Recall@50 0.1499
wandb:        best_valid MRR@10 0.0492
wandb:       best_valid MRR@100 0.0599
wandb:        best_valid MRR@20 0.0543
wandb:        best_valid MRR@50 0.0583
wandb:       best_valid NDCG@10 0.0297
wandb:      best_valid NDCG@100 0.0692
wandb:       best_valid NDCG@20 0.0384
wandb:       best_valid NDCG@50 0.0539
wandb:  best_valid Precision@10 0.0154
wandb: best_valid Precision@100 0.0078
wandb:  best_valid Precision@20 0.0131
wandb:  best_valid Precision@50 0.01
wandb:     best_valid Recall@10 0.0391
wandb:    best_valid Recall@100 0.1826
wandb:     best_valid Recall@20 0.0655
wandb:     best_valid Recall@50 0.1192
wandb:    epoch_loss_norm_train 3.556
wandb:              test MRR@10 0.0398
wandb:             test MRR@100 0.0489
wandb:              test MRR@20 0.044
wandb:              test MRR@50 0.0475
wandb:             test NDCG@10 0.0323
wandb:            test NDCG@100 0.0729
wandb:             test NDCG@20 0.0419
wandb:             test NDCG@50 0.0581
wandb:        test Precision@10 0.0122
wandb:       test Precision@100 0.0056
wandb:        test Precision@20 0.0101
wandb:        test Precision@50 0.0074
wandb:           test Recall@10 0.0517
wandb:          test Recall@100 0.2199
wandb:           test Recall@20 0.083
wandb:           test Recall@50 0.1487
wandb:             valid MRR@10 0.0497
wandb:            valid MRR@100 0.0602
wandb:             valid MRR@20 0.0545
wandb:             valid MRR@50 0.0586
wandb:            valid NDCG@10 0.0297
wandb:           valid NDCG@100 0.0687
wandb:            valid NDCG@20 0.0378
wandb:            valid NDCG@50 0.0536
wandb:       valid Precision@10 0.0155
wandb:      valid Precision@100 0.0078
wandb:       valid Precision@20 0.013
wandb:       valid Precision@50 0.01
wandb:          valid Recall@10 0.0389
wandb:         valid Recall@100 0.1808
wandb:          valid Recall@20 0.0637
wandb:          valid Recall@50 0.119
wandb: 
wandb:  View run T-DiffRec_yelp_clean_4_Reproduction at: https://wandb.ai/drs/drs/runs/bzedti2c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_194705-bzedti2c/logs
Runing Epoch 084 train loss 487.1722 costs 00: 00: 10
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 065 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0078
 0.0391
0.0655
0.1192
0.1826
 0.0297
0.0384
0.0539
0.0692
 0.0492
0.0543
0.0583
0.0599

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0074
0.0057
 0.0519
0.0836
0.1499
0.2242
 0.0325
0.0421
0.0586
0.0739
 0.0403
0.0444
0.0479
0.0494

End time:  2023-06-23 20:11:16
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_201130-phj7qcze
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_noisy_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/phj7qcze
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 20:11:34
user num: 54574
item num: 77405
data ready.
Embedding size: 10
models ready.
Number of all parameters: 154898565
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 333.8048 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 002 train loss 269.4848 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 003 train loss 260.4544 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 004 train loss 257.3767 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0101
0.0088
0.0069
0.0056
 0.0267
0.0452
0.0833
0.1288
 0.0195
0.0253
0.036
0.0469
 0.0322
0.0359
0.039
0.0404

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0085
0.007
0.0053
0.0042
 0.0359
0.0575
0.1058
0.1609
 0.0224
0.0291
0.0411
0.0526
 0.028
0.0311
0.0338
0.0351

Runing Epoch 005 train loss 255.4109 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 006 train loss 254.3461 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 007 train loss 252.6461 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 008 train loss 251.0753 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 009 train loss 249.2113 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0119
0.0101
0.0079
0.0064
 0.0314
0.0521
0.0964
0.1494
 0.0229
0.0294
0.0418
0.0545
 0.0373
0.0415
0.0449
0.0464

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0098
0.0082
0.0062
0.0049
 0.0416
0.0678
0.123
0.1886
 0.0262
0.0342
0.048
0.0615
 0.0329
0.0364
0.0395
0.0409

Runing Epoch 010 train loss 247.7381 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 011 train loss 246.1186 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 012 train loss 245.3383 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 013 train loss 243.7722 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 014 train loss 242.9165 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0104
0.0082
0.0066
 0.032
0.0531
0.0995
0.1541
 0.0233
0.0301
0.043
0.0561
 0.0381
0.0425
0.046
0.0475

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0102
0.0085
0.0065
0.005
 0.0427
0.0695
0.1287
0.1958
 0.0268
0.035
0.0497
0.0636
 0.0337
0.0374
0.0406
0.0421

Runing Epoch 015 train loss 241.9059 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 016 train loss 241.2315 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 017 train loss 240.3362 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 018 train loss 239.9488 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 019 train loss 238.9875 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0106
0.0083
0.0067
 0.0324
0.0536
0.101
0.1565
 0.0235
0.0303
0.0435
0.0567
 0.0388
0.0431
0.0467
0.0482

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0086
0.0066
0.0051
 0.0443
0.0717
0.1312
0.1973
 0.0275
0.0359
0.0507
0.0644
 0.0341
0.0378
0.0411
0.0425

Runing Epoch 020 train loss 238.4623 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 021 train loss 238.1247 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 022 train loss 237.7705 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 023 train loss 237.3185 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 024 train loss 237.0316 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0106
0.0083
0.0067
 0.0329
0.0543
0.1011
0.1573
 0.0237
0.0305
0.0436
0.0569
 0.0385
0.0429
0.0465
0.048

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0087
0.0066
0.0051
 0.0447
0.0724
0.1316
0.1994
 0.0277
0.0362
0.0509
0.0649
 0.0342
0.038
0.0413
0.0427

Runing Epoch 025 train loss 236.6275 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 026 train loss 236.5956 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 027 train loss 235.8332 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 028 train loss 235.9035 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 029 train loss 235.9379 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0126
0.0108
0.0085
0.0068
 0.034
0.0559
0.1043
0.1602
 0.0243
0.0313
0.0447
0.0581
 0.039
0.0434
0.0471
0.0485

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0088
0.0067
0.0052
 0.0451
0.0734
0.1349
0.204
 0.0278
0.0364
0.0517
0.066
 0.0339
0.0377
0.0411
0.0425

Runing Epoch 030 train loss 235.5721 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 031 train loss 235.4969 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 032 train loss 235.3812 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 033 train loss 235.2623 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 034 train loss 235.2763 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0068
 0.0329
0.0555
0.1039
0.1613
 0.024
0.0311
0.0446
0.0582
 0.0394
0.0437
0.0474
0.0489

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0089
0.0067
0.0052
 0.0448
0.0736
0.1346
0.2043
 0.028
0.0368
0.0519
0.0662
 0.0345
0.0384
0.0417
0.0432

Runing Epoch 035 train loss 235.2545 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 036 train loss 235.0744 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 037 train loss 234.8440 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 038 train loss 234.8360 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 039 train loss 234.7760 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0107
0.0084
0.0067
 0.0329
0.0552
0.1033
0.1592
 0.0239
0.031
0.0443
0.0577
 0.0387
0.0432
0.0468
0.0483

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0087
0.0066
0.0051
 0.0444
0.0724
0.1334
0.2018
 0.0277
0.0363
0.0515
0.0656
 0.0342
0.0379
0.0413
0.0428

Runing Epoch 040 train loss 234.8159 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 041 train loss 234.8295 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 042 train loss 234.8271 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 043 train loss 234.5401 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 044 train loss 234.7649 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0127
0.0108
0.0084
0.0068
 0.0338
0.0565
0.1051
0.1628
 0.0245
0.0316
0.0451
0.0588
 0.0396
0.0439
0.0476
0.0491

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0455
0.075
0.1361
0.2063
 0.0282
0.0372
0.0524
0.0669
 0.0349
0.0388
0.0421
0.0436

Runing Epoch 045 train loss 234.6895 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 046 train loss 234.6580 costs 00: 00: 18
------------------------------------------------------
Runing Epoch 047 train loss 234.6962 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 048 train loss 234.5930 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 049 train loss 234.6797 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0106
0.0084
0.0067
 0.0334
0.0553
0.1039
0.1614
 0.0241
0.031
0.0445
0.0581
 0.0393
0.0437
0.0473
0.0488

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0088
0.0067
0.0052
 0.045
0.0732
0.1355
0.2042
 0.0279
0.0366
0.052
0.0662
 0.0343
0.0382
0.0416
0.0431

Runing Epoch 050 train loss 234.7051 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 051 train loss 234.8148 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 052 train loss 234.7322 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 053 train loss 234.4706 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 054 train loss 234.4567 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0126
0.0108
0.0085
0.0068
 0.0334
0.0563
0.106
0.1634
 0.0243
0.0315
0.0452
0.0587
 0.0398
0.0443
0.048
0.0494

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0088
0.0067
0.0052
 0.0454
0.0743
0.1359
0.206
 0.0283
0.0371
0.0523
0.0667
 0.0349
0.0388
0.0422
0.0436

Runing Epoch 055 train loss 234.2057 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 056 train loss 234.4858 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 057 train loss 234.1404 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 058 train loss 234.5325 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 059 train loss 234.5344 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0126
0.0108
0.0085
0.0068
 0.0332
0.0561
0.1057
0.1635
 0.0241
0.0313
0.045
0.0586
 0.0393
0.0437
0.0474
0.0489

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0448
0.0739
0.1364
0.2069
 0.028
0.0369
0.0523
0.0669
 0.0347
0.0386
0.042
0.0435

Runing Epoch 060 train loss 234.5699 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 061 train loss 234.3722 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 062 train loss 234.3919 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 063 train loss 234.4114 costs 00: 00: 16
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 45
wandb:         batch_loss_train 1.63661
wandb:         best_test MRR@10 0.0349
wandb:        best_test MRR@100 0.0436
wandb:         best_test MRR@20 0.0388
wandb:         best_test MRR@50 0.0421
wandb:        best_test NDCG@10 0.0282
wandb:       best_test NDCG@100 0.0669
wandb:        best_test NDCG@20 0.0372
wandb:        best_test NDCG@50 0.0524
wandb:   best_test Precision@10 0.0106
wandb:  best_test Precision@100 0.0052
wandb:   best_test Precision@20 0.0089
wandb:   best_test Precision@50 0.0067
wandb:      best_test Recall@10 0.0455
wandb:     best_test Recall@100 0.2063
wandb:      best_test Recall@20 0.075
wandb:      best_test Recall@50 0.1361
wandb:        best_valid MRR@10 0.0396
wandb:       best_valid MRR@100 0.0491
wandb:        best_valid MRR@20 0.0439
wandb:        best_valid MRR@50 0.0476
wandb:       best_valid NDCG@10 0.0245
wandb:      best_valid NDCG@100 0.0588
wandb:       best_valid NDCG@20 0.0316
wandb:       best_valid NDCG@50 0.0451
wandb:  best_valid Precision@10 0.0127
wandb: best_valid Precision@100 0.0068
wandb:  best_valid Precision@20 0.0108
wandb:  best_valid Precision@50 0.0084
wandb:     best_valid Recall@10 0.0338
wandb:    best_valid Recall@100 0.1628
wandb:     best_valid Recall@20 0.0565
wandb:     best_valid Recall@50 0.1051
wandb:    epoch_loss_norm_train 1.70916
wandb:              test MRR@10 0.0347
wandb:             test MRR@100 0.0435
wandb:              test MRR@20 0.0386
wandb:              test MRR@50 0.042
wandb:             test NDCG@10 0.028
wandb:            test NDCG@100 0.0669
wandb:             test NDCG@20 0.0369
wandb:             test NDCG@50 0.0523
wandb:        test Precision@10 0.0106
wandb:       test Precision@100 0.0052
wandb:        test Precision@20 0.0089
wandb:        test Precision@50 0.0067
wandb:           test Recall@10 0.0448
wandb:          test Recall@100 0.2069
wandb:           test Recall@20 0.0739
wandb:           test Recall@50 0.1364
wandb:             valid MRR@10 0.0393
wandb:            valid MRR@100 0.0489
wandb:             valid MRR@20 0.0437
wandb:             valid MRR@50 0.0474
wandb:            valid NDCG@10 0.0241
wandb:           valid NDCG@100 0.0586
wandb:            valid NDCG@20 0.0313
wandb:            valid NDCG@50 0.045
wandb:       valid Precision@10 0.0126
wandb:      valid Precision@100 0.0068
wandb:       valid Precision@20 0.0108
wandb:       valid Precision@50 0.0085
wandb:          valid Recall@10 0.0332
wandb:         valid Recall@100 0.1635
wandb:          valid Recall@20 0.0561
wandb:          valid Recall@50 0.1057
wandb: 
wandb:  View run T-DiffRec_yelp_noisy_4_Reproduction at: https://wandb.ai/drs/drs/runs/phj7qcze
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_201130-phj7qcze/logs
Runing Epoch 064 train loss 234.1552 costs 00: 00: 17
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 045 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0127
0.0108
0.0084
0.0068
 0.0338
0.0565
0.1051
0.1628
 0.0245
0.0316
0.0451
0.0588
 0.0396
0.0439
0.0476
0.0491

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0455
0.075
0.1361
0.2063
 0.0282
0.0372
0.0524
0.0669
 0.0349
0.0388
0.0421
0.0436

End time:  2023-06-23 20:40:48
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_204102-6qwltrht
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_clean_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/6qwltrht
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 20:41:06
user num: 5949
item num: 2810
data ready.
Embedding size: 10
models ready.
Number of all parameters: 5633970
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 6419.4701 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 5622.0533 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 5170.0004 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4768.7709 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0562
0.0517
0.0431
0.0354
 0.0388
0.0699
0.1365
0.2087
 0.0633
0.0702
0.0917
0.1187
 0.1356
0.1452
0.151
0.1526

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0428
0.0379
0.0299
0.0234
 0.0522
0.0904
0.1686
0.2471
 0.0554
0.0668
0.0937
0.1195
 0.1078
0.1168
0.1222
0.1239

Runing Epoch 005 train loss 4456.9818 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 4177.4744 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3942.9446 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3734.6250 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3553.6270 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0635
0.0578
0.0488
0.0412
 0.0487
0.0836
0.1636
0.2542
 0.0733
0.0816
0.1083
0.1424
 0.1518
0.1623
0.1684
0.1699

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0521
0.0463
0.0369
0.0292
 0.0689
0.116
0.217
0.3242
 0.0699
0.0853
0.1204
0.155
 0.1298
0.1396
0.1458
0.1475

Runing Epoch 010 train loss 3378.1849 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 3238.9228 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 3109.2011 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2991.5721 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2880.3880 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0648
0.0605
0.0511
0.0434
 0.0535
0.0951
0.1832
0.283
 0.0768
0.0883
0.1182
0.1555
 0.1572
0.169
0.1753
0.1768

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0568
0.0502
0.0409
0.0324
 0.0812
0.136
0.2564
0.3769
 0.0789
0.0972
0.139
0.1779
 0.1417
0.1524
0.1591
0.1606

Runing Epoch 015 train loss 2780.4036 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2699.1792 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2615.9807 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2541.1823 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2477.7625 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0665
0.0606
0.0519
0.0445
 0.0578
0.1005
0.1916
0.301
 0.0793
0.0909
0.1226
0.1628
 0.1591
0.1707
0.1773
0.1789

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0598
0.0526
0.0428
0.0339
 0.0901
0.1501
0.277
0.405
 0.0845
0.1047
0.1491
0.1901
 0.1478
0.1588
0.1657
0.1672

Runing Epoch 020 train loss 2414.3547 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2353.7562 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2305.3309 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2261.8121 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 2215.8549 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0663
0.0615
0.0527
0.0451
 0.0591
0.1064
0.2031
0.3146
 0.0801
0.0938
0.1271
0.168
 0.1596
0.1721
0.1787
0.1802

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0614
0.0544
0.0441
0.0347
 0.0965
0.1612
0.295
0.4281
 0.0886
0.1108
0.1573
0.1995
 0.1537
0.1654
0.1722
0.1736

Runing Epoch 025 train loss 2168.6605 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 2131.3684 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 2096.2148 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 2062.3995 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 2029.3582 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0658
0.0607
0.0525
0.045
 0.0623
0.1075
0.2067
0.3215
 0.0799
0.0932
0.1279
0.1697
 0.1554
0.1675
0.1742
0.1758

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0621
0.0556
0.045
0.0353
 0.1015
0.1698
0.3089
0.4432
 0.0911
0.115
0.163
0.2057
 0.1542
0.1663
0.173
0.1744

Runing Epoch 030 train loss 2006.0342 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1975.0823 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1947.7353 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1922.6712 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1898.7740 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0606
0.053
0.0455
 0.0626
0.1087
0.2114
0.3291
 0.0797
0.0933
0.129
0.1717
 0.1536
0.1654
0.1725
0.1741

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0628
0.0563
0.0453
0.0358
 0.1043
0.1732
0.3153
0.4527
 0.0925
0.1167
0.1655
0.2092
 0.1561
0.168
0.1749
0.1763

Runing Epoch 035 train loss 1876.0427 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1855.7678 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1837.4036 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1814.4119 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1798.9694 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0667
0.0612
0.0532
0.0454
 0.0634
0.1099
0.215
0.332
 0.0818
0.0952
0.1316
0.174
 0.159
0.1709
0.1782
0.1797

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0639
0.057
0.0459
0.0359
 0.1063
0.1767
0.3232
0.4602
 0.0954
0.1198
0.1698
0.2133
 0.1605
0.1724
0.1794
0.1808

Runing Epoch 040 train loss 1780.5626 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1764.5902 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1753.0909 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1732.8834 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1725.6980 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.066
0.0606
0.0528
0.0454
 0.0628
0.1097
0.2149
0.335
 0.0805
0.0943
0.1307
0.174
 0.1554
0.1676
0.1748
0.1764

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0631
0.0565
0.0459
0.0359
 0.1079
0.1784
0.3255
0.4661
 0.0958
0.1205
0.1711
0.2152
 0.1616
0.1736
0.1806
0.182

Runing Epoch 045 train loss 1715.3620 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1692.4777 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1681.7782 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1671.7555 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1657.3652 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0657
0.061
0.0531
0.0453
 0.0632
0.11
0.2179
0.3369
 0.0803
0.0946
0.1318
0.1747
 0.1551
0.1674
0.1748
0.1763

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0637
0.0573
0.0459
0.0361
 0.11
0.1828
0.3283
0.4704
 0.0967
0.1225
0.1723
0.217
 0.1616
0.1736
0.1806
0.182

Runing Epoch 050 train loss 1642.6048 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1630.5752 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1621.2506 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1616.9614 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1595.6746 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0657
0.0609
0.0526
0.0453
 0.0638
0.1127
0.218
0.338
 0.0796
0.0945
0.1311
0.1743
 0.1526
0.1651
0.1723
0.1738

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0636
0.0572
0.0461
0.0362
 0.1111
0.185
0.3291
0.471
 0.0967
0.1228
0.1728
0.2174
 0.1601
0.1725
0.1793
0.1808

Runing Epoch 055 train loss 1591.4430 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1587.4584 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1575.6674 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1563.1808 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1554.8672 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0659
0.0606
0.0529
0.0452
 0.0642
0.111
0.2186
0.3386
 0.0806
0.0947
0.1321
0.1752
 0.1555
0.1672
0.1747
0.1763

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0638
0.0574
0.0463
0.0363
 0.1107
0.1849
0.3324
0.4762
 0.0977
0.1239
0.1746
0.2197
 0.1628
0.1753
0.182
0.1835

Runing Epoch 060 train loss 1549.9798 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1539.5812 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1534.4623 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1523.0872 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1516.6891 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0652
0.0607
0.053
0.0453
 0.0646
0.1121
0.2208
0.3389
 0.0798
0.0946
0.1323
0.175
 0.1535
0.1655
0.1731
0.1746

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0638
0.0574
0.0463
0.0363
 0.1114
0.1868
0.3339
0.477
 0.0975
0.124
0.1747
0.2196
 0.1619
0.1743
0.1813
0.1827

Runing Epoch 065 train loss 1505.1393 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1502.2190 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1491.2482 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1486.1096 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 069 train loss 1481.8903 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0644
0.0605
0.0527
0.0453
 0.0636
0.1122
0.2204
0.3424
 0.0796
0.0947
0.1322
0.1759
 0.1551
0.1675
0.175
0.1765

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0641
0.0574
0.0464
0.0362
 0.1125
0.1869
0.3372
0.4766
 0.0986
0.1248
0.1763
0.2203
 0.1629
0.1754
0.1822
0.1836

Runing Epoch 070 train loss 1475.8785 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1471.7327 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 072 train loss 1460.4457 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 073 train loss 1458.2344 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 55
wandb:         batch_loss_train 95.29674
wandb:         best_test MRR@10 0.1601
wandb:        best_test MRR@100 0.1808
wandb:         best_test MRR@20 0.1725
wandb:         best_test MRR@50 0.1793
wandb:        best_test NDCG@10 0.0967
wandb:       best_test NDCG@100 0.2174
wandb:        best_test NDCG@20 0.1228
wandb:        best_test NDCG@50 0.1728
wandb:   best_test Precision@10 0.0636
wandb:  best_test Precision@100 0.0362
wandb:   best_test Precision@20 0.0572
wandb:   best_test Precision@50 0.0461
wandb:      best_test Recall@10 0.1111
wandb:     best_test Recall@100 0.471
wandb:      best_test Recall@20 0.185
wandb:      best_test Recall@50 0.3291
wandb:        best_valid MRR@10 0.1526
wandb:       best_valid MRR@100 0.1738
wandb:        best_valid MRR@20 0.1651
wandb:        best_valid MRR@50 0.1723
wandb:       best_valid NDCG@10 0.0796
wandb:      best_valid NDCG@100 0.1743
wandb:       best_valid NDCG@20 0.0945
wandb:       best_valid NDCG@50 0.1311
wandb:  best_valid Precision@10 0.0657
wandb: best_valid Precision@100 0.0453
wandb:  best_valid Precision@20 0.0609
wandb:  best_valid Precision@50 0.0526
wandb:     best_valid Recall@10 0.0638
wandb:    best_valid Recall@100 0.338
wandb:     best_valid Recall@20 0.1127
wandb:     best_valid Recall@50 0.218
wandb:    epoch_loss_norm_train 96.64349
wandb:              test MRR@10 0.1629
wandb:             test MRR@100 0.1836
wandb:              test MRR@20 0.1754
wandb:              test MRR@50 0.1822
wandb:             test NDCG@10 0.0986
wandb:            test NDCG@100 0.2203
wandb:             test NDCG@20 0.1248
wandb:             test NDCG@50 0.1763
wandb:        test Precision@10 0.0641
wandb:       test Precision@100 0.0362
wandb:        test Precision@20 0.0574
wandb:        test Precision@50 0.0464
wandb:           test Recall@10 0.1125
wandb:          test Recall@100 0.4766
wandb:           test Recall@20 0.1869
wandb:           test Recall@50 0.3372
wandb:             valid MRR@10 0.1551
wandb:            valid MRR@100 0.1765
wandb:             valid MRR@20 0.1675
wandb:             valid MRR@50 0.175
wandb:            valid NDCG@10 0.0796
wandb:           valid NDCG@100 0.1759
wandb:            valid NDCG@20 0.0947
wandb:            valid NDCG@50 0.1322
wandb:       valid Precision@10 0.0644
wandb:      valid Precision@100 0.0453
wandb:       valid Precision@20 0.0605
wandb:       valid Precision@50 0.0527
wandb:          valid Recall@10 0.0636
wandb:         valid Recall@100 0.3424
wandb:          valid Recall@20 0.1122
wandb:          valid Recall@50 0.2204
wandb: 
wandb:  View run T-DiffRec_ml-1m_clean_4_Reproduction at: https://wandb.ai/drs/drs/runs/6qwltrht
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_204102-6qwltrht/logs
Runing Epoch 074 train loss 1449.6524 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 055 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0657
0.0609
0.0526
0.0453
 0.0638
0.1127
0.218
0.338
 0.0796
0.0945
0.1311
0.1743
 0.1526
0.1651
0.1723
0.1738

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0636
0.0572
0.0461
0.0362
 0.1111
0.185
0.3291
0.471
 0.0967
0.1228
0.1728
0.2174
 0.1601
0.1725
0.1793
0.1808

End time:  2023-06-23 20:42:52
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_204306-m5paf0w0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_noisy_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/m5paf0w0
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 20:43:09
user num: 5949
item num: 3494
data ready.
Embedding size: 10
models ready.
Number of all parameters: 7002654
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 5186.0645 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 4630.0225 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 4272.7350 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 3965.3287 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0349
0.0341
0.0312
0.0278
 0.0279
0.0517
0.1041
0.1674
 0.0413
0.0484
0.066
0.0881
 0.0941
0.1046
0.1111
0.1129

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.031
0.0287
0.0246
0.02
 0.0426
0.0739
0.1488
0.2268
 0.0416
0.0526
0.0787
0.1037
 0.0832
0.0917
0.0984
0.1002

Runing Epoch 005 train loss 3732.8107 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 3524.1662 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3329.9411 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3162.4714 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3025.9118 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0351
0.0351
0.0334
0.0309
 0.0326
0.0598
0.1229
0.2021
 0.0421
0.0512
0.0735
0.1016
 0.0922
0.1038
0.1109
0.1128

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0339
0.0315
0.0279
0.0237
 0.0542
0.0923
0.1847
0.2844
 0.0466
0.0608
0.0934
0.1254
 0.0844
0.0946
0.1019
0.1038

Runing Epoch 010 train loss 2889.4274 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 2772.8769 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 2674.6475 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2577.7740 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2487.3484 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0335
0.0344
0.034
0.0324
 0.0344
0.0644
0.1389
0.2303
 0.0403
0.0513
0.078
0.1103
 0.0843
0.0965
0.1046
0.1066

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0347
0.0332
0.0304
0.026
 0.0621
0.1072
0.2173
0.3323
 0.0502
0.0677
0.1063
0.1428
 0.0873
0.0982
0.1063
0.1082

Runing Epoch 015 train loss 2420.9748 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2345.0368 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2292.0700 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2230.4995 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2177.0555 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0328
0.0336
0.0341
0.0328
 0.0354
0.0675
0.1503
0.2489
 0.0398
0.0513
0.0807
0.1151
 0.0816
0.0938
0.1024
0.1044

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0348
0.0339
0.0313
0.0271
 0.0648
0.1148
0.2341
0.3626
 0.0519
0.0712
0.1126
0.1526
 0.0886
0.1001
0.1086
0.1106

Runing Epoch 020 train loss 2115.8953 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2069.9984 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2037.2236 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 1996.7900 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 1959.2879 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0322
0.0339
0.0341
0.0331
 0.0365
0.0703
0.1567
0.2601
 0.0394
0.052
0.0824
0.1183
 0.079
0.0917
0.1005
0.1025

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0351
0.0344
0.0319
0.0275
 0.0673
0.1217
0.249
0.3787
 0.0526
0.0733
0.1169
0.1575
 0.088
0.1
0.1086
0.1105

Runing Epoch 025 train loss 1926.0748 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 1889.5830 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 1864.9272 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 1838.1288 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 1818.0738 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0309
0.0332
0.0344
0.033
 0.0367
0.071
0.1606
0.2635
 0.039
0.0519
0.0837
0.1195
 0.0792
0.0919
0.1009
0.103

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0349
0.032
0.0277
 0.0707
0.1259
0.2535
0.3902
 0.0549
0.0757
0.1194
0.1614
 0.0901
0.1013
0.1099
0.112

Runing Epoch 030 train loss 1790.2215 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1763.0469 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1741.3072 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1722.1723 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1700.4212 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0312
0.0331
0.034
0.0328
 0.037
0.0736
0.1639
0.2688
 0.039
0.0525
0.0843
0.1205
 0.0789
0.0915
0.1006
0.1027

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0354
0.0349
0.0322
0.0278
 0.0715
0.1308
0.2623
0.3995
 0.0543
0.0766
0.1214
0.1635
 0.0868
0.0993
0.1079
0.1099

Runing Epoch 035 train loss 1680.5896 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1663.7210 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1650.9411 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1629.3240 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1613.7335 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0313
0.0326
0.0337
0.0326
 0.0376
0.0737
0.1641
0.2711
 0.0392
0.0522
0.0841
0.1207
 0.0782
0.0905
0.0995
0.1017

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0363
0.0345
0.0324
0.0278
 0.073
0.1312
0.2653
0.4039
 0.0551
0.0767
0.1225
0.1648
 0.0868
0.0984
0.1072
0.1092

Runing Epoch 040 train loss 1601.2611 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1585.2011 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1574.9330 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1557.8957 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1544.0411 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0316
0.0332
0.0338
0.0326
 0.0388
0.0757
0.1665
0.2739
 0.0396
0.053
0.0848
0.1215
 0.0779
0.0906
0.0996
0.1017

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0364
0.035
0.0325
0.0279
 0.0734
0.1335
0.2683
0.4083
 0.0555
0.0777
0.1236
0.1663
 0.0883
0.1005
0.1093
0.1113

Runing Epoch 045 train loss 1534.3372 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1522.8905 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1505.5644 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1498.0529 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1489.1303 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0315
0.0331
0.0337
0.0321
 0.0388
0.0756
0.168
0.2728
 0.0393
0.0528
0.0849
0.1206
 0.0766
0.0894
0.0983
0.1004

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0365
0.0354
0.0325
0.0276
 0.0757
0.1366
0.2719
0.408
 0.0565
0.0792
0.125
0.1667
 0.089
0.101
0.1096
0.1116

Runing Epoch 050 train loss 1479.2648 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1463.8817 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1456.5450 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1448.9981 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1440.5686 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0314
0.0329
0.0338
0.0326
 0.0386
0.0753
0.1688
0.2764
 0.0393
0.0527
0.0853
0.122
 0.0774
0.09
0.099
0.1012

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0365
0.0354
0.0324
0.0278
 0.0752
0.1358
0.273
0.4117
 0.0562
0.0788
0.1251
0.1675
 0.0893
0.1011
0.1099
0.1119

Runing Epoch 055 train loss 1425.5332 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1419.8704 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1411.0218 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1400.0720 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1395.6496 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0312
0.0327
0.0334
0.0322
 0.0384
0.0755
0.1675
0.2754
 0.039
0.0525
0.0846
0.1213
 0.0768
0.0892
0.0982
0.1004

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0368
0.0354
0.0323
0.0278
 0.0757
0.1368
0.2722
0.4134
 0.0563
0.079
0.1248
0.1677
 0.0882
0.1
0.1089
0.1109

Runing Epoch 060 train loss 1388.7648 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1380.1310 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1371.8893 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1366.3632 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 45
wandb:         batch_loss_train 92.33835
wandb:         best_test MRR@10 0.0883
wandb:        best_test MRR@100 0.1113
wandb:         best_test MRR@20 0.1005
wandb:         best_test MRR@50 0.1093
wandb:        best_test NDCG@10 0.0555
wandb:       best_test NDCG@100 0.1663
wandb:        best_test NDCG@20 0.0777
wandb:        best_test NDCG@50 0.1236
wandb:   best_test Precision@10 0.0364
wandb:  best_test Precision@100 0.0279
wandb:   best_test Precision@20 0.035
wandb:   best_test Precision@50 0.0325
wandb:      best_test Recall@10 0.0734
wandb:     best_test Recall@100 0.4083
wandb:      best_test Recall@20 0.1335
wandb:      best_test Recall@50 0.2683
wandb:        best_valid MRR@10 0.0779
wandb:       best_valid MRR@100 0.1017
wandb:        best_valid MRR@20 0.0906
wandb:        best_valid MRR@50 0.0996
wandb:       best_valid NDCG@10 0.0396
wandb:      best_valid NDCG@100 0.1215
wandb:       best_valid NDCG@20 0.053
wandb:       best_valid NDCG@50 0.0848
wandb:  best_valid Precision@10 0.0316
wandb: best_valid Precision@100 0.0326
wandb:  best_valid Precision@20 0.0332
wandb:  best_valid Precision@50 0.0338
wandb:     best_valid Recall@10 0.0388
wandb:    best_valid Recall@100 0.2739
wandb:     best_valid Recall@20 0.0757
wandb:     best_valid Recall@50 0.1665
wandb:    epoch_loss_norm_train 90.61178
wandb:              test MRR@10 0.0882
wandb:             test MRR@100 0.1109
wandb:              test MRR@20 0.1
wandb:              test MRR@50 0.1089
wandb:             test NDCG@10 0.0563
wandb:            test NDCG@100 0.1677
wandb:             test NDCG@20 0.079
wandb:             test NDCG@50 0.1248
wandb:        test Precision@10 0.0368
wandb:       test Precision@100 0.0278
wandb:        test Precision@20 0.0354
wandb:        test Precision@50 0.0323
wandb:           test Recall@10 0.0757
wandb:          test Recall@100 0.4134
wandb:           test Recall@20 0.1368
wandb:           test Recall@50 0.2722
wandb:             valid MRR@10 0.0768
wandb:            valid MRR@100 0.1004
wandb:             valid MRR@20 0.0892
wandb:             valid MRR@50 0.0982
wandb:            valid NDCG@10 0.039
wandb:           valid NDCG@100 0.1213
wandb:            valid NDCG@20 0.0525
wandb:            valid NDCG@50 0.0846
wandb:       valid Precision@10 0.0312
wandb:      valid Precision@100 0.0322
wandb:       valid Precision@20 0.0327
wandb:       valid Precision@50 0.0334
wandb:          valid Recall@10 0.0384
wandb:         valid Recall@100 0.2754
wandb:          valid Recall@20 0.0755
wandb:          valid Recall@50 0.1675
wandb: 
wandb:  View run T-DiffRec_ml-1m_noisy_4_Reproduction at: https://wandb.ai/drs/drs/runs/m5paf0w0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_204306-m5paf0w0/logs
Runing Epoch 064 train loss 1359.1767 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 045 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0316
0.0332
0.0338
0.0326
 0.0388
0.0757
0.1665
0.2739
 0.0396
0.053
0.0848
0.1215
 0.0779
0.0906
0.0996
0.1017

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0364
0.035
0.0325
0.0279
 0.0734
0.1335
0.2683
0.4083
 0.0555
0.0777
0.1236
0.1663
 0.0883
0.1005
0.1093
0.1113

End time:  2023-06-23 20:44:43
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_204455-v67qkouc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_clean_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/v67qkouc
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 20:44:59
user num: 54574
item num: 34395
data ready.
Embedding size: 10
models ready.
Number of all parameters: 68835555
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 783.4835 costs 00: 00: 12
------------------------------------------------------
Runing Epoch 002 train loss 603.0815 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 003 train loss 560.7754 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 004 train loss 545.6821 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0106
0.0082
0.0064
 0.0308
0.0511
0.0961
0.1469
 0.0239
0.0305
0.0434
0.0558
 0.0405
0.0447
0.0483
0.0497

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0091
0.0076
0.0058
0.0045
 0.038
0.0625
0.1155
0.1749
 0.0241
0.0315
0.0447
0.057
 0.0305
0.0338
0.0368
0.0381

Runing Epoch 005 train loss 539.6128 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 006 train loss 533.6456 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 007 train loss 530.0530 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 008 train loss 526.0855 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 009 train loss 522.3834 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0147
0.0123
0.0095
0.0074
 0.0366
0.0603
0.1125
0.1713
 0.0281
0.0358
0.0508
0.0651
 0.0469
0.0516
0.0555
0.057

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0094
0.007
0.0053
 0.0466
0.0768
0.14
0.2082
 0.0295
0.0386
0.0543
0.0684
 0.037
0.041
0.0444
0.0458

Runing Epoch 010 train loss 518.2457 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 011 train loss 515.4553 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 012 train loss 512.5853 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 013 train loss 509.8580 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 014 train loss 507.4513 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0128
0.0098
0.0077
 0.0379
0.0627
0.1162
0.1768
 0.0294
0.0374
0.0529
0.0677
 0.0494
0.0543
0.0583
0.0598

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0119
0.0098
0.0073
0.0055
 0.0502
0.0809
0.1452
0.2144
 0.0314
0.0407
0.0567
0.0711
 0.0388
0.0429
0.0463
0.0477

Runing Epoch 015 train loss 505.8867 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 016 train loss 503.7116 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 017 train loss 502.2502 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 018 train loss 500.0592 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 019 train loss 499.0154 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.013
0.0099
0.0078
 0.0388
0.0644
0.1182
0.1803
 0.0298
0.0382
0.0537
0.0688
 0.0497
0.0546
0.0586
0.0602

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.012
0.01
0.0074
0.0056
 0.0509
0.083
0.148
0.2202
 0.0321
0.0418
0.058
0.0729
 0.04
0.0442
0.0476
0.0491

Runing Epoch 020 train loss 497.9784 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 021 train loss 496.6854 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 022 train loss 496.1463 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 023 train loss 494.3825 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 024 train loss 493.8351 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.0099
0.0078
 0.0389
0.0644
0.1185
0.1811
 0.0297
0.038
0.0536
0.0689
 0.0496
0.0546
0.0586
0.0602

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.01
0.0074
0.0057
 0.0516
0.0827
0.1488
0.2218
 0.0324
0.0419
0.0584
0.0735
 0.0405
0.0446
0.0481
0.0496

Runing Epoch 025 train loss 493.1973 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 026 train loss 493.1527 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 027 train loss 492.0309 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 028 train loss 491.8210 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 029 train loss 491.4065 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0129
0.0099
0.0078
 0.0385
0.064
0.1181
0.1806
 0.0294
0.0377
0.0533
0.0685
 0.0495
0.0545
0.0585
0.0601

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0074
0.0056
 0.0515
0.0833
0.1475
0.2202
 0.0323
0.042
0.058
0.073
 0.0401
0.0444
0.0478
0.0493

Runing Epoch 030 train loss 490.8022 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 031 train loss 490.2449 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 032 train loss 490.1643 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 033 train loss 490.2670 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 034 train loss 490.0343 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.0131
0.01
0.0079
 0.0389
0.0653
0.1199
0.1831
 0.0296
0.0382
0.0539
0.0693
 0.0494
0.0544
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0075
0.0057
 0.0516
0.084
0.1502
0.2239
 0.0328
0.0426
0.059
0.0742
 0.0409
0.0452
0.0487
0.0502

Runing Epoch 035 train loss 489.8852 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 036 train loss 489.3172 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 037 train loss 489.3170 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 038 train loss 488.9498 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 039 train loss 489.1764 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.0099
0.0078
 0.0391
0.0648
0.1185
0.181
 0.0298
0.0382
0.0537
0.0689
 0.0494
0.0544
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0101
0.0074
0.0057
 0.051
0.0839
0.1494
0.2223
 0.0324
0.0423
0.0586
0.0736
 0.0403
0.0446
0.048
0.0495

Runing Epoch 040 train loss 488.4138 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 041 train loss 488.6485 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 042 train loss 488.8732 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 043 train loss 488.6000 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 044 train loss 488.5666 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0156
0.0131
0.01
0.0079
 0.0401
0.0655
0.1206
0.1846
 0.0302
0.0386
0.0544
0.0699
 0.0498
0.0547
0.0588
0.0604

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0075
0.0057
 0.0525
0.0839
0.15
0.2253
 0.0326
0.0422
0.0586
0.0741
 0.0402
0.0443
0.0478
0.0494

Runing Epoch 045 train loss 488.2325 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 046 train loss 488.1147 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 047 train loss 488.3019 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 048 train loss 488.3213 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 049 train loss 488.2274 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.0132
0.0101
0.0079
 0.0396
0.0659
0.1211
0.1839
 0.0301
0.0388
0.0547
0.0699
 0.0501
0.0552
0.0593
0.0609

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0102
0.0075
0.0057
 0.0528
0.0851
0.1514
0.2258
 0.0332
0.0431
0.0595
0.0748
 0.0411
0.0453
0.0488
0.0503

Runing Epoch 050 train loss 488.6194 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 051 train loss 488.0234 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 052 train loss 488.0246 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 053 train loss 487.9930 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 054 train loss 487.5893 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0154
0.013
0.01
0.0078
 0.0395
0.0652
0.1205
0.1839
 0.0298
0.0383
0.0541
0.0695
 0.0493
0.0543
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0101
0.0074
0.0057
 0.0522
0.0839
0.1498
0.2242
 0.0328
0.0425
0.0588
0.0741
 0.0406
0.0449
0.0483
0.0498

Runing Epoch 055 train loss 487.6249 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 056 train loss 488.0345 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 057 train loss 487.5423 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 058 train loss 487.6908 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 059 train loss 487.8751 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.013
0.01
0.0078
 0.0396
0.0653
0.1211
0.1839
 0.03
0.0385
0.0545
0.0697
 0.0498
0.0548
0.0589
0.0605

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0101
0.0075
0.0057
 0.0519
0.0843
0.1506
0.225
 0.0326
0.0424
0.0589
0.0742
 0.0403
0.0445
0.0481
0.0495

Runing Epoch 060 train loss 487.6430 costs 00: 00: 44
------------------------------------------------------
Runing Epoch 061 train loss 487.9170 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 062 train loss 487.7574 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 063 train loss 487.6937 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 064 train loss 487.6186 costs 00: 00: 10
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0153
0.0131
0.01
0.0078
 0.0389
0.0654
0.1212
0.1849
 0.0296
0.0384
0.0543
0.0697
 0.0492
0.0544
0.0584
0.06

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0102
0.0075
0.0057
 0.0517
0.0842
0.1511
0.2265
 0.0324
0.0423
0.0589
0.0744
 0.04
0.0443
0.0478
0.0494

Runing Epoch 065 train loss 487.5720 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 066 train loss 487.7155 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 067 train loss 487.7333 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 068 train loss 487.7594 costs 00: 00: 10
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 50
wandb:         batch_loss_train 3.72036
wandb:         best_test MRR@10 0.0411
wandb:        best_test MRR@100 0.0503
wandb:         best_test MRR@20 0.0453
wandb:         best_test MRR@50 0.0488
wandb:        best_test NDCG@10 0.0332
wandb:       best_test NDCG@100 0.0748
wandb:        best_test NDCG@20 0.0431
wandb:        best_test NDCG@50 0.0595
wandb:   best_test Precision@10 0.0125
wandb:  best_test Precision@100 0.0057
wandb:   best_test Precision@20 0.0102
wandb:   best_test Precision@50 0.0075
wandb:      best_test Recall@10 0.0528
wandb:     best_test Recall@100 0.2258
wandb:      best_test Recall@20 0.0851
wandb:      best_test Recall@50 0.1514
wandb:        best_valid MRR@10 0.0501
wandb:       best_valid MRR@100 0.0609
wandb:        best_valid MRR@20 0.0552
wandb:        best_valid MRR@50 0.0593
wandb:       best_valid NDCG@10 0.0301
wandb:      best_valid NDCG@100 0.0699
wandb:       best_valid NDCG@20 0.0388
wandb:       best_valid NDCG@50 0.0547
wandb:  best_valid Precision@10 0.0155
wandb: best_valid Precision@100 0.0079
wandb:  best_valid Precision@20 0.0132
wandb:  best_valid Precision@50 0.0101
wandb:     best_valid Recall@10 0.0396
wandb:    best_valid Recall@100 0.1839
wandb:     best_valid Recall@20 0.0659
wandb:     best_valid Recall@50 0.1211
wandb:    epoch_loss_norm_train 3.56119
wandb:              test MRR@10 0.04
wandb:             test MRR@100 0.0494
wandb:              test MRR@20 0.0443
wandb:              test MRR@50 0.0478
wandb:             test NDCG@10 0.0324
wandb:            test NDCG@100 0.0744
wandb:             test NDCG@20 0.0423
wandb:             test NDCG@50 0.0589
wandb:        test Precision@10 0.0122
wandb:       test Precision@100 0.0057
wandb:        test Precision@20 0.0102
wandb:        test Precision@50 0.0075
wandb:           test Recall@10 0.0517
wandb:          test Recall@100 0.2265
wandb:           test Recall@20 0.0842
wandb:           test Recall@50 0.1511
wandb:             valid MRR@10 0.0492
wandb:            valid MRR@100 0.06
wandb:             valid MRR@20 0.0544
wandb:             valid MRR@50 0.0584
wandb:            valid NDCG@10 0.0296
wandb:           valid NDCG@100 0.0697
wandb:            valid NDCG@20 0.0384
wandb:            valid NDCG@50 0.0543
wandb:       valid Precision@10 0.0153
wandb:      valid Precision@100 0.0078
wandb:       valid Precision@20 0.0131
wandb:       valid Precision@50 0.01
wandb:          valid Recall@10 0.0389
wandb:         valid Recall@100 0.1849
wandb:          valid Recall@20 0.0654
wandb:          valid Recall@50 0.1212
wandb: 
wandb:  View run T-DiffRec_yelp_clean_5_Reproduction at: https://wandb.ai/drs/drs/runs/v67qkouc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_204455-v67qkouc/logs
Runing Epoch 069 train loss 487.8827 costs 00: 00: 10
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 050 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0155
0.0132
0.0101
0.0079
 0.0396
0.0659
0.1211
0.1839
 0.0301
0.0388
0.0547
0.0699
 0.0501
0.0552
0.0593
0.0609

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0102
0.0075
0.0057
 0.0528
0.0851
0.1514
0.2258
 0.0332
0.0431
0.0595
0.0748
 0.0411
0.0453
0.0488
0.0503

End time:  2023-06-23 21:04:46
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_210459-ny4s8hj5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_yelp_noisy_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/ny4s8hj5
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 21:05:02
user num: 54574
item num: 77405
data ready.
Embedding size: 10
models ready.
Number of all parameters: 154898565
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 332.5170 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 002 train loss 268.9281 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 003 train loss 260.4401 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 004 train loss 257.4645 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0102
0.0088
0.007
0.0057
 0.0271
0.0449
0.0857
0.1346
 0.0194
0.025
0.0364
0.048
 0.0317
0.0355
0.0387
0.0401

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0085
0.0071
0.0054
0.0043
 0.0357
0.0581
0.1072
0.1669
 0.022
0.0288
0.041
0.0533
 0.0276
0.0308
0.0336
0.0349

Runing Epoch 005 train loss 255.8290 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 006 train loss 254.0843 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 007 train loss 252.3841 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 008 train loss 250.8802 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 009 train loss 248.9588 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0117
0.01
0.0079
0.0064
 0.03
0.0504
0.0958
0.1497
 0.022
0.0285
0.0411
0.054
 0.0363
0.0405
0.0439
0.0454

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0096
0.0081
0.0062
0.0048
 0.0398
0.0662
0.1227
0.1878
 0.0247
0.0328
0.0469
0.0603
 0.0312
0.0348
0.0379
0.0393

Runing Epoch 010 train loss 247.6015 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 011 train loss 246.3554 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 012 train loss 245.2318 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 013 train loss 244.2644 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 014 train loss 242.8370 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0105
0.0082
0.0066
 0.0321
0.0533
0.1007
0.1544
 0.0232
0.0299
0.0431
0.056
 0.0377
0.042
0.0456
0.0471

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0086
0.0065
0.005
 0.043
0.0703
0.1291
0.1955
 0.0267
0.035
0.0497
0.0634
 0.0333
0.0371
0.0403
0.0417

Runing Epoch 015 train loss 242.1012 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 016 train loss 241.2059 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 017 train loss 240.3928 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 018 train loss 239.8678 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 019 train loss 239.1403 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0106
0.0083
0.0067
 0.0328
0.0542
0.1021
0.1572
 0.0236
0.0304
0.0438
0.0569
 0.0381
0.0425
0.0461
0.0475

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0087
0.0066
0.0051
 0.0442
0.0718
0.131
0.1987
 0.0271
0.0356
0.0503
0.0643
 0.0337
0.0374
0.0407
0.0421

Runing Epoch 020 train loss 238.8479 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 021 train loss 238.1181 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 022 train loss 237.6632 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 023 train loss 237.2619 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 024 train loss 237.0107 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0067
 0.0329
0.0552
0.1031
0.159
 0.0237
0.0308
0.0441
0.0574
 0.0387
0.0432
0.0467
0.0482

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0087
0.0066
0.0051
 0.044
0.072
0.1323
0.2001
 0.0272
0.0358
0.0508
0.0648
 0.0336
0.0375
0.0408
0.0423

Runing Epoch 025 train loss 237.0190 costs 00: 01: 14
------------------------------------------------------
Runing Epoch 026 train loss 236.3791 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 027 train loss 236.3849 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 028 train loss 236.2946 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 029 train loss 235.7014 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0126
0.0108
0.0084
0.0067
 0.0332
0.0554
0.1043
0.1608
 0.024
0.031
0.0445
0.0579
 0.0391
0.0435
0.0472
0.0486

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0088
0.0067
0.0052
 0.0447
0.0734
0.1347
0.203
 0.0278
0.0366
0.0518
0.0659
 0.0346
0.0384
0.0418
0.0432

Runing Epoch 030 train loss 235.5067 costs 00: 01: 13
------------------------------------------------------
Runing Epoch 031 train loss 235.2666 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 032 train loss 235.4910 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 033 train loss 235.5149 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 034 train loss 235.2584 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0108
0.0085
0.0068
 0.0332
0.0559
0.1053
0.1628
 0.024
0.0312
0.0449
0.0585
 0.039
0.0435
0.0472
0.0487

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0106
0.0089
0.0067
0.0052
 0.0451
0.0736
0.1359
0.2047
 0.0279
0.0366
0.052
0.0662
 0.0342
0.0381
0.0414
0.0429

Runing Epoch 035 train loss 235.1904 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 036 train loss 235.0616 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 037 train loss 235.0271 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 038 train loss 235.0048 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 039 train loss 234.8796 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0106
0.0083
0.0067
 0.0326
0.0557
0.1044
0.1607
 0.0234
0.0307
0.0442
0.0576
 0.038
0.0425
0.0462
0.0477

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0088
0.0066
0.0051
 0.0443
0.0739
0.1346
0.2046
 0.0274
0.0365
0.0515
0.0659
 0.0339
0.0379
0.0413
0.0427

Runing Epoch 040 train loss 234.7539 costs 00: 01: 11
------------------------------------------------------
Runing Epoch 041 train loss 234.7826 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 042 train loss 234.9446 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 043 train loss 234.7660 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 044 train loss 234.9315 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0107
0.0084
0.0067
 0.0331
0.0557
0.1046
0.1603
 0.0242
0.0313
0.0448
0.0581
 0.0394
0.0439
0.0475
0.049

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0089
0.0066
0.0051
 0.0444
0.0741
0.1337
0.2039
 0.0277
0.0368
0.0516
0.0659
 0.0342
0.0381
0.0414
0.0429

Runing Epoch 045 train loss 234.6173 costs 00: 01: 09
------------------------------------------------------
Runing Epoch 046 train loss 234.7828 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 047 train loss 234.6250 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 048 train loss 234.8033 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 049 train loss 234.5605 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0067
 0.0337
0.0565
0.1061
0.1621
 0.0244
0.0316
0.0453
0.0586
 0.0395
0.044
0.0477
0.0492

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0089
0.0066
0.0051
 0.0455
0.0745
0.1351
0.2047
 0.0282
0.0371
0.0521
0.0664
 0.035
0.0388
0.0421
0.0436

Runing Epoch 050 train loss 234.4327 costs 00: 01: 14
------------------------------------------------------
Runing Epoch 051 train loss 234.5882 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 052 train loss 234.7274 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 053 train loss 234.4851 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 054 train loss 234.5441 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0107
0.0083
0.0067
 0.0327
0.0556
0.1035
0.1591
 0.0238
0.031
0.0443
0.0575
 0.039
0.0435
0.0471
0.0486

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0088
0.0066
0.0051
 0.045
0.0732
0.1329
0.2018
 0.0276
0.0363
0.0511
0.0654
 0.0338
0.0377
0.0409
0.0424

Runing Epoch 055 train loss 234.5820 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 056 train loss 234.4054 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 057 train loss 234.5002 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 058 train loss 234.6432 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 059 train loss 234.5578 costs 00: 00: 17
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0127
0.0108
0.0084
0.0068
 0.0337
0.0561
0.1049
0.1622
 0.0245
0.0315
0.045
0.0586
 0.0399
0.0443
0.0479
0.0494

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.009
0.0067
0.0052
 0.0454
0.0754
0.1351
0.2055
 0.0281
0.0372
0.0521
0.0665
 0.0347
0.0387
0.042
0.0434

Runing Epoch 060 train loss 234.5252 costs 00: 01: 10
------------------------------------------------------
Runing Epoch 061 train loss 234.4770 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 062 train loss 234.7325 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 063 train loss 234.4796 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 064 train loss 234.3387 costs 00: 00: 16
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0068
 0.0333
0.0558
0.1038
0.1613
 0.0241
0.0312
0.0446
0.0582
 0.0394
0.0438
0.0475
0.049

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0105
0.0089
0.0067
0.0051
 0.0444
0.0741
0.1347
0.2032
 0.0274
0.0364
0.0515
0.0656
 0.0337
0.0376
0.041
0.0424

Runing Epoch 065 train loss 234.6839 costs 00: 01: 12
------------------------------------------------------
Runing Epoch 066 train loss 234.4747 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 067 train loss 234.2427 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 068 train loss 234.3839 costs 00: 00: 16
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 50
wandb:         batch_loss_train 1.75985
wandb:         best_test MRR@10 0.035
wandb:        best_test MRR@100 0.0436
wandb:         best_test MRR@20 0.0388
wandb:         best_test MRR@50 0.0421
wandb:        best_test NDCG@10 0.0282
wandb:       best_test NDCG@100 0.0664
wandb:        best_test NDCG@20 0.0371
wandb:        best_test NDCG@50 0.0521
wandb:   best_test Precision@10 0.0107
wandb:  best_test Precision@100 0.0051
wandb:   best_test Precision@20 0.0089
wandb:   best_test Precision@50 0.0066
wandb:      best_test Recall@10 0.0455
wandb:     best_test Recall@100 0.2047
wandb:      best_test Recall@20 0.0745
wandb:      best_test Recall@50 0.1351
wandb:        best_valid MRR@10 0.0395
wandb:       best_valid MRR@100 0.0492
wandb:        best_valid MRR@20 0.044
wandb:        best_valid MRR@50 0.0477
wandb:       best_valid NDCG@10 0.0244
wandb:      best_valid NDCG@100 0.0586
wandb:       best_valid NDCG@20 0.0316
wandb:       best_valid NDCG@50 0.0453
wandb:  best_valid Precision@10 0.0125
wandb: best_valid Precision@100 0.0067
wandb:  best_valid Precision@20 0.0107
wandb:  best_valid Precision@50 0.0084
wandb:     best_valid Recall@10 0.0337
wandb:    best_valid Recall@100 0.1621
wandb:     best_valid Recall@20 0.0565
wandb:     best_valid Recall@50 0.1061
wandb:    epoch_loss_norm_train 1.71225
wandb:              test MRR@10 0.0337
wandb:             test MRR@100 0.0424
wandb:              test MRR@20 0.0376
wandb:              test MRR@50 0.041
wandb:             test NDCG@10 0.0274
wandb:            test NDCG@100 0.0656
wandb:             test NDCG@20 0.0364
wandb:             test NDCG@50 0.0515
wandb:        test Precision@10 0.0105
wandb:       test Precision@100 0.0051
wandb:        test Precision@20 0.0089
wandb:        test Precision@50 0.0067
wandb:           test Recall@10 0.0444
wandb:          test Recall@100 0.2032
wandb:           test Recall@20 0.0741
wandb:           test Recall@50 0.1347
wandb:             valid MRR@10 0.0394
wandb:            valid MRR@100 0.049
wandb:             valid MRR@20 0.0438
wandb:             valid MRR@50 0.0475
wandb:            valid NDCG@10 0.0241
wandb:           valid NDCG@100 0.0582
wandb:            valid NDCG@20 0.0312
wandb:            valid NDCG@50 0.0446
wandb:       valid Precision@10 0.0125
wandb:      valid Precision@100 0.0068
wandb:       valid Precision@20 0.0107
wandb:       valid Precision@50 0.0084
wandb:          valid Recall@10 0.0333
wandb:         valid Recall@100 0.1613
wandb:          valid Recall@20 0.0558
wandb:          valid Recall@50 0.1038
wandb: 
wandb:  View run T-DiffRec_yelp_noisy_5_Reproduction at: https://wandb.ai/drs/drs/runs/ny4s8hj5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_210459-ny4s8hj5/logs
Runing Epoch 069 train loss 234.5788 costs 00: 00: 16
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 050 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0107
0.0084
0.0067
 0.0337
0.0565
0.1061
0.1621
 0.0244
0.0316
0.0453
0.0586
 0.0395
0.044
0.0477
0.0492

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0107
0.0089
0.0066
0.0051
 0.0455
0.0745
0.1351
0.2047
 0.0282
0.0371
0.0521
0.0664
 0.035
0.0388
0.0421
0.0436

End time:  2023-06-23 21:36:20
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_213634-h3u6qaj9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_clean_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/h3u6qaj9
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 21:36:37
user num: 5949
item num: 2810
data ready.
Embedding size: 10
models ready.
Number of all parameters: 5633970
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 6382.9528 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 5571.0587 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 5097.6237 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 4728.4715 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0607
0.0554
0.0456
0.0376
 0.0434
0.076
0.1477
0.228
 0.0699
0.0771
0.1001
0.1299
 0.149
0.1584
0.1645
0.166

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0454
0.0398
0.0312
0.0246
 0.0557
0.0979
0.1811
0.2735
 0.0598
0.0723
0.1006
0.1298
 0.1169
0.1258
0.1315
0.1333

Runing Epoch 005 train loss 4419.1385 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 4154.7641 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3906.9134 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3702.1864 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3527.6827 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0661
0.0608
0.0511
0.0426
 0.0529
0.0908
0.1766
0.2707
 0.0795
0.0893
0.118
0.1532
 0.1664
0.177
0.1832
0.1846

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0545
0.0472
0.0381
0.0301
 0.0742
0.1228
0.2323
0.3444
 0.0762
0.0916
0.1292
0.165
 0.1424
0.1519
0.1584
0.16

Runing Epoch 010 train loss 3355.0641 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 3215.1097 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 3078.6747 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2960.8746 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2852.1939 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0672
0.0616
0.0527
0.0445
 0.056
0.0973
0.1916
0.2969
 0.0805
0.0916
0.124
0.163
 0.1639
0.1756
0.182
0.1833

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0576
0.0515
0.0415
0.0328
 0.0837
0.1408
0.2654
0.392
 0.0828
0.1023
0.1448
0.1849
 0.1515
0.1623
0.1689
0.1705

Runing Epoch 015 train loss 2759.9395 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2673.9613 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2588.6410 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2518.1661 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2450.1986 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0661
0.0618
0.0533
0.0456
 0.0582
0.1023
0.2012
0.3139
 0.0811
0.094
0.1283
0.1698
 0.1643
0.1765
0.1832
0.1846

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0604
0.0535
0.0434
0.0343
 0.0936
0.1531
0.2867
0.4229
 0.089
0.1096
0.1554
0.1981
 0.1565
0.1674
0.1744
0.1759

Runing Epoch 020 train loss 2390.1648 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2335.8345 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2283.0884 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2235.6256 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 2191.6496 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0664
0.0618
0.0536
0.0461
 0.0598
0.1048
0.2072
0.3246
 0.082
0.0952
0.1306
0.1734
 0.1661
0.178
0.185
0.1864

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0613
0.0545
0.0447
0.0351
 0.0972
0.161
0.302
0.4386
 0.0916
0.1137
0.1621
0.2051
 0.1592
0.1708
0.1778
0.1793

Runing Epoch 025 train loss 2150.7198 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 2117.8202 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 2078.6484 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 2040.6558 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 2008.2482 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0654
0.0613
0.0534
0.0461
 0.0608
0.1076
0.2118
0.333
 0.0812
0.0956
0.1319
0.1758
 0.1617
0.1743
0.1813
0.1828

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0624
0.0559
0.0452
0.0354
 0.102
0.1705
0.3124
0.4499
 0.0939
0.1178
0.1664
0.2097
 0.1603
0.1722
0.179
0.1805

Runing Epoch 030 train loss 1977.0405 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1953.6521 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1923.8859 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1903.6864 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1878.1914 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.061
0.0537
0.046
 0.062
0.1086
0.2155
0.3353
 0.0812
0.0956
0.1329
0.1762
 0.1605
0.173
0.1801
0.1817

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0627
0.0567
0.0454
0.0356
 0.1051
0.1751
0.3181
0.4565
 0.0959
0.1206
0.1695
0.213
 0.1627
0.1748
0.1816
0.183

Runing Epoch 035 train loss 1860.0728 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1834.4590 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1811.8033 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1791.8322 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1773.3335 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0655
0.061
0.0535
0.046
 0.063
0.1087
0.217
0.3374
 0.0815
0.0956
0.1333
0.1769
 0.1604
0.1728
0.1799
0.1814

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0633
0.0567
0.0454
0.0358
 0.1062
0.1773
0.3205
0.4619
 0.0979
0.1226
0.1716
0.2159
 0.1669
0.1788
0.1857
0.1871

Runing Epoch 040 train loss 1761.1078 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1741.2144 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1727.1047 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1715.3215 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1700.2394 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0661
0.0612
0.0533
0.0461
 0.0638
0.1119
0.2198
0.3421
 0.0827
0.0973
0.1347
0.1789
 0.1634
0.1756
0.1828
0.1843

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0637
0.057
0.0463
0.0363
 0.1096
0.1825
0.3297
0.4737
 0.099
0.1245
0.1751
0.2201
 0.1669
0.1793
0.1861
0.1875

Runing Epoch 045 train loss 1685.7760 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1673.7335 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 047 train loss 1662.0990 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1645.9231 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1636.7425 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0655
0.0604
0.0532
0.0458
 0.0639
0.1112
0.2197
0.3413
 0.0824
0.0967
0.1346
0.1786
 0.1635
0.1758
0.183
0.1846

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0633
0.0568
0.0461
0.0362
 0.1097
0.1818
0.3306
0.4739
 0.0991
0.1244
0.1755
0.2203
 0.169
0.1813
0.1882
0.1896

Runing Epoch 050 train loss 1623.7232 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1616.6799 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1604.6593 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1591.9615 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1585.1880 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0651
0.0606
0.0531
0.0456
 0.0634
0.1118
0.2205
0.3423
 0.0816
0.0963
0.1341
0.1779
 0.1606
0.1728
0.1801
0.1817

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0633
0.0569
0.0461
0.0361
 0.1116
0.1835
0.3311
0.4747
 0.0994
0.1246
0.1753
0.2202
 0.1672
0.1795
0.1862
0.1877

Runing Epoch 055 train loss 1574.3768 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1563.0641 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1552.0518 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1544.5453 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 059 train loss 1534.2999 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.0611
0.0535
0.0457
 0.064
0.1135
0.2229
0.345
 0.082
0.0972
0.1353
0.1792
 0.1619
0.1744
0.1818
0.1833

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0641
0.0578
0.0467
0.0364
 0.1132
0.1886
0.337
0.4796
 0.1002
0.1268
0.1779
0.2226
 0.1665
0.179
0.1857
0.1871

Runing Epoch 060 train loss 1529.3671 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 061 train loss 1523.2450 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 062 train loss 1517.4757 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 063 train loss 1502.9401 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 064 train loss 1498.1523 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.065
0.0605
0.053
0.0457
 0.0647
0.1128
0.221
0.3452
 0.0822
0.0971
0.1349
0.1794
 0.1622
0.1745
0.1819
0.1834

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0637
0.0574
0.0463
0.0363
 0.112
0.1854
0.3364
0.4798
 0.1001
0.1261
0.1776
0.2225
 0.1676
0.1803
0.187
0.1885

Runing Epoch 065 train loss 1492.2335 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 066 train loss 1481.2675 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 067 train loss 1474.8796 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 068 train loss 1470.1811 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 069 train loss 1463.2886 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0652
0.061
0.0529
0.0454
 0.0639
0.1134
0.2218
0.3441
 0.0818
0.097
0.1347
0.1785
 0.162
0.1744
0.1816
0.1832

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0636
0.0575
0.0463
0.0363
 0.1123
0.1859
0.3366
0.4791
 0.1002
0.1263
0.1777
0.2225
 0.1682
0.1808
0.1875
0.1889

Runing Epoch 070 train loss 1454.3174 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 071 train loss 1453.5784 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 072 train loss 1443.2453 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 073 train loss 1438.5426 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 074 train loss 1436.8305 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0647
0.06
0.0527
0.0455
 0.0647
0.1124
0.222
0.3458
 0.0813
0.096
0.1343
0.1787
 0.161
0.1732
0.1806
0.1822

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0642
0.0572
0.0464
0.0363
 0.1138
0.1876
0.3391
0.4832
 0.1014
0.1273
0.1791
0.2241
 0.1689
0.1813
0.1882
0.1896

Runing Epoch 075 train loss 1428.0712 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 076 train loss 1420.1781 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 077 train loss 1420.7246 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 078 train loss 1413.5052 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 60
wandb:         batch_loss_train 91.957
wandb:         best_test MRR@10 0.1665
wandb:        best_test MRR@100 0.1871
wandb:         best_test MRR@20 0.179
wandb:         best_test MRR@50 0.1857
wandb:        best_test NDCG@10 0.1002
wandb:       best_test NDCG@100 0.2226
wandb:        best_test NDCG@20 0.1268
wandb:        best_test NDCG@50 0.1779
wandb:   best_test Precision@10 0.0641
wandb:  best_test Precision@100 0.0364
wandb:   best_test Precision@20 0.0578
wandb:   best_test Precision@50 0.0467
wandb:      best_test Recall@10 0.1132
wandb:     best_test Recall@100 0.4796
wandb:      best_test Recall@20 0.1886
wandb:      best_test Recall@50 0.337
wandb:        best_valid MRR@10 0.1619
wandb:       best_valid MRR@100 0.1833
wandb:        best_valid MRR@20 0.1744
wandb:        best_valid MRR@50 0.1818
wandb:       best_valid NDCG@10 0.082
wandb:      best_valid NDCG@100 0.1792
wandb:       best_valid NDCG@20 0.0972
wandb:       best_valid NDCG@50 0.1353
wandb:  best_valid Precision@10 0.0653
wandb: best_valid Precision@100 0.0457
wandb:  best_valid Precision@20 0.0611
wandb:  best_valid Precision@50 0.0535
wandb:     best_valid Recall@10 0.064
wandb:    best_valid Recall@100 0.345
wandb:     best_valid Recall@20 0.1135
wandb:     best_valid Recall@50 0.2229
wandb:    epoch_loss_norm_train 93.98157
wandb:              test MRR@10 0.1689
wandb:             test MRR@100 0.1896
wandb:              test MRR@20 0.1813
wandb:              test MRR@50 0.1882
wandb:             test NDCG@10 0.1014
wandb:            test NDCG@100 0.2241
wandb:             test NDCG@20 0.1273
wandb:             test NDCG@50 0.1791
wandb:        test Precision@10 0.0642
wandb:       test Precision@100 0.0363
wandb:        test Precision@20 0.0572
wandb:        test Precision@50 0.0464
wandb:           test Recall@10 0.1138
wandb:          test Recall@100 0.4832
wandb:           test Recall@20 0.1876
wandb:           test Recall@50 0.3391
wandb:             valid MRR@10 0.161
wandb:            valid MRR@100 0.1822
wandb:             valid MRR@20 0.1732
wandb:             valid MRR@50 0.1806
wandb:            valid NDCG@10 0.0813
wandb:           valid NDCG@100 0.1787
wandb:            valid NDCG@20 0.096
wandb:            valid NDCG@50 0.1343
wandb:       valid Precision@10 0.0647
wandb:      valid Precision@100 0.0455
wandb:       valid Precision@20 0.06
wandb:       valid Precision@50 0.0527
wandb:          valid Recall@10 0.0647
wandb:         valid Recall@100 0.3458
wandb:          valid Recall@20 0.1124
wandb:          valid Recall@50 0.222
wandb: 
wandb:  View run T-DiffRec_ml-1m_clean_5_Reproduction at: https://wandb.ai/drs/drs/runs/h3u6qaj9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_213634-h3u6qaj9/logs
Runing Epoch 079 train loss 1409.7235 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 060 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0653
0.0611
0.0535
0.0457
 0.064
0.1135
0.2229
0.345
 0.082
0.0972
0.1353
0.1792
 0.1619
0.1744
0.1818
0.1833

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0641
0.0578
0.0467
0.0364
 0.1132
0.1886
0.337
0.4796
 0.1002
0.1268
0.1779
0.2226
 0.1665
0.179
0.1857
0.1871

End time:  2023-06-23 21:38:32
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_213844-gmxh7ovb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_ml-1m_noisy_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/gmxh7ovb
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 21:38:48
user num: 5949
item num: 3494
data ready.
Embedding size: 10
models ready.
Number of all parameters: 7002654
Start training...
/home/lcur2420/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 5260.3016 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 002 train loss 4652.0165 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 003 train loss 4275.9471 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 004 train loss 3997.8622 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0357
0.0348
0.0322
0.0294
 0.03
0.056
0.1159
0.1903
 0.0419
0.0497
0.0696
0.0951
 0.0941
0.1046
0.1114
0.1133

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0327
0.031
0.0264
0.0216
 0.0476
0.0866
0.1694
0.2619
 0.045
0.0585
0.0873
0.1158
 0.0874
0.0971
0.1039
0.1058

Runing Epoch 005 train loss 3747.6866 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 006 train loss 3533.4814 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 007 train loss 3352.2566 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 008 train loss 3182.5318 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 009 train loss 3038.9567 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0352
0.0349
0.0338
0.0326
 0.0326
0.0609
0.1304
0.2276
 0.042
0.0513
0.0753
0.1086
 0.0923
0.1034
0.1108
0.113

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0342
0.0331
0.0294
0.0254
 0.0553
0.1014
0.201
0.3229
 0.048
0.0649
0.0998
0.1372
 0.0866
0.0975
0.1049
0.107

Runing Epoch 010 train loss 2914.6481 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 011 train loss 2789.9187 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 012 train loss 2687.7872 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 013 train loss 2592.1408 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 014 train loss 2505.6184 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0334
0.0343
0.0347
0.0334
 0.0343
0.0656
0.1459
0.25
 0.0405
0.0517
0.0802
0.1158
 0.0846
0.0966
0.105
0.1071

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0345
0.034
0.0312
0.0272
 0.0629
0.1129
0.2278
0.3632
 0.0506
0.0698
0.1098
0.1512
 0.0857
0.0977
0.1057
0.1078

Runing Epoch 015 train loss 2434.2609 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 016 train loss 2360.7685 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 017 train loss 2294.7961 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 018 train loss 2236.3515 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 019 train loss 2180.5998 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0325
0.0337
0.0348
0.034
 0.0362
0.0691
0.156
0.2662
 0.0403
0.0523
0.0831
0.1208
 0.0825
0.0945
0.1034
0.1054

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0348
0.0348
0.0322
0.0282
 0.0671
0.1211
0.2504
0.3904
 0.0523
0.0732
0.1172
0.1603
 0.085
0.0975
0.106
0.1081

Runing Epoch 020 train loss 2135.3094 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 021 train loss 2088.5070 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 022 train loss 2040.6845 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 023 train loss 2006.6132 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 024 train loss 1967.3501 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0322
0.0337
0.035
0.0342
 0.0384
0.0715
0.161
0.2757
 0.0412
0.0535
0.0851
0.124
 0.0839
0.0959
0.105
0.1072

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0352
0.0354
0.0324
0.0287
 0.0699
0.126
0.2588
0.4106
 0.0535
0.0753
0.1202
0.1661
 0.0857
0.0983
0.1069
0.109

Runing Epoch 025 train loss 1930.0401 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 026 train loss 1896.6491 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 027 train loss 1870.3851 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 028 train loss 1841.8053 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 029 train loss 1816.3279 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0315
0.033
0.0346
0.0336
 0.0383
0.0718
0.1647
0.2827
 0.0399
0.0525
0.0852
0.1244
 0.0791
0.0912
0.1005
0.1027

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0361
0.0361
0.0329
0.0286
 0.0728
0.133
0.2695
0.4189
 0.0552
0.0782
0.1241
0.1692
 0.0863
0.0989
0.1074
0.1095

Runing Epoch 030 train loss 1792.5310 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 031 train loss 1765.8230 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 032 train loss 1747.0257 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 033 train loss 1726.1262 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 034 train loss 1703.8505 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0315
0.0325
0.0345
0.0336
 0.038
0.0728
0.1665
0.2853
 0.0398
0.0524
0.0856
0.125
 0.0789
0.0908
0.1002
0.1024

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0363
0.033
0.0288
 0.0741
0.1371
0.2739
0.4253
 0.0558
0.0796
0.1258
0.1715
 0.0882
0.1005
0.1092
0.1114

Runing Epoch 035 train loss 1683.4168 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 036 train loss 1666.3553 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 037 train loss 1648.3715 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 038 train loss 1632.1780 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 039 train loss 1612.4655 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0319
0.0329
0.0342
0.0334
 0.0398
0.0756
0.1703
0.2901
 0.0407
0.0538
0.0868
0.1264
 0.0804
0.0919
0.1013
0.1036

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0361
0.033
0.0289
 0.0762
0.1381
0.2791
0.4327
 0.0568
0.0804
0.1275
0.1736
 0.0872
0.1
0.1087
0.1109

Runing Epoch 040 train loss 1598.5850 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 041 train loss 1587.8088 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 042 train loss 1571.9663 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 043 train loss 1561.9647 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 044 train loss 1545.6421 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0317
0.0325
0.0341
0.0331
 0.04
0.0742
0.17
0.2886
 0.0405
0.053
0.0863
0.1256
 0.0782
0.0899
0.0993
0.1015

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0365
0.0364
0.033
0.0288
 0.0774
0.1422
0.2805
0.4342
 0.0575
0.0819
0.1285
0.1745
 0.0883
0.1011
0.1098
0.112

Runing Epoch 045 train loss 1534.8581 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 046 train loss 1521.4188 costs 00: 00: 01
------------------------------------------------------
Runing Epoch 047 train loss 1512.1551 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 048 train loss 1498.3090 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 049 train loss 1483.7872 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.032
0.033
0.0343
0.0334
 0.0399
0.0751
0.1732
0.2932
 0.0408
0.0538
0.0876
0.1273
 0.0798
0.092
0.1013
0.1035

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0374
0.0364
0.0333
0.0289
 0.0791
0.1424
0.2844
0.4393
 0.0589
0.0826
0.1301
0.1763
 0.0894
0.1019
0.1105
0.1128

Runing Epoch 050 train loss 1479.1443 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 051 train loss 1466.2131 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 052 train loss 1456.3567 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 053 train loss 1447.1508 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 054 train loss 1438.0552 costs 00: 00: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0315
0.0328
0.0341
0.033
 0.0393
0.0754
0.1739
0.2914
 0.0401
0.0534
0.0873
0.1262
 0.0785
0.0909
0.1002
0.1024

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0363
0.0331
0.0287
 0.0767
0.144
0.286
0.44
 0.0575
0.0826
0.1301
0.1761
 0.0886
0.1016
0.1102
0.1124

Runing Epoch 055 train loss 1426.2997 costs 00: 00: 03
------------------------------------------------------
Runing Epoch 056 train loss 1421.6576 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 057 train loss 1414.0953 costs 00: 00: 00
------------------------------------------------------
Runing Epoch 058 train loss 1402.5984 costs 00: 00: 00
------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 40
wandb:         batch_loss_train 95.33132
wandb:         best_test MRR@10 0.0872
wandb:        best_test MRR@100 0.1109
wandb:         best_test MRR@20 0.1
wandb:         best_test MRR@50 0.1087
wandb:        best_test NDCG@10 0.0568
wandb:       best_test NDCG@100 0.1736
wandb:        best_test NDCG@20 0.0804
wandb:        best_test NDCG@50 0.1275
wandb:   best_test Precision@10 0.0362
wandb:  best_test Precision@100 0.0289
wandb:   best_test Precision@20 0.0361
wandb:   best_test Precision@50 0.033
wandb:      best_test Recall@10 0.0762
wandb:     best_test Recall@100 0.4327
wandb:      best_test Recall@20 0.1381
wandb:      best_test Recall@50 0.2791
wandb:        best_valid MRR@10 0.0804
wandb:       best_valid MRR@100 0.1036
wandb:        best_valid MRR@20 0.0919
wandb:        best_valid MRR@50 0.1013
wandb:       best_valid NDCG@10 0.0407
wandb:      best_valid NDCG@100 0.1264
wandb:       best_valid NDCG@20 0.0538
wandb:       best_valid NDCG@50 0.0868
wandb:  best_valid Precision@10 0.0319
wandb: best_valid Precision@100 0.0334
wandb:  best_valid Precision@20 0.0329
wandb:  best_valid Precision@50 0.0342
wandb:     best_valid Recall@10 0.0398
wandb:    best_valid Recall@100 0.2901
wandb:     best_valid Recall@20 0.0756
wandb:     best_valid Recall@50 0.1703
wandb:    epoch_loss_norm_train 93.0775
wandb:              test MRR@10 0.0886
wandb:             test MRR@100 0.1124
wandb:              test MRR@20 0.1016
wandb:              test MRR@50 0.1102
wandb:             test NDCG@10 0.0575
wandb:            test NDCG@100 0.1761
wandb:             test NDCG@20 0.0826
wandb:             test NDCG@50 0.1301
wandb:        test Precision@10 0.0362
wandb:       test Precision@100 0.0287
wandb:        test Precision@20 0.0363
wandb:        test Precision@50 0.0331
wandb:           test Recall@10 0.0767
wandb:          test Recall@100 0.44
wandb:           test Recall@20 0.144
wandb:           test Recall@50 0.286
wandb:             valid MRR@10 0.0785
wandb:            valid MRR@100 0.1024
wandb:             valid MRR@20 0.0909
wandb:             valid MRR@50 0.1002
wandb:            valid NDCG@10 0.0401
wandb:           valid NDCG@100 0.1262
wandb:            valid NDCG@20 0.0534
wandb:            valid NDCG@50 0.0873
wandb:       valid Precision@10 0.0315
wandb:      valid Precision@100 0.033
wandb:       valid Precision@20 0.0328
wandb:       valid Precision@50 0.0341
wandb:          valid Recall@10 0.0393
wandb:         valid Recall@100 0.2914
wandb:          valid Recall@20 0.0754
wandb:          valid Recall@50 0.1739
wandb: 
wandb:  View run T-DiffRec_ml-1m_noisy_5_Reproduction at: https://wandb.ai/drs/drs/runs/gmxh7ovb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_213844-gmxh7ovb/logs
Runing Epoch 059 train loss 1396.1626 costs 00: 00: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 040 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0319
0.0329
0.0342
0.0334
 0.0398
0.0756
0.1703
0.2901
 0.0407
0.0538
0.0868
0.1264
 0.0804
0.0919
0.1013
0.1036

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0362
0.0361
0.033
0.0289
 0.0762
0.1381
0.2791
0.4327
 0.0568
0.0804
0.1275
0.1736
 0.0872
0.1
0.1087
0.1109

End time:  2023-06-23 21:40:13
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_214027-mymxcpiy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_clean_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/mymxcpiy
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 20
wandb:         batch_loss_train 0.96914
wandb:         best_test MRR@10 0.0513
wandb:        best_test MRR@100 0.0576
wandb:         best_test MRR@20 0.0544
wandb:         best_test MRR@50 0.0567
wandb:        best_test NDCG@10 0.0426
wandb:       best_test NDCG@100 0.0697
wandb:        best_test NDCG@20 0.0499
wandb:        best_test NDCG@50 0.0609
wandb:   best_test Precision@10 0.0138
wandb:  best_test Precision@100 0.0045
wandb:   best_test Precision@20 0.0101
wandb:   best_test Precision@50 0.0065
wandb:      best_test Recall@10 0.061
wandb:     best_test Recall@100 0.1704
wandb:      best_test Recall@20 0.0856
wandb:      best_test Recall@50 0.1293
wandb:        best_valid MRR@10 0.0359
wandb:       best_valid MRR@100 0.0423
wandb:        best_valid MRR@20 0.0389
wandb:        best_valid MRR@50 0.0413
wandb:       best_valid NDCG@10 0.0238
wandb:      best_valid NDCG@100 0.0451
wandb:       best_valid NDCG@20 0.0292
wandb:       best_valid NDCG@50 0.0378
wandb:  best_valid Precision@10 0.0112
wandb: best_valid Precision@100 0.0044
wandb:  best_valid Precision@20 0.0088
wandb:  best_valid Precision@50 0.0061
wandb:     best_valid Recall@10 0.0321
wandb:    best_valid Recall@100 0.1092
wandb:     best_valid Recall@20 0.0486
wandb:     best_valid Recall@50 0.0788
wandb:    epoch_loss_norm_train 0.76032
wandb:              test MRR@10 0.0515
wandb:             test MRR@100 0.0578
wandb:              test MRR@20 0.0546
wandb:              test MRR@50 0.0569
wandb:             test NDCG@10 0.0428
wandb:            test NDCG@100 0.0697
wandb:             test NDCG@20 0.0499
wandb:             test NDCG@50 0.0609
wandb:        test Precision@10 0.014
wandb:       test Precision@100 0.0046
wandb:        test Precision@20 0.0102
wandb:        test Precision@50 0.0066
wandb:           test Recall@10 0.0613
wandb:          test Recall@100 0.1703
wandb:           test Recall@20 0.0849
wandb:           test Recall@50 0.1285
wandb:             valid MRR@10 0.0354
wandb:            valid MRR@100 0.0418
wandb:             valid MRR@20 0.0384
wandb:             valid MRR@50 0.0408
wandb:            valid NDCG@10 0.0237
wandb:           valid NDCG@100 0.045
wandb:            valid NDCG@20 0.0289
wandb:            valid NDCG@50 0.0375
wandb:       valid Precision@10 0.0112
wandb:      valid Precision@100 0.0045
wandb:       valid Precision@20 0.0088
wandb:       valid Precision@50 0.0061
wandb:          valid Recall@10 0.0325
wandb:         valid Recall@100 0.1095
wandb:          valid Recall@20 0.0483
wandb:          valid Recall@50 0.0786
wandb: 
wandb:  View run T-DiffRec_amazon-book_clean_2_Reproduction at: https://wandb.ai/drs/drs/runs/mymxcpiy
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_214027-mymxcpiy/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=10, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 21:40:30
user num: 108822
item num: 94949
data ready.
Embedding size: 10
models ready.
Number of all parameters: 190004159
Start training...
Runing Epoch 001 train loss 245.2790 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 002 train loss 226.1987 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 003 train loss 223.9479 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 004 train loss 220.2527 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0079
0.0066
0.0048
0.0036
 0.0209
0.0334
0.0571
0.0843
 0.0154
0.0195
0.0263
0.0329
 0.0241
0.0266
0.0287
0.0296

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0089
0.0069
0.0048
0.0035
 0.0367
0.0544
0.0886
0.125
 0.0247
0.0301
0.0387
0.0464
 0.0305
0.0329
0.0349
0.0357

Runing Epoch 005 train loss 219.0114 costs 00: 03: 45
------------------------------------------------------
Runing Epoch 006 train loss 216.6782 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 007 train loss 214.9892 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 008 train loss 213.9618 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 009 train loss 212.1738 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0082
0.0058
0.0043
 0.0283
0.0435
0.0723
0.1025
 0.0209
0.0259
0.034
0.0414
 0.032
0.0349
0.0372
0.0382

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0123
0.0093
0.006
0.0043
 0.0525
0.0758
0.1164
0.1582
 0.0363
0.0433
0.0536
0.0624
 0.0443
0.0473
0.0496
0.0505

Runing Epoch 010 train loss 212.6121 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 011 train loss 211.3808 costs 00: 00: 39
------------------------------------------------------
Runing Epoch 012 train loss 210.1164 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 013 train loss 209.9225 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 014 train loss 209.4284 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0108
0.0086
0.0059
0.0043
 0.0308
0.0466
0.075
0.1045
 0.0229
0.0281
0.0362
0.0433
 0.0346
0.0376
0.0399
0.0408

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0135
0.0098
0.0063
0.0044
 0.0592
0.0823
0.1236
0.1637
 0.0412
0.0481
0.0585
0.0671
 0.0496
0.0525
0.0548
0.0557

Runing Epoch 015 train loss 209.2998 costs 00: 03: 46
------------------------------------------------------
Runing Epoch 016 train loss 208.4853 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 017 train loss 208.6126 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 018 train loss 207.9666 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 019 train loss 208.0566 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.0061
0.0044
 0.0321
0.0486
0.0788
0.1092
 0.0238
0.0292
0.0378
0.0451
 0.0359
0.0389
0.0413
0.0423

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.0101
0.0065
0.0045
 0.061
0.0856
0.1293
0.1704
 0.0426
0.0499
0.0609
0.0697
 0.0513
0.0544
0.0567
0.0576

Runing Epoch 020 train loss 208.1197 costs 00: 03: 48
------------------------------------------------------
Runing Epoch 021 train loss 207.5883 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 022 train loss 207.2867 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 023 train loss 206.4659 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 024 train loss 207.1423 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0111
0.0088
0.0061
0.0044
 0.0318
0.0482
0.0783
0.109
 0.0236
0.029
0.0375
0.0449
 0.0355
0.0386
0.041
0.0419

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0139
0.0102
0.0065
0.0045
 0.0615
0.0857
0.1286
0.1701
 0.0429
0.0502
0.061
0.0698
 0.0515
0.0546
0.0569
0.0578

Runing Epoch 025 train loss 207.6826 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 026 train loss 207.2266 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 027 train loss 207.8009 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 028 train loss 208.0342 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 029 train loss 207.6803 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.01
0.0078
0.0053
0.0038
 0.029
0.0431
0.0678
0.0922
 0.0216
0.0263
0.0333
0.0392
 0.0327
0.0354
0.0374
0.0382

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0129
0.0092
0.0057
0.0039
 0.057
0.0778
0.1133
0.1467
 0.0402
0.0465
0.0555
0.0626
 0.0487
0.0514
0.0534
0.0541

Runing Epoch 030 train loss 207.2265 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 031 train loss 207.6081 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 032 train loss 207.6239 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 033 train loss 207.6477 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 034 train loss 207.3336 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.0061
0.0045
 0.0325
0.0483
0.0786
0.1095
 0.0237
0.0289
0.0375
0.045
 0.0354
0.0384
0.0408
0.0418

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.014
0.0102
0.0066
0.0046
 0.0613
0.0849
0.1285
0.1703
 0.0428
0.0499
0.0609
0.0697
 0.0515
0.0546
0.0569
0.0578

Runing Epoch 035 train loss 208.0081 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 036 train loss 207.2579 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 037 train loss 208.3149 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 038 train loss 207.5347 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 039 train loss 207.5674 costs 00: 00: 38
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 020 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.0061
0.0044
 0.0321
0.0486
0.0788
0.1092
 0.0238
0.0292
0.0378
0.0451
 0.0359
0.0389
0.0413
0.0423

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.0101
0.0065
0.0045
 0.061
0.0856
0.1293
0.1704
 0.0426
0.0499
0.0609
0.0697
 0.0513
0.0544
0.0567
0.0576

End time:  2023-06-23 22:27:24
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230623_222738-aua3scn9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_noisy_2_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/aua3scn9
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: \ 0.030 MB of 0.030 MB uploaded (0.000 MB deduped)wandb: | 0.030 MB of 0.030 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 5
wandb:         batch_loss_train 0.09566
wandb:         best_test MRR@10 0.019
wandb:        best_test MRR@100 0.0221
wandb:         best_test MRR@20 0.0205
wandb:         best_test MRR@50 0.0217
wandb:        best_test NDCG@10 0.0154
wandb:       best_test NDCG@100 0.0271
wandb:        best_test NDCG@20 0.0187
wandb:        best_test NDCG@50 0.0234
wandb:   best_test Precision@10 0.0056
wandb:  best_test Precision@100 0.002
wandb:   best_test Precision@20 0.0043
wandb:   best_test Precision@50 0.0029
wandb:      best_test Recall@10 0.0234
wandb:     best_test Recall@100 0.0689
wandb:      best_test Recall@20 0.0343
wandb:      best_test Recall@50 0.0522
wandb:        best_valid MRR@10 0.0147
wandb:       best_valid MRR@100 0.0178
wandb:        best_valid MRR@20 0.0162
wandb:        best_valid MRR@50 0.0173
wandb:       best_valid NDCG@10 0.0095
wandb:      best_valid NDCG@100 0.0178
wandb:       best_valid NDCG@20 0.0116
wandb:       best_valid NDCG@50 0.015
wandb:  best_valid Precision@10 0.0046
wandb: best_valid Precision@100 0.0019
wandb:  best_valid Precision@20 0.0037
wandb:  best_valid Precision@50 0.0026
wandb:     best_valid Recall@10 0.0133
wandb:    best_valid Recall@100 0.044
wandb:     best_valid Recall@20 0.0202
wandb:     best_valid Recall@50 0.0325
wandb:    epoch_loss_norm_train 0.04056
wandb:              test MRR@10 0.0089
wandb:             test MRR@100 0.0097
wandb:              test MRR@20 0.0093
wandb:              test MRR@50 0.0096
wandb:             test NDCG@10 0.0067
wandb:            test NDCG@100 0.0094
wandb:             test NDCG@20 0.0074
wandb:             test NDCG@50 0.0085
wandb:        test Precision@10 0.0023
wandb:       test Precision@100 0.0006
wandb:        test Precision@20 0.0016
wandb:        test Precision@50 0.0009
wandb:           test Recall@10 0.0088
wandb:          test Recall@100 0.0192
wandb:           test Recall@20 0.0113
wandb:           test Recall@50 0.0153
wandb:             valid MRR@10 0.0051
wandb:            valid MRR@100 0.0059
wandb:             valid MRR@20 0.0055
wandb:             valid MRR@50 0.0058
wandb:            valid NDCG@10 0.0031
wandb:           valid NDCG@100 0.0048
wandb:            valid NDCG@20 0.0036
wandb:            valid NDCG@50 0.0042
wandb:       valid Precision@10 0.0015
wandb:      valid Precision@100 0.0005
wandb:       valid Precision@20 0.0011
wandb:       valid Precision@50 0.0007
wandb:          valid Recall@10 0.004
wandb:         valid Recall@100 0.0101
wandb:          valid Recall@20 0.0056
wandb:          valid Recall@50 0.0079
wandb: 
wandb:  View run T-DiffRec_amazon-book_noisy_2_Reproduction at: https://wandb.ai/drs/drs/runs/aua3scn9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230623_222738-aua3scn9/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=2, steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-23 22:27:41
user num: 108822
item num: 178181
data ready.
Embedding size: 10
models ready.
Number of all parameters: 356552291
Start training...
Runing Epoch 001 train loss 12.5185 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 002 train loss 12.0044 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 003 train loss 12.0122 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 004 train loss 11.7083 costs 00: 01: 03
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0046
0.0037
0.0026
0.0019
 0.0133
0.0202
0.0325
0.044
 0.0095
0.0116
0.015
0.0178
 0.0147
0.0162
0.0173
0.0178

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0056
0.0043
0.0029
0.002
 0.0234
0.0343
0.0522
0.0689
 0.0154
0.0187
0.0234
0.0271
 0.019
0.0205
0.0217
0.0221

Runing Epoch 005 train loss 11.5896 costs 00: 38: 59
------------------------------------------------------
Runing Epoch 006 train loss 11.4519 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 007 train loss 11.3975 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 008 train loss 11.3407 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 009 train loss 11.2696 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0018
0.0014
0.001
0.0008
 0.0047
0.0073
0.0119
0.0169
 0.0035
0.0043
0.0055
0.0066
 0.0059
0.0064
0.0069
0.0071

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0022
0.0017
0.0011
0.0008
 0.009
0.0128
0.0195
0.0263
 0.006
0.0072
0.0089
0.0104
 0.0077
0.0083
0.0087
0.0089

Runing Epoch 010 train loss 11.1628 costs 00: 38: 52
------------------------------------------------------
Runing Epoch 011 train loss 11.1588 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 012 train loss 11.1089 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 013 train loss 11.1356 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 014 train loss 11.0578 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0031
0.0023
0.0015
0.001
 0.0097
0.0133
0.0187
0.0237
 0.0074
0.0084
0.0099
0.0111
 0.0115
0.0123
0.0128
0.013

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0045
0.0031
0.0018
0.0012
 0.0191
0.0249
0.0342
0.0422
 0.0136
0.0154
0.0178
0.0196
 0.0173
0.0182
0.0188
0.019

Runing Epoch 015 train loss 11.0711 costs 00: 38: 53
------------------------------------------------------
Runing Epoch 016 train loss 11.0577 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 017 train loss 11.1996 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 018 train loss 11.0525 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 019 train loss 10.9069 costs 00: 01: 02
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0015
0.0011
0.0007
0.0005
 0.004
0.0056
0.0079
0.0101
 0.0031
0.0036
0.0042
0.0048
 0.0051
0.0055
0.0058
0.0059

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0023
0.0016
0.0009
0.0006
 0.0088
0.0113
0.0153
0.0192
 0.0067
0.0074
0.0085
0.0094
 0.0089
0.0093
0.0096
0.0097

Runing Epoch 020 train loss 10.9794 costs 00: 38: 51
------------------------------------------------------
Runing Epoch 021 train loss 10.8747 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 022 train loss 11.0455 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 023 train loss 10.9752 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 024 train loss 11.0731 costs 00: 01: 04
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 005 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0046
0.0037
0.0026
0.0019
 0.0133
0.0202
0.0325
0.044
 0.0095
0.0116
0.015
0.0178
 0.0147
0.0162
0.0173
0.0178

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0056
0.0043
0.0029
0.002
 0.0234
0.0343
0.0522
0.0689
 0.0154
0.0187
0.0234
0.0271
 0.019
0.0205
0.0217
0.0221

End time:  2023-06-24 01:24:33
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_012444-6vz6vwb8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_clean_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/6vz6vwb8
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 20
wandb:         batch_loss_train 1.11585
wandb:         best_test MRR@10 0.0517
wandb:        best_test MRR@100 0.0579
wandb:         best_test MRR@20 0.0547
wandb:         best_test MRR@50 0.057
wandb:        best_test NDCG@10 0.0428
wandb:       best_test NDCG@100 0.0692
wandb:        best_test NDCG@20 0.05
wandb:        best_test NDCG@50 0.0605
wandb:   best_test Precision@10 0.0138
wandb:  best_test Precision@100 0.0044
wandb:   best_test Precision@20 0.0101
wandb:   best_test Precision@50 0.0064
wandb:      best_test Recall@10 0.0611
wandb:     best_test Recall@100 0.1678
wandb:      best_test Recall@20 0.085
wandb:      best_test Recall@50 0.1268
wandb:        best_valid MRR@10 0.0361
wandb:       best_valid MRR@100 0.0424
wandb:        best_valid MRR@20 0.0392
wandb:        best_valid MRR@50 0.0415
wandb:       best_valid NDCG@10 0.0239
wandb:      best_valid NDCG@100 0.0449
wandb:       best_valid NDCG@20 0.0293
wandb:       best_valid NDCG@50 0.0375
wandb:  best_valid Precision@10 0.0112
wandb: best_valid Precision@100 0.0044
wandb:  best_valid Precision@20 0.0088
wandb:  best_valid Precision@50 0.006
wandb:     best_valid Recall@10 0.0322
wandb:    best_valid Recall@100 0.1083
wandb:     best_valid Recall@20 0.0485
wandb:     best_valid Recall@50 0.0775
wandb:    epoch_loss_norm_train 0.76107
wandb:              test MRR@10 0.0488
wandb:             test MRR@100 0.0543
wandb:              test MRR@20 0.0516
wandb:              test MRR@50 0.0536
wandb:             test NDCG@10 0.04
wandb:            test NDCG@100 0.0629
wandb:             test NDCG@20 0.0464
wandb:             test NDCG@50 0.0556
wandb:        test Precision@10 0.013
wandb:       test Precision@100 0.0041
wandb:        test Precision@20 0.0094
wandb:        test Precision@50 0.0059
wandb:           test Recall@10 0.0564
wandb:          test Recall@100 0.1474
wandb:           test Recall@20 0.0777
wandb:           test Recall@50 0.1137
wandb:             valid MRR@10 0.0331
wandb:            valid MRR@100 0.0387
wandb:             valid MRR@20 0.0359
wandb:             valid MRR@50 0.038
wandb:            valid NDCG@10 0.0218
wandb:           valid NDCG@100 0.0395
wandb:            valid NDCG@20 0.0265
wandb:            valid NDCG@50 0.0336
wandb:       valid Precision@10 0.0103
wandb:      valid Precision@100 0.0039
wandb:       valid Precision@20 0.0081
wandb:       valid Precision@50 0.0054
wandb:          valid Recall@10 0.0291
wandb:         valid Recall@100 0.0921
wandb:          valid Recall@20 0.0434
wandb:          valid Recall@50 0.0681
wandb: 
wandb:  View run T-DiffRec_amazon-book_clean_3_Reproduction at: https://wandb.ai/drs/drs/runs/6vz6vwb8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_012444-6vz6vwb8/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=10, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 01:24:48
user num: 108822
item num: 94949
data ready.
Embedding size: 10
models ready.
Number of all parameters: 190004159
Start training...
Runing Epoch 001 train loss 245.4200 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 002 train loss 228.6208 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 003 train loss 223.1322 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 004 train loss 221.7837 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0076
0.0061
0.0044
0.0033
 0.0196
0.0301
0.0511
0.0737
 0.0151
0.0185
0.0245
0.03
 0.0242
0.0264
0.0282
0.029

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0085
0.0065
0.0043
0.0031
 0.0349
0.0505
0.0794
0.1105
 0.0243
0.029
0.0364
0.043
 0.0305
0.0326
0.0344
0.0351

Runing Epoch 005 train loss 218.2773 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 006 train loss 217.1499 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 007 train loss 215.1833 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 008 train loss 213.8271 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 009 train loss 212.4904 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0104
0.0082
0.0057
0.0043
 0.0293
0.0446
0.073
0.1025
 0.0216
0.0266
0.0347
0.0418
 0.0328
0.0357
0.038
0.0389

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0125
0.0093
0.006
0.0043
 0.0541
0.0768
0.1169
0.1562
 0.0373
0.0441
0.0542
0.0626
 0.0451
0.0481
0.0503
0.0511

Runing Epoch 010 train loss 211.5900 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 011 train loss 211.1355 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 012 train loss 210.4636 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 013 train loss 209.5077 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 014 train loss 209.1151 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0054
0.0043
0.0029
0.0021
 0.0146
0.0227
0.036
0.0502
 0.0114
0.014
0.0179
0.0213
 0.0183
0.0199
0.0211
0.0216

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0067
0.005
0.0032
0.0022
 0.0288
0.0405
0.0611
0.0807
 0.0212
0.0247
0.03
0.0342
 0.0267
0.0283
0.0296
0.03

Runing Epoch 015 train loss 208.2249 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 016 train loss 208.6009 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 017 train loss 208.2352 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 018 train loss 208.4686 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 019 train loss 208.1793 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.006
0.0044
 0.0322
0.0485
0.0775
0.1083
 0.0239
0.0293
0.0375
0.0449
 0.0361
0.0392
0.0415
0.0424

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.0101
0.0064
0.0044
 0.0611
0.085
0.1268
0.1678
 0.0428
0.05
0.0605
0.0692
 0.0517
0.0547
0.057
0.0579

Runing Epoch 020 train loss 208.0815 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 021 train loss 207.7522 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 022 train loss 207.5857 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 023 train loss 207.1491 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 024 train loss 207.7151 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0098
0.0075
0.0049
0.0034
 0.0278
0.0411
0.0625
0.0817
 0.0209
0.0252
0.0313
0.0361
 0.0318
0.0343
0.0361
0.0367

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.0088
0.0054
0.0036
 0.055
0.0743
0.1051
0.1328
 0.0389
0.0448
0.0526
0.0587
 0.0474
0.0499
0.0516
0.0523

Runing Epoch 025 train loss 207.6028 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 026 train loss 207.2914 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 027 train loss 207.0296 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 028 train loss 208.0675 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 029 train loss 208.1228 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0097
0.0074
0.0048
0.0034
 0.0283
0.0408
0.0628
0.0841
 0.0213
0.0254
0.0316
0.0368
 0.0322
0.0345
0.0363
0.037

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0087
0.0053
0.0036
 0.0542
0.0732
0.1049
0.1344
 0.0387
0.0445
0.0525
0.0588
 0.0471
0.0495
0.0512
0.0519

Runing Epoch 030 train loss 207.8616 costs 00: 03: 40
------------------------------------------------------
Runing Epoch 031 train loss 207.3933 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 032 train loss 207.1991 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 033 train loss 207.8855 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 034 train loss 206.9410 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0081
0.0054
0.0039
 0.0291
0.0434
0.0681
0.0921
 0.0218
0.0265
0.0336
0.0395
 0.0331
0.0359
0.038
0.0387

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.013
0.0094
0.0059
0.0041
 0.0564
0.0777
0.1137
0.1474
 0.04
0.0464
0.0556
0.0629
 0.0488
0.0516
0.0536
0.0543

Runing Epoch 035 train loss 207.2476 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 036 train loss 206.5519 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 037 train loss 208.1257 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 038 train loss 207.0399 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 039 train loss 207.7717 costs 00: 00: 38
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 020 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.006
0.0044
 0.0322
0.0485
0.0775
0.1083
 0.0239
0.0293
0.0375
0.0449
 0.0361
0.0392
0.0415
0.0424

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.0101
0.0064
0.0044
 0.0611
0.085
0.1268
0.1678
 0.0428
0.05
0.0605
0.0692
 0.0517
0.0547
0.057
0.0579

End time:  2023-06-24 02:11:25
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_021137-n6lnw0wg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_noisy_3_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/n6lnw0wg
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 5
wandb:         batch_loss_train 0.04047
wandb:         best_test MRR@10 0.0219
wandb:        best_test MRR@100 0.0263
wandb:         best_test MRR@20 0.024
wandb:         best_test MRR@50 0.0256
wandb:        best_test NDCG@10 0.0179
wandb:       best_test NDCG@100 0.0351
wandb:        best_test NDCG@20 0.0225
wandb:        best_test NDCG@50 0.0293
wandb:   best_test Precision@10 0.0069
wandb:  best_test Precision@100 0.0027
wandb:   best_test Precision@20 0.0055
wandb:   best_test Precision@50 0.0038
wandb:      best_test Recall@10 0.0284
wandb:     best_test Recall@100 0.0976
wandb:      best_test Recall@20 0.0433
wandb:      best_test Recall@50 0.0702
wandb:        best_valid MRR@10 0.0168
wandb:       best_valid MRR@100 0.0211
wandb:        best_valid MRR@20 0.0189
wandb:        best_valid MRR@50 0.0205
wandb:       best_valid NDCG@10 0.0112
wandb:      best_valid NDCG@100 0.0238
wandb:       best_valid NDCG@20 0.0143
wandb:       best_valid NDCG@50 0.0194
wandb:  best_valid Precision@10 0.0057
wandb: best_valid Precision@100 0.0027
wandb:  best_valid Precision@20 0.0048
wandb:  best_valid Precision@50 0.0036
wandb:     best_valid Recall@10 0.0164
wandb:    best_valid Recall@100 0.0642
wandb:     best_valid Recall@20 0.0265
wandb:     best_valid Recall@50 0.0452
wandb:    epoch_loss_norm_train 0.04064
wandb:              test MRR@10 0.0006
wandb:             test MRR@100 0.0007
wandb:              test MRR@20 0.0007
wandb:              test MRR@50 0.0007
wandb:             test NDCG@10 0.0004
wandb:            test NDCG@100 0.0007
wandb:             test NDCG@20 0.0004
wandb:             test NDCG@50 0.0005
wandb:        test Precision@10 0.0002
wandb:       test Precision@100 0.0001
wandb:        test Precision@20 0.0001
wandb:        test Precision@50 0.0001
wandb:           test Recall@10 0.0005
wandb:          test Recall@100 0.0018
wandb:           test Recall@20 0.0007
wandb:           test Recall@50 0.0011
wandb:             valid MRR@10 0.0007
wandb:            valid MRR@100 0.0009
wandb:             valid MRR@20 0.0008
wandb:             valid MRR@50 0.0009
wandb:            valid NDCG@10 0.0003
wandb:           valid NDCG@100 0.0006
wandb:            valid NDCG@20 0.0004
wandb:            valid NDCG@50 0.0005
wandb:       valid Precision@10 0.0002
wandb:      valid Precision@100 0.0001
wandb:       valid Precision@20 0.0002
wandb:       valid Precision@50 0.0001
wandb:          valid Recall@10 0.0003
wandb:         valid Recall@100 0.0015
wandb:          valid Recall@20 0.0005
wandb:          valid Recall@50 0.0009
wandb: 
wandb:  View run T-DiffRec_amazon-book_noisy_3_Reproduction at: https://wandb.ai/drs/drs/runs/n6lnw0wg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_021137-n6lnw0wg/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=3, steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 02:11:41
user num: 108822
item num: 178181
data ready.
Embedding size: 10
models ready.
Number of all parameters: 356552291
Start training...
Runing Epoch 001 train loss 12.5280 costs 00: 01: 05
------------------------------------------------------
Runing Epoch 002 train loss 11.9409 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 003 train loss 11.8733 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 004 train loss 11.6308 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0057
0.0048
0.0036
0.0027
 0.0164
0.0265
0.0452
0.0642
 0.0112
0.0143
0.0194
0.0238
 0.0168
0.0189
0.0205
0.0211

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0069
0.0055
0.0038
0.0027
 0.0284
0.0433
0.0702
0.0976
 0.0179
0.0225
0.0293
0.0351
 0.0219
0.024
0.0256
0.0263

Runing Epoch 005 train loss 11.5120 costs 00: 39: 02
------------------------------------------------------
Runing Epoch 006 train loss 11.4493 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 007 train loss 11.3948 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 008 train loss 11.3179 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 009 train loss 11.2759 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0052
0.0042
0.0029
0.0021
 0.0154
0.0226
0.0362
0.049
 0.0113
0.0135
0.0173
0.0204
 0.0173
0.0189
0.0201
0.0206

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0072
0.0053
0.0035
0.0024
 0.0295
0.0412
0.0627
0.0819
 0.0203
0.0239
0.0295
0.0337
 0.0254
0.0271
0.0285
0.0289

Runing Epoch 010 train loss 11.3669 costs 00: 38: 52
------------------------------------------------------
Runing Epoch 011 train loss 11.1707 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 012 train loss 11.1222 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 013 train loss 11.1233 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 014 train loss 11.4978 costs 00: 01: 05
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0011
0.0009
0.0006
0.0004
 0.0035
0.0049
0.007
0.0096
 0.0026
0.003
0.0036
0.0042
 0.0041
0.0044
0.0046
0.0047

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0016
0.0011
0.0007
0.0005
 0.0065
0.0087
0.0123
0.0162
 0.0047
0.0054
0.0063
0.0071
 0.0061
0.0064
0.0066
0.0068

Runing Epoch 015 train loss 10.9744 costs 00: 38: 50
------------------------------------------------------
Runing Epoch 016 train loss 10.9397 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 017 train loss 10.9767 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 018 train loss 10.9414 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 019 train loss 10.9189 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0002
0.0002
0.0001
0.0001
 0.0003
0.0005
0.0009
0.0015
 0.0003
0.0004
0.0005
0.0006
 0.0007
0.0008
0.0009
0.0009

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0002
0.0001
0.0001
0.0001
 0.0005
0.0007
0.0011
0.0018
 0.0004
0.0004
0.0005
0.0007
 0.0006
0.0007
0.0007
0.0007

Runing Epoch 020 train loss 10.9396 costs 00: 38: 52
------------------------------------------------------
Runing Epoch 021 train loss 11.0057 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 022 train loss 10.9966 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 023 train loss 10.9189 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 024 train loss 11.0934 costs 00: 01: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 005 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0057
0.0048
0.0036
0.0027
 0.0164
0.0265
0.0452
0.0642
 0.0112
0.0143
0.0194
0.0238
 0.0168
0.0189
0.0205
0.0211

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0069
0.0055
0.0038
0.0027
 0.0284
0.0433
0.0702
0.0976
 0.0179
0.0225
0.0293
0.0351
 0.0219
0.024
0.0256
0.0263

End time:  2023-06-24 05:08:25
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_050838-eeajgz4v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_clean_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/eeajgz4v
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.035 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.035 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 35
wandb:         batch_loss_train 0.93057
wandb:         best_test MRR@10 0.0524
wandb:        best_test MRR@100 0.0587
wandb:         best_test MRR@20 0.0555
wandb:         best_test MRR@50 0.0578
wandb:        best_test NDCG@10 0.0436
wandb:       best_test NDCG@100 0.0705
wandb:        best_test NDCG@20 0.051
wandb:        best_test NDCG@50 0.0618
wandb:   best_test Precision@10 0.0141
wandb:  best_test Precision@100 0.0045
wandb:   best_test Precision@20 0.0103
wandb:   best_test Precision@50 0.0066
wandb:      best_test Recall@10 0.0623
wandb:     best_test Recall@100 0.171
wandb:      best_test Recall@20 0.0867
wandb:      best_test Recall@50 0.1299
wandb:        best_valid MRR@10 0.0365
wandb:       best_valid MRR@100 0.0428
wandb:        best_valid MRR@20 0.0395
wandb:        best_valid MRR@50 0.0419
wandb:       best_valid NDCG@10 0.0243
wandb:      best_valid NDCG@100 0.0454
wandb:       best_valid NDCG@20 0.0296
wandb:       best_valid NDCG@50 0.0381
wandb:  best_valid Precision@10 0.0114
wandb: best_valid Precision@100 0.0045
wandb:  best_valid Precision@20 0.0089
wandb:  best_valid Precision@50 0.0061
wandb:     best_valid Recall@10 0.0329
wandb:    best_valid Recall@100 0.1097
wandb:     best_valid Recall@20 0.0492
wandb:     best_valid Recall@50 0.0792
wandb:    epoch_loss_norm_train 0.76019
wandb:              test MRR@10 0.0497
wandb:             test MRR@100 0.0551
wandb:              test MRR@20 0.0524
wandb:              test MRR@50 0.0543
wandb:             test NDCG@10 0.0411
wandb:            test NDCG@100 0.0634
wandb:             test NDCG@20 0.0474
wandb:             test NDCG@50 0.0563
wandb:        test Precision@10 0.0131
wandb:       test Precision@100 0.004
wandb:        test Precision@20 0.0094
wandb:        test Precision@50 0.0058
wandb:           test Recall@10 0.0582
wandb:          test Recall@100 0.1471
wandb:           test Recall@20 0.0794
wandb:           test Recall@50 0.1142
wandb:             valid MRR@10 0.0337
wandb:            valid MRR@100 0.0392
wandb:             valid MRR@20 0.0364
wandb:             valid MRR@50 0.0384
wandb:            valid NDCG@10 0.0223
wandb:           valid NDCG@100 0.04
wandb:            valid NDCG@20 0.0271
wandb:            valid NDCG@50 0.0341
wandb:       valid Precision@10 0.0103
wandb:      valid Precision@100 0.0038
wandb:       valid Precision@20 0.0081
wandb:       valid Precision@50 0.0054
wandb:          valid Recall@10 0.0299
wandb:         valid Recall@100 0.0933
wandb:          valid Recall@20 0.0447
wandb:          valid Recall@50 0.0691
wandb: 
wandb:  View run T-DiffRec_amazon-book_clean_4_Reproduction at: https://wandb.ai/drs/drs/runs/eeajgz4v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_050838-eeajgz4v/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=10, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 05:08:41
user num: 108822
item num: 94949
data ready.
Embedding size: 10
models ready.
Number of all parameters: 190004159
Start training...
Runing Epoch 001 train loss 247.2689 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 002 train loss 226.2578 costs 00: 00: 41
------------------------------------------------------
Runing Epoch 003 train loss 222.6617 costs 00: 00: 41
------------------------------------------------------
Runing Epoch 004 train loss 219.2881 costs 00: 00: 41
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0082
0.0067
0.0048
0.0036
 0.0218
0.0344
0.0586
0.0853
 0.0164
0.0205
0.0274
0.0338
 0.0261
0.0286
0.0306
0.0315

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0092
0.0071
0.0047
0.0035
 0.0385
0.0568
0.0903
0.1259
 0.0265
0.032
0.0404
0.048
 0.033
0.0355
0.0374
0.0382

Runing Epoch 005 train loss 218.3112 costs 00: 03: 47
------------------------------------------------------
Runing Epoch 006 train loss 216.9723 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 007 train loss 214.8423 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 008 train loss 213.9787 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 009 train loss 213.1566 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0088
0.007
0.0048
0.0035
 0.0248
0.0373
0.0606
0.0843
 0.0188
0.0229
0.0295
0.0353
 0.029
0.0314
0.0334
0.0341

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.011
0.0081
0.0052
0.0036
 0.0477
0.0672
0.1004
0.1326
 0.0337
0.0395
0.048
0.0548
 0.0413
0.0438
0.0457
0.0464

Runing Epoch 010 train loss 211.3358 costs 00: 03: 43
------------------------------------------------------
Runing Epoch 011 train loss 210.2357 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 012 train loss 209.8896 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 013 train loss 209.8620 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 014 train loss 209.3261 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0089
0.0068
0.0045
0.0031
 0.025
0.0361
0.0553
0.0734
 0.0189
0.0225
0.028
0.0325
 0.0289
0.0311
0.0327
0.0333

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0113
0.0081
0.0049
0.0033
 0.0487
0.066
0.0939
0.1186
 0.0347
0.04
0.0471
0.0525
 0.0427
0.045
0.0465
0.0471

Runing Epoch 015 train loss 208.9806 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 016 train loss 208.9474 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 017 train loss 208.6579 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 018 train loss 209.0696 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 019 train loss 207.7299 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0086
0.0068
0.0047
0.0034
 0.0238
0.036
0.0583
0.0807
 0.0181
0.0221
0.0284
0.0339
 0.0279
0.0303
0.0322
0.033

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0081
0.0052
0.0036
 0.0481
0.0662
0.098
0.1295
 0.0343
0.0398
0.0479
0.0546
 0.0422
0.0446
0.0464
0.0471

Runing Epoch 020 train loss 207.0877 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 021 train loss 207.2807 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 022 train loss 208.3824 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 023 train loss 207.3528 costs 00: 00: 39
------------------------------------------------------
Runing Epoch 024 train loss 208.2254 costs 00: 00: 42
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0101
0.0077
0.0051
0.0036
 0.0286
0.0419
0.0643
0.0838
 0.0216
0.0259
0.0323
0.0372
 0.0332
0.0357
0.0376
0.0382

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0128
0.0091
0.0056
0.0037
 0.0554
0.075
0.107
0.1352
 0.0397
0.0456
0.0538
0.0599
 0.0486
0.0511
0.0529
0.0535

Runing Epoch 025 train loss 207.5140 costs 00: 03: 49
------------------------------------------------------
Runing Epoch 026 train loss 207.1583 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 027 train loss 207.6150 costs 00: 00: 41
------------------------------------------------------
Runing Epoch 028 train loss 207.9691 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 029 train loss 208.1142 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0079
0.0054
0.0039
 0.0295
0.0432
0.0684
0.0932
 0.0222
0.0267
0.0338
0.0399
 0.0337
0.0363
0.0383
0.0391

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0128
0.0092
0.0058
0.004
 0.0565
0.0767
0.1137
0.1478
 0.0403
0.0464
0.0558
0.0631
 0.0489
0.0516
0.0536
0.0543

Runing Epoch 030 train loss 207.4344 costs 00: 03: 45
------------------------------------------------------
Runing Epoch 031 train loss 207.7445 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 032 train loss 207.1478 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 033 train loss 207.1782 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 034 train loss 207.7284 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0114
0.0089
0.0061
0.0045
 0.0329
0.0492
0.0792
0.1097
 0.0243
0.0296
0.0381
0.0454
 0.0365
0.0395
0.0419
0.0428

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0141
0.0103
0.0066
0.0045
 0.0623
0.0867
0.1299
0.171
 0.0436
0.051
0.0618
0.0705
 0.0524
0.0555
0.0578
0.0587

Runing Epoch 035 train loss 207.3435 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 036 train loss 207.7154 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 037 train loss 207.4147 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 038 train loss 207.4770 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 039 train loss 206.7928 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0092
0.007
0.0045
0.0031
 0.0262
0.0376
0.0565
0.0739
 0.0199
0.0237
0.0291
0.0334
 0.0307
0.0329
0.0345
0.0351

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0118
0.0083
0.005
0.0033
 0.0517
0.0691
0.0964
0.1211
 0.0374
0.0426
0.0497
0.0551
 0.0459
0.0482
0.0498
0.0503

Runing Epoch 040 train loss 208.2284 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 041 train loss 207.5769 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 042 train loss 207.8064 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 043 train loss 207.2367 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 044 train loss 208.2732 costs 00: 00: 42
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.0061
0.0044
 0.0326
0.0489
0.0788
0.1097
 0.0241
0.0295
0.0379
0.0454
 0.0363
0.0393
0.0417
0.0426

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.014
0.0101
0.0065
0.0045
 0.062
0.0857
0.1282
0.1705
 0.0433
0.0505
0.0611
0.0701
 0.0522
0.0552
0.0575
0.0584

Runing Epoch 045 train loss 207.8138 costs 00: 03: 45
------------------------------------------------------
Runing Epoch 046 train loss 207.8473 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 047 train loss 207.6862 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 048 train loss 207.4923 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 049 train loss 207.2696 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0103
0.0081
0.0054
0.0038
 0.0299
0.0447
0.0691
0.0933
 0.0223
0.0271
0.0341
0.04
 0.0337
0.0364
0.0384
0.0392

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0131
0.0094
0.0058
0.004
 0.0582
0.0794
0.1142
0.1471
 0.0411
0.0474
0.0563
0.0634
 0.0497
0.0524
0.0543
0.0551

Runing Epoch 050 train loss 207.7470 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 051 train loss 207.2295 costs 00: 00: 40
------------------------------------------------------
Runing Epoch 052 train loss 207.6962 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 053 train loss 207.0211 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 054 train loss 207.5315 costs 00: 00: 37
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 035 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0114
0.0089
0.0061
0.0045
 0.0329
0.0492
0.0792
0.1097
 0.0243
0.0296
0.0381
0.0454
 0.0365
0.0395
0.0419
0.0428

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0141
0.0103
0.0066
0.0045
 0.0623
0.0867
0.1299
0.171
 0.0436
0.051
0.0618
0.0705
 0.0524
0.0555
0.0578
0.0587

End time:  2023-06-24 06:15:16
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_061528-zky372uh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_noisy_4_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/zky372uh
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 25
wandb:         batch_loss_train 0.02958
wandb:         best_test MRR@10 0.0321
wandb:        best_test MRR@100 0.0366
wandb:         best_test MRR@20 0.0344
wandb:         best_test MRR@50 0.036
wandb:        best_test NDCG@10 0.0263
wandb:       best_test NDCG@100 0.044
wandb:        best_test NDCG@20 0.0314
wandb:        best_test NDCG@50 0.0385
wandb:   best_test Precision@10 0.009
wandb:  best_test Precision@100 0.003
wandb:   best_test Precision@20 0.0068
wandb:   best_test Precision@50 0.0044
wandb:      best_test Recall@10 0.0388
wandb:     best_test Recall@100 0.1082
wandb:      best_test Recall@20 0.0553
wandb:      best_test Recall@50 0.083
wandb:        best_valid MRR@10 0.0207
wandb:       best_valid MRR@100 0.0248
wandb:        best_valid MRR@20 0.0227
wandb:        best_valid MRR@50 0.0242
wandb:       best_valid NDCG@10 0.0139
wandb:      best_valid NDCG@100 0.0259
wandb:       best_valid NDCG@20 0.017
wandb:       best_valid NDCG@50 0.0218
wandb:  best_valid Precision@10 0.0064
wandb: best_valid Precision@100 0.0027
wandb:  best_valid Precision@20 0.0052
wandb:  best_valid Precision@50 0.0036
wandb:     best_valid Recall@10 0.0196
wandb:    best_valid Recall@100 0.0644
wandb:     best_valid Recall@20 0.0297
wandb:     best_valid Recall@50 0.0472
wandb:    epoch_loss_norm_train 0.03952
wandb:              test MRR@10 0.027
wandb:             test MRR@100 0.0301
wandb:              test MRR@20 0.0286
wandb:              test MRR@50 0.0297
wandb:             test NDCG@10 0.0219
wandb:            test NDCG@100 0.0336
wandb:             test NDCG@20 0.0254
wandb:             test NDCG@50 0.0301
wandb:        test Precision@10 0.0073
wandb:       test Precision@100 0.0022
wandb:        test Precision@20 0.0053
wandb:        test Precision@50 0.0032
wandb:           test Recall@10 0.0313
wandb:          test Recall@100 0.0769
wandb:           test Recall@20 0.0429
wandb:           test Recall@50 0.061
wandb:             valid MRR@10 0.017
wandb:            valid MRR@100 0.0197
wandb:             valid MRR@20 0.0184
wandb:             valid MRR@50 0.0194
wandb:            valid NDCG@10 0.0114
wandb:           valid NDCG@100 0.019
wandb:            valid NDCG@20 0.0135
wandb:            valid NDCG@50 0.0166
wandb:       valid Precision@10 0.0051
wandb:      valid Precision@100 0.0018
wandb:       valid Precision@20 0.0039
wandb:       valid Precision@50 0.0026
wandb:          valid Recall@10 0.0159
wandb:         valid Recall@100 0.0442
wandb:          valid Recall@20 0.0228
wandb:          valid Recall@50 0.0341
wandb: 
wandb:  View run T-DiffRec_amazon-book_noisy_4_Reproduction at: https://wandb.ai/drs/drs/runs/zky372uh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_061528-zky372uh/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=4, steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 06:15:32
user num: 108822
item num: 178181
data ready.
Embedding size: 10
models ready.
Number of all parameters: 356552291
Start training...
Runing Epoch 001 train loss 12.5513 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 002 train loss 11.9887 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 003 train loss 11.9675 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 004 train loss 11.8977 costs 00: 01: 02
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0047
0.004
0.0029
0.0022
 0.0133
0.0213
0.0365
0.0519
 0.0093
0.0117
0.0159
0.0195
 0.0143
0.016
0.0173
0.0178

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0055
0.0044
0.0031
0.0022
 0.0225
0.0345
0.0568
0.0787
 0.0141
0.0177
0.0234
0.0281
 0.0172
0.019
0.0203
0.0209

Runing Epoch 005 train loss 11.9109 costs 00: 38: 57
------------------------------------------------------
Runing Epoch 006 train loss 11.4065 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 007 train loss 11.4171 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 008 train loss 11.3177 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 009 train loss 11.2890 costs 00: 01: 02
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0002
0.0002
0.0001
0.0001
 0.0004
0.0006
0.001
0.0017
 0.0004
0.0005
0.0006
0.0007
 0.0009
0.0009
0.001
0.001

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0002
0.0001
0.0001
0.0001
 0.0006
0.0009
0.0014
0.0021
 0.0004
0.0005
0.0006
0.0008
 0.0006
0.0007
0.0007
0.0008

Runing Epoch 010 train loss 11.1952 costs 00: 38: 47
------------------------------------------------------
Runing Epoch 011 train loss 11.1825 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 012 train loss 11.1344 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 013 train loss 11.0795 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 014 train loss 11.0963 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0054
0.0043
0.003
0.0021
 0.0166
0.0251
0.0402
0.0544
 0.0115
0.0141
0.0182
0.0215
 0.0168
0.0184
0.0197
0.0202

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0076
0.0056
0.0036
0.0024
 0.0328
0.0465
0.0691
0.0908
 0.0218
0.0259
0.0316
0.0362
 0.0261
0.0279
0.0292
0.0297

Runing Epoch 015 train loss 11.1640 costs 00: 38: 53
------------------------------------------------------
Runing Epoch 016 train loss 10.9902 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 017 train loss 10.9943 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 018 train loss 10.9640 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 019 train loss 11.0156 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0006
0.0005
0.0003
0.0002
 0.0017
0.0023
0.0034
0.0047
 0.0013
0.0014
0.0017
0.002
 0.0022
0.0024
0.0025
0.0026

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0007
0.0005
0.0003
0.0002
 0.0029
0.0039
0.0057
0.0078
 0.0021
0.0024
0.0028
0.0033
 0.0027
0.0029
0.003
0.0031

Runing Epoch 020 train loss 10.9601 costs 00: 38: 52
------------------------------------------------------
Runing Epoch 021 train loss 10.9752 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 022 train loss 10.9495 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 023 train loss 11.0834 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 024 train loss 10.9491 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0064
0.0052
0.0036
0.0027
 0.0196
0.0297
0.0472
0.0644
 0.0139
0.017
0.0218
0.0259
 0.0207
0.0227
0.0242
0.0248

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.009
0.0068
0.0044
0.003
 0.0388
0.0553
0.083
0.1082
 0.0263
0.0314
0.0385
0.044
 0.0321
0.0344
0.036
0.0366

Runing Epoch 025 train loss 10.9597 costs 00: 38: 57
------------------------------------------------------
Runing Epoch 026 train loss 10.9196 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 027 train loss 10.9591 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 028 train loss 10.8998 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 029 train loss 10.9550 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0007
0.0006
0.0004
0.0003
 0.0018
0.0029
0.0045
0.0065
 0.0014
0.0016
0.0021
0.0025
 0.0023
0.0025
0.0027
0.0028

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0009
0.0007
0.0004
0.0003
 0.0037
0.0052
0.0079
0.0106
 0.0025
0.0029
0.0036
0.0042
 0.003
0.0033
0.0035
0.0036

Runing Epoch 030 train loss 11.0034 costs 00: 38: 54
------------------------------------------------------
Runing Epoch 031 train loss 10.9981 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 032 train loss 10.9913 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 033 train loss 11.1608 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 034 train loss 10.9590 costs 00: 01: 00
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0018
0.0014
0.0009
0.0006
 0.0054
0.0077
0.0111
0.0141
 0.004
0.0047
0.0056
0.0063
 0.0061
0.0066
0.0069
0.0071

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0026
0.0019
0.0011
0.0007
 0.0115
0.0156
0.0211
0.0259
 0.0079
0.0091
0.0105
0.0116
 0.0097
0.0102
0.0106
0.0108

Runing Epoch 035 train loss 10.9380 costs 00: 38: 50
------------------------------------------------------
Runing Epoch 036 train loss 11.2245 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 037 train loss 13.5151 costs 00: 01: 02
------------------------------------------------------
Runing Epoch 038 train loss 10.8736 costs 00: 01: 05
------------------------------------------------------
Runing Epoch 039 train loss 10.8316 costs 00: 01: 04
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0051
0.0039
0.0026
0.0018
 0.0159
0.0228
0.0341
0.0442
 0.0114
0.0135
0.0166
0.019
 0.017
0.0184
0.0194
0.0197

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0073
0.0053
0.0032
0.0022
 0.0313
0.0429
0.061
0.0769
 0.0219
0.0254
0.0301
0.0336
 0.027
0.0286
0.0297
0.0301

Runing Epoch 040 train loss 10.8312 costs 00: 38: 54
------------------------------------------------------
Runing Epoch 041 train loss 10.8132 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 042 train loss 10.8298 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 043 train loss 10.8213 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 044 train loss 10.7878 costs 00: 01: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 025 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0064
0.0052
0.0036
0.0027
 0.0196
0.0297
0.0472
0.0644
 0.0139
0.017
0.0218
0.0259
 0.0207
0.0227
0.0242
0.0248

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.009
0.0068
0.0044
0.003
 0.0388
0.0553
0.083
0.1082
 0.0263
0.0314
0.0385
0.044
 0.0321
0.0344
0.036
0.0366

End time:  2023-06-24 12:04:14
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_120427-qx33ley3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_clean_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/qx33ley3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run summary:
wandb:                    Epoch 45
wandb:         batch_loss_train 0.56608
wandb:         best_test MRR@10 0.0526
wandb:        best_test MRR@100 0.0589
wandb:         best_test MRR@20 0.0557
wandb:         best_test MRR@50 0.058
wandb:        best_test NDCG@10 0.0437
wandb:       best_test NDCG@100 0.071
wandb:        best_test NDCG@20 0.0511
wandb:        best_test NDCG@50 0.0621
wandb:   best_test Precision@10 0.0142
wandb:  best_test Precision@100 0.0046
wandb:   best_test Precision@20 0.0104
wandb:   best_test Precision@50 0.0066
wandb:      best_test Recall@10 0.0628
wandb:     best_test Recall@100 0.1733
wandb:      best_test Recall@20 0.0874
wandb:      best_test Recall@50 0.131
wandb:        best_valid MRR@10 0.0365
wandb:       best_valid MRR@100 0.043
wandb:        best_valid MRR@20 0.0396
wandb:        best_valid MRR@50 0.0421
wandb:       best_valid NDCG@10 0.0242
wandb:      best_valid NDCG@100 0.046
wandb:       best_valid NDCG@20 0.0297
wandb:       best_valid NDCG@50 0.0383
wandb:  best_valid Precision@10 0.0113
wandb: best_valid Precision@100 0.0045
wandb:  best_valid Precision@20 0.0089
wandb:  best_valid Precision@50 0.0062
wandb:     best_valid Recall@10 0.0327
wandb:    best_valid Recall@100 0.112
wandb:     best_valid Recall@20 0.0495
wandb:     best_valid Recall@50 0.0801
wandb:    epoch_loss_norm_train 0.75989
wandb:              test MRR@10 0.0526
wandb:             test MRR@100 0.0589
wandb:              test MRR@20 0.0556
wandb:              test MRR@50 0.058
wandb:             test NDCG@10 0.0434
wandb:            test NDCG@100 0.0704
wandb:             test NDCG@20 0.0506
wandb:             test NDCG@50 0.0614
wandb:        test Precision@10 0.0141
wandb:       test Precision@100 0.0046
wandb:        test Precision@20 0.0103
wandb:        test Precision@50 0.0066
wandb:           test Recall@10 0.0619
wandb:          test Recall@100 0.1709
wandb:           test Recall@20 0.086
wandb:           test Recall@50 0.1284
wandb:             valid MRR@10 0.0368
wandb:            valid MRR@100 0.0433
wandb:             valid MRR@20 0.0399
wandb:             valid MRR@50 0.0423
wandb:            valid NDCG@10 0.0243
wandb:           valid NDCG@100 0.0458
wandb:            valid NDCG@20 0.0298
wandb:            valid NDCG@50 0.0383
wandb:       valid Precision@10 0.0114
wandb:      valid Precision@100 0.0045
wandb:       valid Precision@20 0.009
wandb:       valid Precision@50 0.0062
wandb:          valid Recall@10 0.0326
wandb:         valid Recall@100 0.1106
wandb:          valid Recall@20 0.0494
wandb:          valid Recall@50 0.0794
wandb: 
wandb:  View run T-DiffRec_amazon-book_clean_5_Reproduction at: https://wandb.ai/drs/drs/runs/qx33ley3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_120427-qx33ley3/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=10, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 12:04:31
user num: 108822
item num: 94949
data ready.
Embedding size: 10
models ready.
Number of all parameters: 190004159
Start training...
Runing Epoch 001 train loss 247.4159 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 002 train loss 226.7600 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 003 train loss 223.4217 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 004 train loss 220.6301 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.008
0.0066
0.0047
0.0035
 0.0212
0.0337
0.057
0.0829
 0.0156
0.0197
0.0263
0.0325
 0.0244
0.0268
0.0288
0.0297

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.009
0.0069
0.0046
0.0034
 0.0372
0.0543
0.0869
0.1227
 0.0248
0.03
0.0382
0.0457
 0.0305
0.0328
0.0347
0.0356

Runing Epoch 005 train loss 218.4864 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 006 train loss 216.3955 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 007 train loss 215.0680 costs 00: 00: 39
------------------------------------------------------
Runing Epoch 008 train loss 213.5888 costs 00: 00: 39
------------------------------------------------------
Runing Epoch 009 train loss 214.3452 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0077
0.0059
0.004
0.0028
 0.0214
0.031
0.0487
0.0659
 0.0162
0.0193
0.0243
0.0286
 0.025
0.027
0.0285
0.029

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0096
0.007
0.0044
0.003
 0.0409
0.0567
0.0823
0.1059
 0.0291
0.0338
0.0403
0.0455
 0.0359
0.038
0.0395
0.04

Runing Epoch 010 train loss 211.8528 costs 00: 03: 40
------------------------------------------------------
Runing Epoch 011 train loss 210.6032 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 012 train loss 210.1653 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 013 train loss 209.1671 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 014 train loss 209.6405 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0099
0.0077
0.0052
0.0037
 0.0277
0.0412
0.0644
0.0866
 0.021
0.0255
0.0321
0.0376
 0.0324
0.035
0.0369
0.0377

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0124
0.009
0.0056
0.0038
 0.0538
0.0739
0.1071
0.1388
 0.0382
0.0444
0.0528
0.0596
 0.047
0.0496
0.0515
0.0522

Runing Epoch 015 train loss 208.7526 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 016 train loss 208.7014 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 017 train loss 207.5963 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 018 train loss 208.8176 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 019 train loss 208.3022 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0096
0.0073
0.0049
0.0034
 0.0277
0.0402
0.0616
0.0824
 0.0208
0.0249
0.031
0.0362
 0.0318
0.0342
0.036
0.0367

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0121
0.0086
0.0053
0.0036
 0.0538
0.0724
0.1047
0.1339
 0.0384
0.0441
0.0523
0.0586
 0.0468
0.0492
0.051
0.0517

Runing Epoch 020 train loss 208.0444 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 021 train loss 208.7485 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 022 train loss 207.4392 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 023 train loss 208.2265 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 024 train loss 207.3332 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0109
0.0086
0.0059
0.0043
 0.0312
0.047
0.0748
0.1027
 0.0233
0.0285
0.0364
0.0432
 0.0352
0.0382
0.0404
0.0413

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.01
0.0063
0.0044
 0.0603
0.0831
0.1229
0.1622
 0.0425
0.0494
0.0595
0.0678
 0.0516
0.0545
0.0567
0.0576

Runing Epoch 025 train loss 207.7425 costs 00: 03: 45
------------------------------------------------------
Runing Epoch 026 train loss 207.3743 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 027 train loss 207.9035 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 028 train loss 206.9076 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 029 train loss 208.2541 costs 00: 00: 42
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0095
0.0073
0.0049
0.0035
 0.0271
0.0395
0.0621
0.084
 0.0206
0.0246
0.031
0.0364
 0.0316
0.034
0.0359
0.0366

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0122
0.0087
0.0054
0.0037
 0.0529
0.0719
0.1043
0.134
 0.0379
0.0436
0.0519
0.0583
 0.0466
0.049
0.0509
0.0516

Runing Epoch 030 train loss 207.5604 costs 00: 03: 44
------------------------------------------------------
Runing Epoch 031 train loss 206.7202 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 032 train loss 207.7543 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 033 train loss 208.0871 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 034 train loss 207.4999 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0093
0.0072
0.0048
0.0034
 0.0267
0.0392
0.0612
0.0827
 0.0201
0.0242
0.0305
0.0357
 0.0308
0.0332
0.035
0.0357

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0117
0.0084
0.0052
0.0035
 0.0513
0.0699
0.102
0.1313
 0.0366
0.0423
0.0504
0.0567
 0.0447
0.0472
0.049
0.0496

Runing Epoch 035 train loss 207.6859 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 036 train loss 207.1498 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 037 train loss 207.5650 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 038 train loss 207.0450 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 039 train loss 207.2763 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0088
0.0061
0.0044
 0.0321
0.0486
0.0781
0.1086
 0.0239
0.0293
0.0376
0.045
 0.0362
0.0392
0.0416
0.0425

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0139
0.0101
0.0064
0.0045
 0.0606
0.0847
0.1268
0.1688
 0.0427
0.0499
0.0605
0.0694
 0.0519
0.0549
0.0572
0.0581

Runing Epoch 040 train loss 207.1860 costs 00: 03: 45
------------------------------------------------------
Runing Epoch 041 train loss 207.5296 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 042 train loss 207.8801 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 043 train loss 207.5410 costs 00: 00: 42
------------------------------------------------------
Runing Epoch 044 train loss 207.5970 costs 00: 00: 42
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0113
0.0089
0.0062
0.0045
 0.0327
0.0495
0.0801
0.112
 0.0242
0.0297
0.0383
0.046
 0.0365
0.0396
0.0421
0.043

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0142
0.0104
0.0066
0.0046
 0.0628
0.0874
0.131
0.1733
 0.0437
0.0511
0.0621
0.071
 0.0526
0.0557
0.058
0.0589

Runing Epoch 045 train loss 207.3775 costs 00: 03: 50
------------------------------------------------------
Runing Epoch 046 train loss 207.3393 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 047 train loss 207.5990 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 048 train loss 207.5087 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 049 train loss 207.4621 costs 00: 00: 37
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.011
0.0087
0.0059
0.0043
 0.0318
0.0473
0.0759
0.1039
 0.0236
0.0287
0.0368
0.0437
 0.0355
0.0384
0.0407
0.0416

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0138
0.01
0.0064
0.0044
 0.0604
0.0836
0.1246
0.1643
 0.0422
0.0493
0.0596
0.0681
 0.051
0.054
0.0563
0.0571

Runing Epoch 050 train loss 207.5216 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 051 train loss 207.3065 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 052 train loss 207.5160 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 053 train loss 207.7678 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 054 train loss 207.4889 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0112
0.0089
0.0061
0.0045
 0.0323
0.0486
0.0784
0.1092
 0.0241
0.0295
0.0379
0.0454
 0.0364
0.0395
0.0419
0.0428

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0139
0.0102
0.0065
0.0046
 0.0613
0.0852
0.128
0.1711
 0.0433
0.0505
0.0613
0.0704
 0.0524
0.0554
0.0578
0.0587

Runing Epoch 055 train loss 207.9183 costs 00: 03: 42
------------------------------------------------------
Runing Epoch 056 train loss 207.7414 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 057 train loss 207.6865 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 058 train loss 207.6572 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 059 train loss 207.3675 costs 00: 00: 38
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0114
0.009
0.0062
0.0045
 0.0326
0.0494
0.0794
0.1106
 0.0243
0.0298
0.0383
0.0458
 0.0368
0.0399
0.0423
0.0433

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0141
0.0103
0.0066
0.0046
 0.0619
0.086
0.1284
0.1709
 0.0434
0.0506
0.0614
0.0704
 0.0526
0.0556
0.058
0.0589

Runing Epoch 060 train loss 207.6432 costs 00: 03: 41
------------------------------------------------------
Runing Epoch 061 train loss 208.0822 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 062 train loss 207.6928 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 063 train loss 208.3451 costs 00: 00: 38
------------------------------------------------------
Runing Epoch 064 train loss 207.4500 costs 00: 00: 37
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 045 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0113
0.0089
0.0062
0.0045
 0.0327
0.0495
0.0801
0.112
 0.0242
0.0297
0.0383
0.046
 0.0365
0.0396
0.0421
0.043

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0142
0.0104
0.0066
0.0046
 0.0628
0.0874
0.131
0.1733
 0.0437
0.0511
0.0621
0.071
 0.0526
0.0557
0.058
0.0589

End time:  2023-06-24 13:23:11
wandb: Currently logged in as: piconda (drs). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/lcur2420/RS/wandb/run-20230624_132326-4ivhyuvd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T-DiffRec_amazon-book_noisy_5_Reproduction
wandb:  View project at https://wandb.ai/drs/drs
wandb:  View run at https://wandb.ai/drs/drs/runs/4ivhyuvd
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                    Epoch 10
wandb:         batch_loss_train 0.03445
wandb:         best_test MRR@10 0.0299
wandb:        best_test MRR@100 0.0348
wandb:         best_test MRR@20 0.0323
wandb:         best_test MRR@50 0.0341
wandb:        best_test NDCG@10 0.0246
wandb:       best_test NDCG@100 0.0439
wandb:        best_test NDCG@20 0.0299
wandb:        best_test NDCG@50 0.0376
wandb:   best_test Precision@10 0.0089
wandb:  best_test Precision@100 0.0032
wandb:   best_test Precision@20 0.0069
wandb:   best_test Precision@50 0.0045
wandb:      best_test Recall@10 0.0371
wandb:     best_test Recall@100 0.1134
wandb:      best_test Recall@20 0.0546
wandb:      best_test Recall@50 0.0848
wandb:        best_valid MRR@10 0.0202
wandb:       best_valid MRR@100 0.0247
wandb:        best_valid MRR@20 0.0223
wandb:        best_valid MRR@50 0.024
wandb:       best_valid NDCG@10 0.0136
wandb:      best_valid NDCG@100 0.0271
wandb:       best_valid NDCG@20 0.0169
wandb:       best_valid NDCG@50 0.0223
wandb:  best_valid Precision@10 0.0066
wandb: best_valid Precision@100 0.003
wandb:  best_valid Precision@20 0.0054
wandb:  best_valid Precision@50 0.0039
wandb:     best_valid Recall@10 0.0195
wandb:    best_valid Recall@100 0.0699
wandb:     best_valid Recall@20 0.03
wandb:     best_valid Recall@50 0.0498
wandb:    epoch_loss_norm_train 0.04097
wandb:              test MRR@10 0.0308
wandb:             test MRR@100 0.0347
wandb:              test MRR@20 0.0327
wandb:              test MRR@50 0.0342
wandb:             test NDCG@10 0.0254
wandb:            test NDCG@100 0.0406
wandb:             test NDCG@20 0.0299
wandb:             test NDCG@50 0.0359
wandb:        test Precision@10 0.0086
wandb:       test Precision@100 0.0027
wandb:        test Precision@20 0.0063
wandb:        test Precision@50 0.004
wandb:           test Recall@10 0.0376
wandb:          test Recall@100 0.0971
wandb:           test Recall@20 0.0522
wandb:           test Recall@50 0.0756
wandb:             valid MRR@10 0.0196
wandb:            valid MRR@100 0.0233
wandb:             valid MRR@20 0.0214
wandb:             valid MRR@50 0.0228
wandb:            valid NDCG@10 0.013
wandb:           valid NDCG@100 0.0236
wandb:            valid NDCG@20 0.016
wandb:            valid NDCG@50 0.0202
wandb:       valid Precision@10 0.006
wandb:      valid Precision@100 0.0024
wandb:       valid Precision@20 0.0048
wandb:       valid Precision@50 0.0033
wandb:          valid Recall@10 0.0183
wandb:         valid Recall@100 0.0575
wandb:          valid Recall@20 0.0279
wandb:          valid Recall@50 0.0434
wandb: 
wandb:  View run T-DiffRec_amazon-book_noisy_5_Reproduction at: https://wandb.ai/drs/drs/runs/4ivhyuvd
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230624_132326-4ivhyuvd/logs
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, patience=20, reweight=True, round=1, run_name='Reproduction', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=5, steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-24 13:23:30
user num: 108822
item num: 178181
data ready.
Embedding size: 10
models ready.
Number of all parameters: 356552291
Start training...
Runing Epoch 001 train loss 12.4703 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 002 train loss 11.9921 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 003 train loss 11.7925 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 004 train loss 11.7782 costs 00: 01: 03
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0056
0.0048
0.0036
0.0027
 0.0153
0.0245
0.0438
0.0638
 0.011
0.0139
0.0191
0.0238
 0.0173
0.0193
0.0209
0.0216

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0067
0.0054
0.0038
0.0028
 0.0267
0.0412
0.0689
0.0975
 0.0175
0.0219
0.0289
0.035
 0.0218
0.0238
0.0255
0.0262

Runing Epoch 005 train loss 11.6017 costs 00: 39: 01
------------------------------------------------------
Runing Epoch 006 train loss 11.4762 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 007 train loss 11.3729 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 008 train loss 11.2953 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 009 train loss 11.3280 costs 00: 01: 04
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0066
0.0054
0.0039
0.003
 0.0195
0.03
0.0498
0.0699
 0.0136
0.0169
0.0223
0.0271
 0.0202
0.0223
0.024
0.0247

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0089
0.0069
0.0045
0.0032
 0.0371
0.0546
0.0848
0.1134
 0.0246
0.0299
0.0376
0.0439
 0.0299
0.0323
0.0341
0.0348

Runing Epoch 010 train loss 11.2469 costs 00: 38: 57
------------------------------------------------------
Runing Epoch 011 train loss 11.1073 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 012 train loss 11.1028 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 013 train loss 11.1084 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 014 train loss 11.0013 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.004
0.0031
0.0021
0.0014
 0.0117
0.0169
0.0258
0.0335
 0.0084
0.0099
0.0124
0.0142
 0.0128
0.0139
0.0148
0.0151

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0057
0.0042
0.0025
0.0017
 0.0241
0.0333
0.0466
0.0582
 0.0162
0.0191
0.0225
0.0251
 0.0199
0.0212
0.022
0.0224

Runing Epoch 015 train loss 11.0818 costs 00: 38: 52
------------------------------------------------------
Runing Epoch 016 train loss 10.9404 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 017 train loss 10.9585 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 018 train loss 11.0132 costs 00: 01: 04
------------------------------------------------------
Runing Epoch 019 train loss 10.9787 costs 00: 01: 01
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0044
0.0035
0.0023
0.0016
 0.0135
0.0201
0.0312
0.0411
 0.0096
0.0115
0.0145
0.0169
 0.0142
0.0155
0.0165
0.0169

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0062
0.0046
0.0028
0.0019
 0.0271
0.038
0.0552
0.0705
 0.0183
0.0217
0.0261
0.0294
 0.0222
0.0237
0.0247
0.0251

Runing Epoch 020 train loss 10.9927 costs 00: 38: 51
------------------------------------------------------
Runing Epoch 021 train loss 11.0038 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 022 train loss 10.9873 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 023 train loss 10.9936 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 024 train loss 11.0760 costs 00: 01: 03
------------------------------------------------------
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.006
0.0048
0.0033
0.0024
 0.0183
0.0279
0.0434
0.0575
 0.013
0.016
0.0202
0.0236
 0.0196
0.0214
0.0228
0.0233

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0086
0.0063
0.004
0.0027
 0.0376
0.0522
0.0756
0.0971
 0.0254
0.0299
0.0359
0.0406
 0.0308
0.0327
0.0342
0.0347

Runing Epoch 025 train loss 11.0152 costs 00: 38: 50
------------------------------------------------------
Runing Epoch 026 train loss 10.9415 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 027 train loss 10.8945 costs 00: 01: 03
------------------------------------------------------
Runing Epoch 028 train loss 10.9522 costs 00: 01: 01
------------------------------------------------------
Runing Epoch 029 train loss 11.1839 costs 00: 01: 00
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 010 
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0066
0.0054
0.0039
0.003
 0.0195
0.03
0.0498
0.0699
 0.0136
0.0169
0.0223
0.0271
 0.0202
0.0223
0.024
0.0247

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0089
0.0069
0.0045
0.0032
 0.0371
0.0546
0.0848
0.1134
 0.0246
0.0299
0.0376
0.0439
 0.0299
0.0323
0.0341
0.0348

End time:  2023-06-24 17:03:29
