args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, w_max=1.0, w_min=0.1, weight_decay=0.0)
Starting time:  2023-06-13 11:34:34
user num: 108822
item num: 178181
data ready.
models ready.
Number of all parameters: 356551291
Start training...
Runing Epoch 001 train loss 12.4881 costs 00: 01: 00
------------------------------------------------------
Runing Epoch 002 train loss 12.0723 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 003 train loss 11.8145 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 004 train loss 11.7534 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0019
0.0014
0.0009
0.0007 
Recall:
 0.0053
0.0073
0.0106
0.014 
NDCG:
 0.004
0.0046
0.0055
0.0063 
MRR:
 0.0066
0.0071
0.0074
0.0075
[Test]:  
Precision:
 0.0024
0.0017
0.001
0.0007 
Recall:
 0.0091
0.0124
0.0174
0.0222 
NDCG:
 0.0065
0.0075
0.0088
0.0099 
MRR:
0.0088
0.0093
0.0096
0.0098
Runing Epoch 005 train loss 11.6246 costs 00: 38: 37
------------------------------------------------------
Runing Epoch 006 train loss 11.4054 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 007 train loss 11.3353 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 008 train loss 11.2601 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 009 train loss 11.3111 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0008
0.0007
0.0005
0.0004 
Recall:
 0.0022
0.0036
0.006
0.0081 
NDCG:
 0.0016
0.002
0.0026
0.0031 
MRR:
 0.0027
0.003
0.0033
0.0034
[Test]:  
Precision:
 0.001
0.0008
0.0005
0.0004 
Recall:
 0.004
0.0059
0.009
0.012 
NDCG:
 0.0026
0.0032
0.004
0.0046 
MRR:
0.0033
0.0037
0.0039
0.004
Runing Epoch 010 train loss 11.1118 costs 00: 38: 24
------------------------------------------------------
Runing Epoch 011 train loss 11.1080 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 012 train loss 11.1060 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 013 train loss 11.0229 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 014 train loss 11.0600 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0022
0.0018
0.0012
0.0008 
Recall:
 0.0064
0.0097
0.015
0.0201 
NDCG:
 0.0047
0.0056
0.007
0.0082 
MRR:
 0.0073
0.008
0.0085
0.0087
[Test]:  
Precision:
 0.0029
0.0021
0.0014
0.0009 
Recall:
 0.0124
0.0173
0.0253
0.0329 
NDCG:
 0.0081
0.0096
0.0117
0.0133 
MRR:
0.0098
0.0105
0.011
0.0112
Runing Epoch 015 train loss 11.0402 costs 00: 38: 30
------------------------------------------------------
Runing Epoch 016 train loss 11.0299 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 017 train loss 11.0143 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 018 train loss 11.1076 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 019 train loss 10.8980 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0006
0.0005
0.0004
0.0003 
Recall:
 0.0012
0.0021
0.0038
0.0056 
NDCG:
 0.001
0.0012
0.0017
0.0021 
MRR:
 0.0018
0.0021
0.0023
0.0024
[Test]:  
Precision:
 0.0004
0.0004
0.0003
0.0002 
Recall:
 0.0015
0.0025
0.0046
0.0071 
NDCG:
 0.001
0.0013
0.0018
0.0023 
MRR:
0.0015
0.0017
0.0018
0.0019
Runing Epoch 020 train loss 11.1131 costs 00: 38: 23
------------------------------------------------------
Runing Epoch 021 train loss 11.0330 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 022 train loss 11.0241 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 023 train loss 10.9718 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 024 train loss 10.9773 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0039
0.0031
0.002
0.0015 
Recall:
 0.0113
0.0164
0.0242
0.0319 
NDCG:
 0.0082
0.0097
0.012
0.0139 
MRR:
 0.0126
0.0137
0.0145
0.0148
[Test]:  
Precision:
 0.0059
0.0042
0.0026
0.0017 
Recall:
 0.0241
0.0322
0.0452
0.0573 
NDCG:
 0.0165
0.019
0.0225
0.0253 
MRR:
0.0204
0.0216
0.0225
0.0228
Runing Epoch 025 train loss 10.9001 costs 00: 38: 30
------------------------------------------------------
Runing Epoch 026 train loss 10.9883 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 027 train loss 10.9518 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 028 train loss 10.9471 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 029 train loss 10.9948 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0038
0.0029
0.0018
0.0013 
Recall:
 0.0118
0.0165
0.0232
0.0295 
NDCG:
 0.0086
0.01
0.0118
0.0134 
MRR:
 0.013
0.014
0.0147
0.0149
[Test]:  
Precision:
 0.0056
0.004
0.0023
0.0015 
Recall:
 0.024
0.0317
0.0427
0.0525 
NDCG:
 0.0169
0.0193
0.0222
0.0244 
MRR:
0.021
0.0221
0.0228
0.0231
Runing Epoch 030 train loss 10.9769 costs 00: 38: 29
------------------------------------------------------
Runing Epoch 031 train loss 10.9566 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 032 train loss 10.9409 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 033 train loss 11.0414 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 034 train loss 10.9184 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.005
0.0039
0.0027
0.0019 
Recall:
 0.0163
0.0238
0.0365
0.0485 
NDCG:
 0.0113
0.0136
0.0171
0.0199 
MRR:
 0.0164
0.0179
0.019
0.0194
[Test]:  
Precision:
 0.0075
0.0054
0.0034
0.0023 
Recall:
 0.0335
0.0454
0.0653
0.0837 
NDCG:
 0.0227
0.0263
0.0315
0.0355 
MRR:
0.0272
0.0288
0.03
0.0304
Runing Epoch 035 train loss 11.0695 costs 00: 38: 32
------------------------------------------------------
Runing Epoch 036 train loss 11.0152 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 037 train loss 10.9088 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 038 train loss 11.0246 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 039 train loss 10.9204 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0053
0.0042
0.0029
0.0021 
Recall:
 0.0162
0.024
0.0375
0.0502 
NDCG:
 0.0116
0.0139
0.0176
0.0206 
MRR:
 0.0172
0.0187
0.0199
0.0204
[Test]:  
Precision:
 0.0075
0.0055
0.0035
0.0024 
Recall:
 0.0323
0.0446
0.0656
0.0851 
NDCG:
 0.022
0.0257
0.0311
0.0354 
MRR:
0.0267
0.0284
0.0296
0.0301
Runing Epoch 040 train loss 11.2069 costs 00: 38: 30
------------------------------------------------------
Runing Epoch 041 train loss 11.0481 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 042 train loss 10.9793 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 043 train loss 10.9937 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 044 train loss 10.9170 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0012
0.001
0.0007
0.0005 
Recall:
 0.0037
0.0054
0.0085
0.0118 
NDCG:
 0.0027
0.0032
0.004
0.0048 
MRR:
 0.0043
0.0046
0.005
0.0051
[Test]:  
Precision:
 0.0018
0.0013
0.0008
0.0006 
Recall:
 0.0078
0.0108
0.0158
0.0204 
NDCG:
 0.0054
0.0063
0.0076
0.0086 
MRR:
0.0069
0.0073
0.0077
0.0078
Runing Epoch 045 train loss 10.9491 costs 00: 38: 24
------------------------------------------------------
Runing Epoch 046 train loss 10.9252 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 047 train loss 10.9380 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 048 train loss 10.9488 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 049 train loss 11.2256 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0048
0.0039
0.0026
0.0019 
Recall:
 0.0138
0.021
0.0323
0.0439 
NDCG:
 0.01
0.0122
0.0153
0.0182 
MRR:
 0.0155
0.0169
0.018
0.0184
[Test]:  
Precision:
 0.0069
0.0051
0.0032
0.0022 
Recall:
 0.0291
0.0405
0.0582
0.0753 
NDCG:
 0.0196
0.0231
0.0277
0.0315 
MRR:
0.024
0.0256
0.0267
0.0272
Runing Epoch 050 train loss 10.8831 costs 00: 38: 23
------------------------------------------------------
Runing Epoch 051 train loss 10.9350 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 052 train loss 10.9030 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 053 train loss 10.9789 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 054 train loss 10.9129 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0058
0.0047
0.0033
0.0024 
Recall:
 0.017
0.0256
0.0412
0.0566 
NDCG:
 0.0122
0.0149
0.0192
0.0229 
MRR:
 0.0184
0.0202
0.0216
0.0222
[Test]:  
Precision:
 0.0081
0.006
0.0039
0.0027 
Recall:
 0.034
0.0478
0.0717
0.0951 
NDCG:
 0.0231
0.0274
0.0336
0.0386 
MRR:
0.0282
0.0302
0.0316
0.0322
Runing Epoch 055 train loss 11.4557 costs 00: 38: 27
------------------------------------------------------
Runing Epoch 056 train loss 13.4370 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 057 train loss 10.8211 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 058 train loss 10.7728 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 059 train loss 10.7623 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0042
0.0033
0.0022
0.0015 
Recall:
 0.0134
0.0192
0.0287
0.0368 
NDCG:
 0.0096
0.0114
0.0139
0.0159 
MRR:
 0.0143
0.0154
0.0163
0.0166
[Test]:  
Precision:
 0.0062
0.0045
0.0027
0.0018 
Recall:
 0.027
0.0365
0.0515
0.0643 
NDCG:
 0.0187
0.0216
0.0255
0.0283 
MRR:
0.0229
0.0242
0.0252
0.0255
Runing Epoch 060 train loss 10.8113 costs 00: 38: 22
------------------------------------------------------
Runing Epoch 061 train loss 10.7901 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 062 train loss 10.8533 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 063 train loss 10.7801 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 064 train loss 10.7825 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0062
0.0049
0.0034
0.0024 
Recall:
 0.0192
0.0285
0.045
0.0605 
NDCG:
 0.0136
0.0164
0.0209
0.0245 
MRR:
 0.0199
0.0217
0.0231
0.0236
[Test]:  
Precision:
 0.0088
0.0065
0.0041
0.0028 
Recall:
 0.0387
0.054
0.0789
0.1027 
NDCG:
 0.0262
0.0309
0.0373
0.0425 
MRR:
0.0316
0.0336
0.0351
0.0356
Runing Epoch 065 train loss 10.8233 costs 00: 38: 25
------------------------------------------------------
Runing Epoch 066 train loss 10.8388 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 067 train loss 10.8484 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 068 train loss 10.7984 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 069 train loss 10.9256 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.005
0.004
0.0027
0.002 
Recall:
 0.0155
0.0226
0.035
0.0474 
NDCG:
 0.011
0.0132
0.0166
0.0195 
MRR:
 0.0163
0.0178
0.019
0.0194
[Test]:  
Precision:
 0.0073
0.0053
0.0033
0.0023 
Recall:
 0.0312
0.0432
0.0633
0.0819 
NDCG:
 0.0212
0.025
0.0301
0.0341 
MRR:
0.0259
0.0276
0.0288
0.0293
Runing Epoch 070 train loss 10.8505 costs 00: 38: 21
------------------------------------------------------
Runing Epoch 071 train loss 11.0382 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 072 train loss 10.8985 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 073 train loss 10.8792 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 074 train loss 11.3530 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0007
0.0005
0.0003
0.0002 
Recall:
 0.0015
0.0023
0.0037
0.005 
NDCG:
 0.0011
0.0013
0.0016
0.0019 
MRR:
 0.0018
0.002
0.0022
0.0022
[Test]:  
Precision:
 0.0005
0.0004
0.0002
0.0002 
Recall:
 0.002
0.0031
0.0049
0.0063 
NDCG:
 0.0012
0.0015
0.0019
0.0022 
MRR:
0.0015
0.0017
0.0018
0.0018
Runing Epoch 075 train loss 10.8946 costs 00: 38: 21
------------------------------------------------------
Runing Epoch 076 train loss 10.8750 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 077 train loss 10.8166 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 078 train loss 10.8534 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 079 train loss 10.9123 costs 00: 00: 59
------------------------------------------------------
[Valid]: 
Precision:
 0.0061
0.0048
0.0033
0.0024 
Recall:
 0.0188
0.028
0.0442
0.0609 
NDCG:
 0.0134
0.0161
0.0205
0.0244 
MRR:
 0.02
0.0217
0.0231
0.0237
[Test]:  
Precision:
 0.0084
0.0061
0.0039
0.0027 
Recall:
 0.0367
0.0513
0.0764
0.0998 
NDCG:
 0.0246
0.0291
0.0354
0.0404 
MRR:
0.0297
0.0316
0.0331
0.0337
Runing Epoch 080 train loss 10.9155 costs 00: 38: 22
------------------------------------------------------
Runing Epoch 081 train loss 10.9197 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 082 train loss 10.8983 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 083 train loss 10.8758 costs 00: 00: 59
------------------------------------------------------
Runing Epoch 084 train loss 10.8886 costs 00: 00: 59
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 065 
[Valid]: 
Precision:
 0.0062
0.0049
0.0034
0.0024 
Recall:
 0.0192
0.0285
0.045
0.0605 
NDCG:
 0.0136
0.0164
0.0209
0.0245 
MRR:
 0.0199
0.0217
0.0231
0.0236
[Test]:  
Precision:
 0.0088
0.0065
0.0041
0.0028 
Recall:
 0.0387
0.054
0.0789
0.1027 
NDCG:
 0.0262
0.0309
0.0373
0.0425 
MRR:
0.0316
0.0336
0.0351
0.0356
End time:  2023-06-13 22:57:49
