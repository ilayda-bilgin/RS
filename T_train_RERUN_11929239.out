args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, reweight=True, round=1, sampling_noise=False, save_path='./saved_models/', time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, w_max=1.0, w_min=0.1, weight_decay=0.0)
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, w_max=1.0, w_min=0.1, weight_decay=0.0)
Starting time:  2023-06-15 13:09:23
user num: 54574
item num: 34395
data ready.
models ready.
Number of all parameters: 68835505
Start training...
/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 783.1802 costs 00: 00: 11
------------------------------------------------------
Runing Epoch 002 train loss 604.2100 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 003 train loss 560.5769 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 004 train loss 545.8735 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0124
0.0106
0.0082
0.0064 
Recall:
 0.0308
0.0518
0.0966
0.1469 
NDCG:
 0.0238
0.0307
0.0435
0.0558 
MRR:
 0.0403
0.0445
0.048
0.0494
[Test]:  
Precision:
 0.0092
0.0077
0.0058
0.0045 
Recall:
 0.0384
0.063
0.1164
0.1757 
NDCG:
 0.0243
0.0318
0.045
0.0573 
MRR:
0.031
0.0343
0.0373
0.0385
Runing Epoch 005 train loss 538.6242 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 006 train loss 534.0234 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 007 train loss 529.5499 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 008 train loss 525.4419 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 009 train loss 521.8818 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0148
0.0125
0.0095
0.0075 
Recall:
 0.0367
0.061
0.1131
0.1737 
NDCG:
 0.0282
0.0362
0.0511
0.0659 
MRR:
 0.0473
0.052
0.0559
0.0575
[Test]:  
Precision:
 0.0113
0.0095
0.007
0.0054 
Recall:
 0.0473
0.0779
0.1389
0.2093 
NDCG:
 0.0299
0.0392
0.0544
0.0689 
MRR:
0.0377
0.0417
0.045
0.0465
Runing Epoch 010 train loss 518.4761 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 011 train loss 515.5252 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 012 train loss 512.1003 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 013 train loss 509.9476 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 014 train loss 507.7556 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0151
0.0127
0.0098
0.0076 
Recall:
 0.0374
0.0624
0.1161
0.1764 
NDCG:
 0.0288
0.037
0.0524
0.0671 
MRR:
 0.0484
0.0532
0.0572
0.0588
[Test]:  
Precision:
 0.0117
0.0097
0.0072
0.0055 
Recall:
 0.0491
0.0793
0.143
0.2142 
NDCG:
 0.0309
0.0401
0.056
0.0708 
MRR:
0.0387
0.0428
0.0462
0.0477
Runing Epoch 015 train loss 505.0511 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 016 train loss 503.5714 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 017 train loss 501.6448 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 018 train loss 500.2620 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 019 train loss 498.9736 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0152
0.0127
0.0097
0.0076 
Recall:
 0.0376
0.0621
0.1152
0.1752 
NDCG:
 0.029
0.0371
0.0524
0.0671 
MRR:
 0.0488
0.0536
0.0576
0.0592
[Test]:  
Precision:
 0.012
0.0099
0.0073
0.0055 
Recall:
 0.0499
0.0803
0.1432
0.2127 
NDCG:
 0.0315
0.0408
0.0565
0.0709 
MRR:
0.0394
0.0435
0.0469
0.0483
Runing Epoch 020 train loss 497.7501 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 021 train loss 496.5127 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 022 train loss 495.6576 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 023 train loss 494.8173 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 024 train loss 494.1373 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0154
0.0128
0.0098
0.0077 
Recall:
 0.0385
0.0632
0.1168
0.1768 
NDCG:
 0.0296
0.0376
0.053
0.0678 
MRR:
 0.0496
0.0544
0.0583
0.0599
[Test]:  
Precision:
 0.012
0.01
0.0074
0.0056 
Recall:
 0.0507
0.0816
0.1457
0.216 
NDCG:
 0.032
0.0415
0.0575
0.0721 
MRR:
0.0399
0.0441
0.0475
0.049
Runing Epoch 025 train loss 493.0489 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 026 train loss 492.8841 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 027 train loss 492.1130 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 028 train loss 491.5973 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 029 train loss 491.1607 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0156
0.013
0.0099
0.0078 
Recall:
 0.0393
0.0645
0.1185
0.1794 
NDCG:
 0.0299
0.0381
0.0537
0.0686 
MRR:
 0.0495
0.0544
0.0584
0.06
[Test]:  
Precision:
 0.0123
0.0101
0.0074
0.0056 
Recall:
 0.0516
0.0828
0.1471
0.2185 
NDCG:
 0.0324
0.042
0.058
0.0729 
MRR:
0.0403
0.0444
0.0478
0.0493
Runing Epoch 030 train loss 490.9670 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 031 train loss 490.4023 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 032 train loss 490.2658 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 033 train loss 489.9755 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 034 train loss 490.0788 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0156
0.0132
0.0099
0.0078 
Recall:
 0.0389
0.0645
0.1183
0.1803 
NDCG:
 0.0299
0.0383
0.0537
0.0689 
MRR:
 0.0502
0.0552
0.0591
0.0607
[Test]:  
Precision:
 0.0123
0.01
0.0074
0.0057 
Recall:
 0.0522
0.0826
0.1477
0.2195 
NDCG:
 0.0329
0.0422
0.0585
0.0734 
MRR:
0.041
0.0451
0.0486
0.05
Runing Epoch 035 train loss 489.5890 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 036 train loss 489.5785 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 037 train loss 489.0236 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 038 train loss 489.0701 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 039 train loss 488.8465 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0155
0.013
0.01
0.0078 
Recall:
 0.039
0.0647
0.1197
0.1819 
NDCG:
 0.0298
0.0382
0.054
0.0692 
MRR:
 0.0498
0.0547
0.0587
0.0603
[Test]:  
Precision:
 0.0123
0.0102
0.0075
0.0057 
Recall:
 0.0519
0.0841
0.1492
0.2221 
NDCG:
 0.0328
0.0426
0.0588
0.0739 
MRR:
0.0408
0.045
0.0485
0.05
Runing Epoch 040 train loss 488.5418 costs 00: 00: 46
------------------------------------------------------
Runing Epoch 041 train loss 488.7386 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 042 train loss 488.7880 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 043 train loss 488.9724 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 044 train loss 488.0402 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0154
0.0129
0.01
0.0078 
Recall:
 0.039
0.0642
0.1189
0.1814 
NDCG:
 0.0299
0.0382
0.0539
0.0691 
MRR:
 0.0498
0.0548
0.0588
0.0604
[Test]:  
Precision:
 0.0122
0.0101
0.0074
0.0057 
Recall:
 0.0511
0.0829
0.1482
0.2208 
NDCG:
 0.0323
0.042
0.0583
0.0733 
MRR:
0.0404
0.0446
0.048
0.0495
Runing Epoch 045 train loss 488.2348 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 046 train loss 488.3462 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 047 train loss 488.0729 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 048 train loss 488.4085 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 049 train loss 488.6163 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0153
0.013
0.01
0.0078 
Recall:
 0.0386
0.0648
0.1203
0.1823 
NDCG:
 0.0294
0.0381
0.054
0.0691 
MRR:
 0.0491
0.0542
0.0583
0.0598
[Test]:  
Precision:
 0.0122
0.01
0.0075
0.0056 
Recall:
 0.0514
0.0827
0.1489
0.2217 
NDCG:
 0.0323
0.0418
0.0583
0.0732 
MRR:
0.04
0.0442
0.0477
0.0492
Runing Epoch 050 train loss 488.0843 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 051 train loss 488.3962 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 052 train loss 488.0644 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 053 train loss 487.8573 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 054 train loss 488.2404 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0154
0.013
0.01
0.0079 
Recall:
 0.0389
0.0652
0.12
0.1838 
NDCG:
 0.0296
0.0382
0.054
0.0694 
MRR:
 0.0491
0.0542
0.0582
0.0599
[Test]:  
Precision:
 0.0122
0.0101
0.0075
0.0057 
Recall:
 0.0514
0.0833
0.1505
0.2238 
NDCG:
 0.0323
0.0421
0.0587
0.0739 
MRR:
0.0402
0.0444
0.048
0.0495
Runing Epoch 055 train loss 488.0983 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 056 train loss 487.9246 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 057 train loss 487.5939 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 058 train loss 487.6563 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 059 train loss 487.7442 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0155
0.0132
0.01
0.0079 
Recall:
 0.0392
0.0654
0.1207
0.185 
NDCG:
 0.0299
0.0385
0.0543
0.0699 
MRR:
 0.0498
0.0549
0.0589
0.0605
[Test]:  
Precision:
 0.0123
0.0101
0.0075
0.0057 
Recall:
 0.0525
0.084
0.1507
0.2251 
NDCG:
 0.0328
0.0424
0.059
0.0743 
MRR:
0.0403
0.0445
0.0481
0.0496
Runing Epoch 060 train loss 487.5679 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 061 train loss 487.8977 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 062 train loss 487.5009 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 063 train loss 487.2401 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 064 train loss 487.5561 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0154
0.013
0.01
0.0079 
Recall:
 0.0394
0.0653
0.1205
0.1846 
NDCG:
 0.0297
0.0383
0.0541
0.0697 
MRR:
 0.0493
0.0544
0.0584
0.0601
[Test]:  
Precision:
 0.0122
0.01
0.0075
0.0057 
Recall:
 0.052
0.0834
0.1514
0.2262 
NDCG:
 0.0326
0.0422
0.059
0.0743 
MRR:
0.0402
0.0444
0.048
0.0495
Runing Epoch 065 train loss 487.6580 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 066 train loss 487.7361 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 067 train loss 487.6405 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 068 train loss 487.5331 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 069 train loss 487.8712 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0156
0.0131
0.01
0.0078 
Recall:
 0.0398
0.0653
0.1205
0.184 
NDCG:
 0.0301
0.0385
0.0543
0.0696 
MRR:
 0.0497
0.0547
0.0587
0.0603
[Test]:  
Precision:
 0.0123
0.0101
0.0075
0.0057 
Recall:
 0.0523
0.0838
0.1507
0.2258 
NDCG:
 0.0329
0.0426
0.0591
0.0745 
MRR:
0.041
0.0451
0.0487
0.0502
Runing Epoch 070 train loss 487.6645 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 071 train loss 487.7845 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 072 train loss 487.5399 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 073 train loss 487.5890 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 074 train loss 487.5468 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0157
0.0132
0.0101
0.008 
Recall:
 0.04
0.0665
0.1226
0.1876 
NDCG:
 0.0303
0.039
0.055
0.0708 
MRR:
 0.0504
0.0555
0.0596
0.0613
[Test]:  
Precision:
 0.0124
0.0102
0.0076
0.0058 
Recall:
 0.0524
0.085
0.1528
0.2291 
NDCG:
 0.0329
0.0428
0.0596
0.0753 
MRR:
0.0409
0.0451
0.0487
0.0503
Runing Epoch 075 train loss 487.5183 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 076 train loss 487.2780 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 077 train loss 487.1453 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 078 train loss 487.6672 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 079 train loss 487.7660 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0154
0.013
0.01
0.0078 
Recall:
 0.0394
0.0654
0.1208
0.1848 
NDCG:
 0.0299
0.0384
0.0543
0.0698 
MRR:
 0.0495
0.0545
0.0586
0.0603
[Test]:  
Precision:
 0.0122
0.0101
0.0075
0.0057 
Recall:
 0.052
0.0844
0.1521
0.226 
NDCG:
 0.0326
0.0425
0.0592
0.0744 
MRR:
0.0403
0.0446
0.0482
0.0497
Runing Epoch 080 train loss 487.4592 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 081 train loss 487.3778 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 082 train loss 487.7016 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 083 train loss 487.7125 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 084 train loss 487.1441 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0156
0.0132
0.0101
0.0079 
Recall:
 0.0397
0.0663
0.1224
0.1874 
NDCG:
 0.03
0.0387
0.0547
0.0704 
MRR:
 0.0495
0.0546
0.0586
0.0603
[Test]:  
Precision:
 0.0123
0.0101
0.0075
0.0058 
Recall:
 0.0524
0.0846
0.1528
0.2285 
NDCG:
 0.0328
0.0426
0.0595
0.075 
MRR:
0.0405
0.0447
0.0483
0.0498
Runing Epoch 085 train loss 487.2487 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 086 train loss 487.8472 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 087 train loss 487.3677 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 088 train loss 487.4341 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 089 train loss 487.6491 costs 00: 00: 10
------------------------------------------------------
[Valid]: 
Precision:
 0.0153
0.0131
0.01
0.0079 
Recall:
 0.039
0.0653
0.1211
0.184 
NDCG:
 0.0297
0.0384
0.0544
0.0696 
MRR:
 0.0493
0.0545
0.0585
0.0601
[Test]:  
Precision:
 0.0123
0.0102
0.0075
0.0057 
Recall:
 0.0517
0.0846
0.1502
0.2243 
NDCG:
 0.0325
0.0425
0.0588
0.074 
MRR:
0.0403
0.0446
0.0481
0.0496
Runing Epoch 090 train loss 487.4794 costs 00: 00: 45
------------------------------------------------------
Runing Epoch 091 train loss 487.3509 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 092 train loss 487.7358 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 093 train loss 487.3119 costs 00: 00: 10
------------------------------------------------------
Runing Epoch 094 train loss 487.6373 costs 00: 00: 10
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 075 
[Valid]: 
Precision:
 0.0157
0.0132
0.0101
0.008 
Recall:
 0.04
0.0665
0.1226
0.1876 
NDCG:
 0.0303
0.039
0.055
0.0708 
MRR:
 0.0504
0.0555
0.0596
0.0613
[Test]:  
Precision:
 0.0124
0.0102
0.0076
0.0058 
Recall:
 0.0524
0.085
0.1528
0.2291 
NDCG:
 0.0329
0.0428
0.0596
0.0753 
MRR:
0.0409
0.0451
0.0487
0.0503
End time:  2023-06-15 13:36:04
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, reweight=True, round=1, sampling_noise=False, save_path='./saved_models/', time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, w_max=1.0, w_min=0.1, weight_decay=0.0)
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='yelp_noisy', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=100, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, w_max=1.0, w_min=0.1, weight_decay=0.0)
Starting time:  2023-06-15 13:36:07
user num: 54574
item num: 77405
data ready.
models ready.
Number of all parameters: 154898515
Start training...
/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Runing Epoch 001 train loss 14.2782 costs 00: 00: 17
------------------------------------------------------
Runing Epoch 002 train loss 13.2466 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 003 train loss 12.8632 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 004 train loss 12.5752 costs 00: 00: 16
------------------------------------------------------
[Valid]: 
Precision:
 0.011
0.0095
0.0074
0.006 
Recall:
 0.0293
0.0487
0.0906
0.1419 
NDCG:
 0.0213
0.0274
0.0391
0.0513 
MRR:
 0.0348
0.0388
0.0422
0.0436
[Test]:  
Precision:
 0.009
0.0075
0.0057
0.0045 
Recall:
 0.0377
0.0618
0.114
0.1768 
NDCG:
 0.0234
0.0308
0.0438
0.0567 
MRR:
0.0294
0.0327
0.0357
0.0371
Runing Epoch 005 train loss 12.4026 costs 00: 07: 43
------------------------------------------------------
Runing Epoch 006 train loss 12.1949 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 007 train loss 11.9936 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 008 train loss 11.8382 costs 00: 00: 16
------------------------------------------------------
Runing Epoch 009 train loss 11.6929 costs 00: 00: 16
------------------------------------------------------
