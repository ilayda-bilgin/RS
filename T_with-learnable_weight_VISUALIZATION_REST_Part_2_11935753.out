Data shape: (12007, 100, 10)
Calculating M-PHATE...
  Calculating multislice kernel...
  Calculated multislice kernel in 340.84 seconds.
Calculated M-PHATE in 341.00 seconds.
Traceback (most recent call last):
  File "utils/visualize_weights.py", line 64, in <module>
    main()
  File "utils/visualize_weights.py", line 55, in main
    m_phate_data = generate_m_phate(data, num_workers=args.workers)
  File "utils/visualize_weights.py", line 10, in generate_m_phate
    m_phate_data = m_phate_op.fit_transform(data)
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/m_phate/m_phate.py", line 193, in fit_transform
    self.fit(X)
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/m_phate/m_phate.py", line 151, in fit
    K = kernel.multislice_kernel(X,
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/m_phate/kernel.py", line 116, in multislice_kernel
    K = _multislice_kernel(
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/m_phate/kernel.py", line 79, in _multislice_kernel
    interslice_dist = p(pdist_fn(data[:, vertex, :])
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/joblib/parallel.py", line 1098, in __call__
    self.retrieve()
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/joblib/parallel.py", line 975, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 567, in wrap_future_result
    return future.result(timeout=timeout)
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/concurrent/futures/_base.py", line 444, in result
    return self.__get_result()
  File "/home/lcur2470/.conda/envs/rs/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
joblib.externals.loky.process_executor.TerminatedWorkerError: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9), SIGKILL(-9)}
slurmstepd: error: Detected 2 oom-kill event(s) in StepId=11935753.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
