True
Attention weighting is enabled, therefore standard reweighting was disabled.
args: Namespace(attention_weighting=True, batch_size=400, cuda=True, data_path='./datasets/', dataset='ml-1m_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='0', log_name='log', lr=0.0001, mean_type='x0', model_type='T-DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=4, patience=20, reweight=False, round=1, run_name='STAMP_Test2', sampling_noise=False, sampling_steps=0, save_path='./saved_models/', seed=1, steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, visualize_weights=False, w_max=1.0, w_min=0.1, weight_decay=0.0, workers=10)
Starting time:  2023-06-29 14:24:35
user num: 5949
item num: 2810
data ready.
in_dims: [2810, 1000]
models ready.
Number of all parameters: 5646514
Start training...
/home/lcur2470/.conda/envs/rs/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
max nr of interactions per user: 1673
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0498,  0.0162,  0.0040,  ..., -0.0052, -0.0320, -0.0123],
        [ 0.0327, -0.0074, -0.0330,  ...,  0.0057,  0.0406, -0.0567],
        [ 0.0640, -0.0313,  0.0242,  ..., -0.0045, -0.0156, -0.0533],
        ...,
        [ 0.0327, -0.0077, -0.0330,  ...,  0.0057,  0.0407, -0.0565],
        [ 0.0354,  0.0127, -0.0262,  ...,  0.0028,  0.0076, -0.0263],
        [ 0.0629, -0.0035,  0.0289,  ..., -0.0094, -0.0429, -0.0263]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1699
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0283, -0.0054, -0.0290,  ...,  0.0044,  0.0409, -0.0529],
        [ 0.0286, -0.0056, -0.0288,  ...,  0.0047,  0.0409, -0.0528],
        [ 0.0569,  0.0005,  0.0331,  ..., -0.0075, -0.0385, -0.0221],
        ...,
        [ 0.0575,  0.0001,  0.0330,  ..., -0.0077, -0.0383, -0.0219],
        [ 0.0439,  0.0196,  0.0086,  ..., -0.0040, -0.0281, -0.0087],
        [ 0.0585, -0.0276,  0.0281,  ..., -0.0031, -0.0120, -0.0490]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1692
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0392,  0.0228,  0.0126,  ..., -0.0030, -0.0253, -0.0047],
        [ 0.0272,  0.0179, -0.0176,  ...,  0.0021,  0.0104, -0.0192],
        [ 0.0518,  0.0042,  0.0365,  ..., -0.0057, -0.0343, -0.0177],
        ...,
        [ 0.0522,  0.0039,  0.0367,  ..., -0.0058, -0.0341, -0.0179],
        [ 0.0271,  0.0183, -0.0178,  ...,  0.0022,  0.0107, -0.0195],
        [ 0.0269,  0.0182, -0.0175,  ...,  0.0020,  0.0102, -0.0194]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1633
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0235, -0.0010, -0.0227,  ...,  0.0019,  0.0413, -0.0463],
        [ 0.0242,  0.0204, -0.0141,  ...,  0.0015,  0.0116, -0.0161],
        [ 0.0493, -0.0207,  0.0342,  ..., -0.0006, -0.0056, -0.0410],
        ...,
        [ 0.0473,  0.0077,  0.0402,  ..., -0.0040, -0.0301, -0.0139],
        [ 0.0246,  0.0204, -0.0146,  ...,  0.0012,  0.0117, -0.0160],
        [ 0.0492, -0.0208,  0.0342,  ..., -0.0005, -0.0057, -0.0411]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1904
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0319,  0.0290,  0.0195,  ..., -0.0019, -0.0193,  0.0023],
        [ 0.0428,  0.0112,  0.0434,  ..., -0.0027, -0.0262, -0.0102],
        [ 0.0454, -0.0173,  0.0370,  ...,  0.0002, -0.0025, -0.0371],
        ...,
        [ 0.0433,  0.0113,  0.0430,  ..., -0.0030, -0.0262, -0.0099],
        [ 0.0215,  0.0013, -0.0197,  ...,  0.0006,  0.0413, -0.0432],
        [ 0.0215,  0.0014, -0.0196,  ...,  0.0006,  0.0411, -0.0432]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1701
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0200,  0.0035, -0.0168,  ..., -0.0008,  0.0408, -0.0399],
        [ 0.0202,  0.0035, -0.0170,  ..., -0.0010,  0.0409, -0.0396],
        [ 0.0200,  0.0037, -0.0167,  ..., -0.0008,  0.0408, -0.0399],
        ...,
        [ 0.0202,  0.0252, -0.0079,  ..., -0.0002,  0.0133, -0.0097],
        [ 0.0418, -0.0140,  0.0396,  ...,  0.0008,  0.0002, -0.0334],
        [ 0.0202,  0.0252, -0.0080,  ..., -0.0002,  0.0132, -0.0097]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1717
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0262,  0.0346,  0.0260,  ..., -0.0009, -0.0143,  0.0087],
        [ 0.0386, -0.0107,  0.0422,  ...,  0.0011,  0.0029, -0.0295],
        [ 0.0186,  0.0273, -0.0050,  ..., -0.0009,  0.0139, -0.0066],
        ...,
        [ 0.0264,  0.0346,  0.0259,  ..., -0.0011, -0.0142,  0.0089],
        [ 0.0356,  0.0180,  0.0493,  ..., -0.0007, -0.0192, -0.0031],
        [ 0.0355,  0.0180,  0.0494,  ..., -0.0005, -0.0193, -0.0032]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1640
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 2.3483e-02,  3.7303e-02,  2.9245e-02,  ..., -1.8395e-05,
         -1.2038e-02,  1.1417e-02],
        [ 1.7063e-02,  7.9753e-03, -1.0836e-02,  ..., -2.5238e-03,
          3.9697e-02, -3.3738e-02],
        [ 3.5141e-02, -7.3734e-03,  4.5245e-02,  ...,  1.7225e-03,
          5.2811e-03, -2.6385e-02],
        ...,
        [ 1.7311e-02,  7.9762e-03, -1.0977e-02,  ..., -2.8416e-03,
          3.9814e-02, -3.3488e-02],
        [ 2.3673e-02,  3.7314e-02,  2.9107e-02,  ..., -3.2869e-04,
         -1.1911e-02,  1.1626e-02],
        [ 3.5148e-02, -7.3733e-03,  4.5248e-02,  ...,  1.7518e-03,
          5.2589e-03, -2.6342e-02]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1722
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0288,  0.0242,  0.0555,  ...,  0.0010, -0.0129,  0.0030],
        [ 0.0160,  0.0101, -0.0079,  ..., -0.0036,  0.0392, -0.0305],
        [ 0.0160,  0.0101, -0.0079,  ..., -0.0037,  0.0392, -0.0305],
        ...,
        [ 0.0157,  0.0100, -0.0078,  ..., -0.0033,  0.0391, -0.0308],
        [ 0.0149,  0.0314,  0.0015,  ..., -0.0005,  0.0145, -0.0018],
        [ 0.0320, -0.0042,  0.0481,  ...,  0.0018,  0.0075, -0.0231]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1814
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0185,  0.0421,  0.0356,  ...,  0.0003, -0.0079,  0.0165],
        [ 0.0256,  0.0272,  0.0587,  ...,  0.0012, -0.0102,  0.0055],
        [ 0.0185,  0.0421,  0.0356,  ...,  0.0003, -0.0079,  0.0164],
        ...,
        [ 0.0134,  0.0334,  0.0047,  ..., -0.0010,  0.0147,  0.0008],
        [ 0.0183,  0.0421,  0.0357,  ...,  0.0007, -0.0081,  0.0161],
        [ 0.0185,  0.0421,  0.0356,  ...,  0.0003, -0.0079,  0.0164]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1594
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0227,  0.0302,  0.0621,  ...,  0.0011, -0.0076,  0.0078],
        [ 0.0264,  0.0022,  0.0542,  ...,  0.0009,  0.0115, -0.0172],
        [ 0.0160,  0.0444,  0.0392,  ...,  0.0006, -0.0063,  0.0180],
        ...,
        [ 0.0227,  0.0302,  0.0620,  ...,  0.0011, -0.0076,  0.0078],
        [ 0.0160,  0.0444,  0.0392,  ...,  0.0006, -0.0063,  0.0181],
        [ 0.0229,  0.0302,  0.0620,  ...,  0.0006, -0.0074,  0.0081]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1620
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0118,  0.0164,  0.0022,  ..., -0.0053,  0.0364, -0.0227],
        [ 0.0106,  0.0373,  0.0116,  ..., -0.0022,  0.0149,  0.0052],
        [ 0.0118,  0.0164,  0.0021,  ..., -0.0053,  0.0364, -0.0228],
        ...,
        [ 0.0238,  0.0055,  0.0575,  ...,  0.0007,  0.0130, -0.0147],
        [ 0.0118,  0.0164,  0.0022,  ..., -0.0053,  0.0364, -0.0227],
        [ 0.0240,  0.0056,  0.0575,  ...,  0.0002,  0.0132, -0.0143]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1807
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0089,  0.0391,  0.0154,  ..., -0.0013,  0.0144,  0.0064],
        [ 0.0116,  0.0491,  0.0466,  ...,  0.0011, -0.0037,  0.0210],
        [ 0.0118,  0.0491,  0.0466,  ...,  0.0007, -0.0036,  0.0212],
        ...,
        [ 0.0092,  0.0392,  0.0155,  ..., -0.0022,  0.0148,  0.0070],
        [ 0.0175,  0.0363,  0.0694,  ...,  0.0007, -0.0032,  0.0118],
        [ 0.0118,  0.0491,  0.0466,  ...,  0.0007, -0.0036,  0.0212]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1710
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 9.7414e-03,  2.0663e-02,  9.6242e-03,  ..., -5.5068e-03,
          3.4149e-02, -1.8012e-02],
        [ 9.7387e-03,  2.0661e-02,  9.6259e-03,  ..., -5.5047e-03,
          3.4149e-02, -1.8009e-02],
        [ 1.9216e-02,  1.2018e-02,  6.5000e-02,  ..., -6.0426e-04,
          1.5549e-02, -9.6601e-03],
        ...,
        [ 1.9026e-02,  1.1935e-02,  6.4914e-02,  ..., -1.7319e-05,
          1.5283e-02, -1.0052e-02],
        [ 1.9036e-02,  1.1928e-02,  6.4926e-02,  ..., -1.7421e-05,
          1.5275e-02, -1.0049e-02],
        [ 1.9023e-02,  1.1929e-02,  6.4921e-02,  ..., -1.5369e-05,
          1.5275e-02, -1.0050e-02]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1631
Model output shape: torch.Size([349, 2810])
model output: tensor([[ 0.0069,  0.0428,  0.0234,  ..., -0.0013,  0.0135,  0.0095],
        [ 0.0068,  0.0428,  0.0233,  ..., -0.0009,  0.0133,  0.0092],
        [ 0.0168,  0.0148,  0.0687,  ...,  0.0001,  0.0156, -0.0084],
        ...,
        [ 0.0090,  0.0228,  0.0136,  ..., -0.0054,  0.0327, -0.0159],
        [ 0.0169,  0.0149,  0.0687,  ..., -0.0003,  0.0158, -0.0081],
        [ 0.0169,  0.0149,  0.0687,  ..., -0.0003,  0.0158, -0.0081]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([349])
Runing Epoch 001 train loss 0.1367 costs 00: 05: 28
------------------------------------------------------
max nr of interactions per user: 1715
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 6.1225e-03,  4.4251e-02,  2.7640e-02,  ..., -1.2645e-03,
          1.2625e-02,  1.0635e-02],
        [ 1.5129e-02,  1.7438e-02,  7.2682e-02,  ..., -4.5699e-04,
          1.5839e-02, -6.5024e-03],
        [ 6.0557e-03,  4.4201e-02,  2.7561e-02,  ..., -1.0089e-03,
          1.2507e-02,  1.0462e-02],
        ...,
        [ 1.0848e-02,  4.3896e-02,  8.1319e-02,  ...,  6.7336e-04,
          3.5301e-05,  1.4909e-02],
        [ 1.5330e-02,  1.7548e-02,  7.2887e-02,  ..., -1.1099e-03,
          1.6138e-02, -6.0801e-03],
        [ 1.0846e-02,  4.3891e-02,  8.1326e-02,  ...,  6.7538e-04,
          2.7072e-05,  1.4911e-02]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1876
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3666e-02,  1.9582e-02,  7.6785e-02,  ..., -4.9923e-04,
          1.5628e-02, -5.1836e-03],
        [ 9.4483e-03,  4.5587e-02,  8.5604e-02,  ...,  6.5830e-04,
          3.6004e-04,  1.5344e-02],
        [ 5.6134e-03,  4.5298e-02,  3.2039e-02,  ..., -8.9849e-04,
          1.1529e-02,  1.1383e-02],
        ...,
        [ 1.3669e-02,  1.9587e-02,  7.6778e-02,  ..., -5.0126e-04,
          1.5637e-02, -5.1858e-03],
        [ 1.3666e-02,  1.9582e-02,  7.6785e-02,  ..., -4.9923e-04,
          1.5628e-02, -5.1836e-03],
        [ 9.6371e-03,  4.5701e-02,  8.5874e-02,  ..., -1.7349e-05,
          6.6838e-04,  1.5776e-02]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1625
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 5.3326e-03,  4.6316e-02,  3.6333e-02,  ..., -7.4711e-05,
          1.0132e-02,  1.1772e-02],
        [ 8.4173e-03,  4.7273e-02,  9.0037e-02,  ...,  6.9744e-04,
          4.1158e-04,  1.5548e-02],
        [ 7.3302e-03,  2.7431e-02,  2.6335e-02,  ..., -3.9585e-03,
          2.7197e-02, -1.0891e-02],
        ...,
        [ 8.6109e-03,  4.7389e-02,  9.0378e-02,  ...,  1.9837e-06,
          7.2444e-04,  1.5990e-02],
        [ 1.2274e-02,  2.1621e-02,  8.0839e-02,  ..., -7.2736e-06,
          1.4979e-02, -4.3492e-03],
        [ 1.2590e-02,  2.1803e-02,  8.1383e-02,  ..., -1.1317e-03,
          1.5484e-02, -3.6344e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1646
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0072,  0.0289,  0.0308,  ..., -0.0032,  0.0250, -0.0097],
        [ 0.0113,  0.0238,  0.0854,  ..., -0.0002,  0.0143, -0.0033],
        [ 0.0074,  0.0290,  0.0313,  ..., -0.0039,  0.0253, -0.0093],
        ...,
        [ 0.0113,  0.0238,  0.0854,  ..., -0.0002,  0.0143, -0.0033],
        [ 0.0055,  0.0476,  0.0413,  ..., -0.0002,  0.0089,  0.0125],
        [ 0.0072,  0.0289,  0.0308,  ..., -0.0032,  0.0250, -0.0097]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1691
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0048,  0.0601,  0.0773,  ...,  0.0016, -0.0035,  0.0231],
        [ 0.0067,  0.0509,  0.0990,  ...,  0.0011, -0.0005,  0.0149],
        [ 0.0067,  0.0509,  0.0990,  ...,  0.0011, -0.0005,  0.0149],
        ...,
        [ 0.0070,  0.0305,  0.0351,  ..., -0.0015,  0.0226, -0.0091],
        [ 0.0101,  0.0261,  0.0894,  ...,  0.0007,  0.0132, -0.0032],
        [ 0.0053,  0.0487,  0.0455,  ...,  0.0015,  0.0070,  0.0120]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1705
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 6.0322e-03,  5.2424e-02,  1.0352e-01,  ...,  1.3512e-03,
         -1.1509e-03,  1.4099e-02],
        [ 5.2737e-03,  4.9834e-02,  4.9792e-02,  ...,  2.7742e-03,
          5.0468e-03,  1.1483e-02],
        [ 6.0322e-03,  5.2424e-02,  1.0352e-01,  ...,  1.3512e-03,
         -1.1509e-03,  1.4099e-02],
        ...,
        [ 7.0478e-03,  3.2288e-02,  3.9982e-02,  ..., -8.2321e-04,
          2.0545e-02, -8.1013e-03],
        [ 9.6527e-03,  2.8300e-02,  9.4668e-02,  ..., -4.9297e-05,
          1.2565e-02, -2.3137e-03],
        [ 9.6527e-03,  2.8300e-02,  9.4668e-02,  ..., -4.9297e-05,
          1.2565e-02, -2.3137e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1574
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0071,  0.0337,  0.0446,  ...,  0.0002,  0.0182, -0.0076],
        [ 0.0056,  0.0508,  0.0548,  ...,  0.0030,  0.0034,  0.0113],
        [ 0.0059,  0.0537,  0.1087,  ...,  0.0007, -0.0017,  0.0136],
        ...,
        [ 0.0071,  0.0337,  0.0446,  ...,  0.0002,  0.0182, -0.0076],
        [ 0.0073,  0.0338,  0.0453,  ..., -0.0005,  0.0185, -0.0072],
        [ 0.0056,  0.0508,  0.0548,  ...,  0.0030,  0.0034,  0.0113]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1637
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0044,  0.0626,  0.0904,  ...,  0.0030, -0.0069,  0.0192],
        [ 0.0071,  0.0350,  0.0491,  ...,  0.0010,  0.0160, -0.0073],
        [ 0.0053,  0.0547,  0.1122,  ...,  0.0012, -0.0028,  0.0120],
        ...,
        [ 0.0056,  0.0548,  0.1129,  ...,  0.0005, -0.0025,  0.0124],
        [ 0.0044,  0.0626,  0.0904,  ...,  0.0030, -0.0069,  0.0192],
        [ 0.0053,  0.0547,  0.1122,  ...,  0.0012, -0.0028,  0.0120]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1629
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0075,  0.0363,  0.0545,  ...,  0.0009,  0.0142, -0.0067],
        [ 0.0073,  0.0362,  0.0537,  ...,  0.0016,  0.0140, -0.0071],
        [ 0.0045,  0.0630,  0.0944,  ...,  0.0033, -0.0080,  0.0174],
        ...,
        [ 0.0063,  0.0524,  0.0648,  ...,  0.0030,  0.0005,  0.0103],
        [ 0.0081,  0.0329,  0.1067,  ...,  0.0010,  0.0086, -0.0034],
        [ 0.0084,  0.0331,  0.1075,  ...,  0.0003,  0.0089, -0.0030]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1613
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0077,  0.0342,  0.1109,  ...,  0.0007,  0.0075, -0.0040],
        [ 0.0077,  0.0342,  0.1109,  ...,  0.0007,  0.0075, -0.0040],
        [ 0.0050,  0.0564,  0.1208,  ...,  0.0004, -0.0042,  0.0092],
        ...,
        [ 0.0078,  0.0343,  0.1113,  ...,  0.0004,  0.0076, -0.0038],
        [ 0.0047,  0.0635,  0.0994,  ...,  0.0024, -0.0086,  0.0161],
        [ 0.0053,  0.0565,  0.1217,  ..., -0.0004, -0.0040,  0.0096]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1652
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0067,  0.0530,  0.0730,  ...,  0.0036, -0.0022,  0.0080],
        [ 0.0051,  0.0567,  0.1249,  ..., -0.0003, -0.0045,  0.0077],
        [ 0.0067,  0.0530,  0.0730,  ...,  0.0036, -0.0022,  0.0080],
        ...,
        [ 0.0067,  0.0530,  0.0730,  ...,  0.0036, -0.0022,  0.0080],
        [ 0.0075,  0.0380,  0.0628,  ...,  0.0021,  0.0104, -0.0072],
        [ 0.0051,  0.0635,  0.1037,  ...,  0.0018, -0.0090,  0.0144]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1785
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 5.4186e-03,  5.7353e-02,  1.2892e-01,  ..., -1.3859e-03,
         -4.4833e-03,  6.2370e-03],
        [ 7.3948e-03,  3.6162e-02,  1.1783e-01,  ...,  3.9730e-04,
          5.9495e-03, -5.5623e-03],
        [ 7.8094e-03,  3.8911e-02,  6.6917e-02,  ...,  2.0547e-03,
          9.1222e-03, -7.4703e-03],
        ...,
        [ 7.5418e-03,  3.6230e-02,  1.1846e-01,  ..., -5.9448e-05,
          6.1119e-03, -5.3348e-03],
        [ 5.3248e-03,  5.7295e-02,  1.2847e-01,  ..., -1.0656e-03,
         -4.5970e-03,  6.0698e-03],
        [ 7.8094e-03,  3.8911e-02,  6.6917e-02,  ...,  2.0547e-03,
          9.1222e-03, -7.4703e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1595
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0061,  0.0636,  0.1124,  ..., -0.0002, -0.0088,  0.0111],
        [ 0.0076,  0.0534,  0.0811,  ...,  0.0030, -0.0035,  0.0057],
        [ 0.0057,  0.0574,  0.1320,  ..., -0.0017, -0.0046,  0.0044],
        ...,
        [ 0.0078,  0.0535,  0.0822,  ...,  0.0022, -0.0032,  0.0061],
        [ 0.0057,  0.0574,  0.1320,  ..., -0.0017, -0.0046,  0.0044],
        [ 0.0082,  0.0395,  0.0710,  ...,  0.0021,  0.0080, -0.0078]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1686
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 8.3320e-03,  5.3589e-02,  8.6013e-02,  ...,  2.2263e-03,
         -3.5135e-03,  4.7939e-03],
        [ 7.8362e-03,  3.7627e-02,  1.2490e-01,  ..., -4.6689e-04,
          5.3105e-03, -7.0643e-03],
        [ 8.6536e-03,  4.0202e-02,  7.5293e-02,  ...,  2.0986e-03,
          7.1724e-03, -8.0957e-03],
        ...,
        [ 7.6839e-03,  3.7572e-02,  1.2419e-01,  ..., -1.3120e-05,
          5.1434e-03, -7.2646e-03],
        [ 6.0480e-03,  5.7574e-02,  1.3554e-01,  ..., -2.3435e-03,
         -4.2187e-03,  2.7687e-03],
        [ 7.9311e-03,  5.3437e-02,  8.4143e-02,  ...,  3.4177e-03,
         -3.9523e-03,  4.2642e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1754
Model output shape: torch.Size([349, 2810])
model output: tensor([[ 9.2853e-03,  4.0468e-02,  7.9478e-02,  ...,  2.1055e-03,
          6.6249e-03, -8.4075e-03],
        [ 8.1775e-03,  3.8009e-02,  1.2741e-01,  ...,  7.1704e-05,
          5.1598e-03, -7.9486e-03],
        [ 9.0328e-03,  4.0386e-02,  7.8264e-02,  ...,  2.8413e-03,
          6.3437e-03, -8.7153e-03],
        ...,
        [ 8.9316e-03,  5.3208e-02,  8.9384e-02,  ...,  2.3678e-03,
         -3.6199e-03,  3.4997e-03],
        [ 8.1775e-03,  3.8009e-02,  1.2741e-01,  ...,  7.1704e-05,
          5.1598e-03, -7.9486e-03],
        [ 9.1486e-03,  4.0415e-02,  7.8776e-02,  ...,  2.5301e-03,
          6.4600e-03, -8.5948e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([349])
Runing Epoch 002 train loss 0.1265 costs 00: 05: 30
------------------------------------------------------
max nr of interactions per user: 1778
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0086,  0.0385,  0.1296,  ...,  0.0006,  0.0052, -0.0087],
        [ 0.0086,  0.0385,  0.1296,  ...,  0.0006,  0.0052, -0.0087],
        [ 0.0099,  0.0410,  0.0828,  ...,  0.0024,  0.0062, -0.0088],
        ...,
        [ 0.0075,  0.0623,  0.1194,  ...,  0.0008, -0.0079,  0.0051],
        [ 0.0084,  0.0385,  0.1288,  ...,  0.0011,  0.0050, -0.0089],
        [ 0.0096,  0.0409,  0.0815,  ...,  0.0031,  0.0059, -0.0091]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1604
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0091,  0.0391,  0.1316,  ...,  0.0009,  0.0052, -0.0094],
        [ 0.0105,  0.0530,  0.0956,  ...,  0.0022, -0.0032,  0.0012],
        [ 0.0087,  0.0620,  0.1232,  ..., -0.0002, -0.0069,  0.0038],
        ...,
        [ 0.0103,  0.0530,  0.0943,  ...,  0.0029, -0.0035,  0.0010],
        [ 0.0077,  0.0571,  0.1417,  ..., -0.0014, -0.0026, -0.0020],
        [ 0.0103,  0.0530,  0.0943,  ...,  0.0029, -0.0035,  0.0010]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1647
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.0921e-02,  5.3144e-02,  9.7206e-02,  ...,  2.5795e-03,
         -2.9414e-03,  9.2291e-05],
        [ 9.1633e-03,  6.1874e-02,  1.2513e-01,  ..., -1.5115e-04,
         -5.9731e-03,  2.3398e-03],
        [ 8.3744e-03,  5.7375e-02,  1.4521e-01,  ..., -2.2261e-03,
         -1.4248e-03, -2.8632e-03],
        ...,
        [ 7.9350e-03,  5.7270e-02,  1.4305e-01,  ..., -1.0381e-03,
         -1.9375e-03, -3.2735e-03],
        [ 9.4397e-03,  6.1942e-02,  1.2649e-01,  ..., -8.9803e-04,
         -5.6507e-03,  2.5982e-03],
        [ 9.1633e-03,  6.1874e-02,  1.2513e-01,  ..., -1.5115e-04,
         -5.9731e-03,  2.3398e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1710
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.1641e-02,  4.2824e-02,  9.1288e-02,  ...,  2.5889e-03,
          5.4124e-03, -9.4155e-03],
        [ 8.5666e-03,  5.7521e-02,  1.4596e-01,  ..., -9.1400e-04,
         -8.8449e-04, -3.9407e-03],
        [ 9.8841e-03,  6.1826e-02,  1.2760e-01,  ...,  1.0426e-04,
         -4.9505e-03,  1.2939e-03],
        ...,
        [ 1.2027e-02,  5.3335e-02,  1.0151e-01,  ...,  1.8182e-03,
         -2.0330e-03, -2.7411e-04],
        [ 8.5666e-03,  5.7521e-02,  1.4596e-01,  ..., -9.1400e-04,
         -8.8449e-04, -3.9407e-03],
        [ 9.8841e-03,  6.1826e-02,  1.2760e-01,  ...,  1.0426e-04,
         -4.9505e-03,  1.2939e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1667
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.0938e-02,  6.1625e-02,  1.3118e-01,  ..., -5.4187e-04,
         -3.6187e-03,  6.6943e-04],
        [ 1.2526e-02,  5.3212e-02,  1.0267e-01,  ...,  2.4113e-03,
         -1.7875e-03, -1.0203e-03],
        [ 1.0036e-02,  4.0941e-02,  1.3754e-01,  ...,  2.1192e-03,
          5.8047e-03, -9.8447e-03],
        ...,
        [ 1.2649e-02,  5.3245e-02,  1.0330e-01,  ...,  2.0845e-03,
         -1.6363e-03, -9.0453e-04],
        [ 9.1690e-03,  5.7479e-02,  1.4768e-01,  ..., -5.2703e-04,
         -1.1647e-04, -4.5654e-03],
        [ 1.0638e-02,  6.1560e-02,  1.2972e-01,  ...,  2.1224e-04,
         -3.9705e-03,  4.2343e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1639
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0137,  0.0531,  0.1067,  ...,  0.0013, -0.0011, -0.0010],
        [ 0.0130,  0.0435,  0.0961,  ...,  0.0024,  0.0050, -0.0091],
        [ 0.0130,  0.0435,  0.0961,  ...,  0.0024,  0.0050, -0.0091],
        ...,
        [ 0.0134,  0.0530,  0.1052,  ...,  0.0021, -0.0014, -0.0013],
        [ 0.0101,  0.0576,  0.1493,  ..., -0.0003,  0.0004, -0.0049],
        [ 0.0101,  0.0576,  0.1493,  ..., -0.0003,  0.0004, -0.0049]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1682
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.1988e-02,  6.0970e-02,  1.3316e-01,  ..., -1.0861e-05,
         -2.8082e-03, -5.0389e-04],
        [ 1.0874e-02,  5.7745e-02,  1.5193e-01,  ..., -1.0438e-03,
          9.3270e-04, -4.7161e-03],
        [ 1.0277e-02,  5.7657e-02,  1.4905e-01,  ...,  4.1836e-04,
          2.5296e-04, -5.1859e-03],
        ...,
        [ 1.3765e-02,  5.2709e-02,  1.0707e-01,  ...,  1.6990e-03,
         -1.2874e-03, -1.3630e-03],
        [ 1.1330e-02,  4.2115e-02,  1.4039e-01,  ...,  2.4033e-03,
          5.2999e-03, -9.0650e-03],
        [ 1.1988e-02,  6.0970e-02,  1.3316e-01,  ..., -1.0861e-05,
         -2.8082e-03, -5.0389e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1670
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3655e-02,  4.3417e-02,  9.9773e-02,  ...,  1.3904e-03,
          4.0446e-03, -8.1611e-03],
        [ 1.1678e-02,  4.2166e-02,  1.4027e-01,  ...,  2.6896e-03,
          4.6061e-03, -8.7432e-03],
        [ 1.3987e-02,  4.3456e-02,  1.0133e-01,  ...,  6.1245e-04,
          4.4020e-03, -7.9087e-03],
        ...,
        [ 1.0905e-02,  5.7216e-02,  1.5019e-01,  ...,  1.6449e-05,
          4.1986e-04, -5.1726e-03],
        [ 1.4213e-02,  5.2104e-02,  1.0922e-01,  ...,  8.1978e-04,
         -1.1079e-03, -1.3270e-03],
        [ 1.3655e-02,  4.3417e-02,  9.9773e-02,  ...,  1.3904e-03,
          4.0446e-03, -8.1611e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1679
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.1815e-02,  5.6276e-02,  1.5288e-01,  ..., -1.3679e-03,
          8.2895e-04, -4.7543e-03],
        [ 1.2250e-02,  4.1749e-02,  1.4148e-01,  ...,  2.0477e-03,
          4.1505e-03, -8.0795e-03],
        [ 1.1199e-02,  5.6257e-02,  1.4996e-01,  ...,  1.1746e-04,
          1.6703e-04, -5.2235e-03],
        ...,
        [ 1.2515e-02,  5.8894e-02,  1.3399e-01,  ..., -2.4376e-04,
         -2.5784e-03, -1.1848e-03],
        [ 1.2515e-02,  5.8894e-02,  1.3399e-01,  ..., -2.4376e-04,
         -2.5784e-03, -1.1848e-03],
        [ 1.2695e-02,  5.8899e-02,  1.3481e-01,  ..., -6.5825e-04,
         -2.3909e-03, -1.0524e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1872
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.2689e-02,  4.1504e-02,  1.4273e-01,  ...,  1.3590e-03,
          3.8039e-03, -7.1261e-03],
        [ 1.2689e-02,  4.1504e-02,  1.4273e-01,  ...,  1.3590e-03,
          3.8039e-03, -7.1261e-03],
        [ 1.4199e-02,  5.0400e-02,  1.1036e-01,  ...,  6.2434e-04,
         -1.4923e-03, -1.2768e-03],
        ...,
        [ 1.4022e-02,  5.0405e-02,  1.0955e-01,  ...,  1.0324e-03,
         -1.6722e-03, -1.4097e-03],
        [ 1.3745e-02,  4.2679e-02,  1.0203e-01,  ...,  6.4313e-04,
          2.8706e-03, -7.0737e-03],
        [ 1.1410e-02,  5.5576e-02,  1.5009e-01,  ...,  4.0379e-05,
          8.2903e-05, -4.8884e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1676
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0133,  0.0414,  0.1421,  ...,  0.0014,  0.0031, -0.0062],
        [ 0.0149,  0.0500,  0.1121,  ..., -0.0002, -0.0013, -0.0007],
        [ 0.0130,  0.0414,  0.1406,  ...,  0.0022,  0.0028, -0.0064],
        ...,
        [ 0.0146,  0.0500,  0.1106,  ...,  0.0006, -0.0016, -0.0009],
        [ 0.0130,  0.0414,  0.1406,  ...,  0.0022,  0.0028, -0.0064],
        [ 0.0137,  0.0573,  0.1360,  ..., -0.0011, -0.0019, -0.0006]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1628
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.2681e-02,  5.4820e-02,  1.4893e-01,  ..., -1.9161e-04,
         -4.9304e-05, -3.5719e-03],
        [ 1.3603e-02,  4.1597e-02,  1.4124e-01,  ...,  1.2685e-03,
          2.5925e-03, -5.1018e-03],
        [ 1.4082e-02,  4.2869e-02,  1.0292e-01,  ...,  2.6505e-04,
          1.9102e-03, -5.4781e-03],
        ...,
        [ 1.4427e-02,  4.2849e-02,  1.0443e-01,  ..., -5.1811e-04,
          2.2425e-03, -5.2061e-03],
        [ 1.3260e-02,  4.1614e-02,  1.3973e-01,  ...,  2.0535e-03,
          2.2603e-03, -5.3702e-03],
        [ 1.3665e-02,  5.6929e-02,  1.3363e-01,  ..., -3.2654e-04,
         -2.1420e-03, -4.4113e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1690
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0127,  0.0544,  0.1474,  ..., -0.0002,  0.0002, -0.0028],
        [ 0.0131,  0.0416,  0.1385,  ...,  0.0019,  0.0021, -0.0042],
        [ 0.0139,  0.0563,  0.1333,  ..., -0.0007, -0.0015,  0.0002],
        ...,
        [ 0.0127,  0.0544,  0.1474,  ..., -0.0002,  0.0002, -0.0028],
        [ 0.0131,  0.0416,  0.1385,  ...,  0.0019,  0.0021, -0.0042],
        [ 0.0140,  0.0428,  0.1037,  ..., -0.0003,  0.0019, -0.0044]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1668
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0129,  0.0414,  0.1375,  ...,  0.0013,  0.0020, -0.0030],
        [ 0.0123,  0.0415,  0.1350,  ...,  0.0027,  0.0014, -0.0036],
        [ 0.0143,  0.0491,  0.1097,  ...,  0.0004, -0.0012,  0.0006],
        ...,
        [ 0.0147,  0.0491,  0.1111,  ..., -0.0004, -0.0008,  0.0009],
        [ 0.0135,  0.0558,  0.1312,  ..., -0.0003, -0.0013,  0.0006],
        [ 0.0142,  0.0492,  0.1089,  ...,  0.0008, -0.0013,  0.0005]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1587
Model output shape: torch.Size([349, 2810])
model output: tensor([[ 1.2734e-02,  4.3245e-02,  1.0202e-01,  ...,  1.8943e-04,
          1.3412e-03, -3.0614e-03],
        [ 1.3598e-02,  5.5396e-02,  1.2982e-01,  ..., -9.5380e-05,
         -8.6186e-04,  1.1056e-03],
        [ 1.3739e-02,  5.5380e-02,  1.3046e-01,  ..., -4.5316e-04,
         -7.0820e-04,  1.2513e-03],
        ...,
        [ 1.3012e-02,  5.3483e-02,  1.4503e-01,  ..., -9.8976e-04,
          9.8754e-04, -9.4736e-04],
        [ 1.2909e-02,  4.3213e-02,  1.0277e-01,  ..., -2.2269e-04,
          1.5195e-03, -2.9012e-03],
        [ 1.4126e-02,  4.8989e-02,  1.0917e-01,  ...,  5.2135e-04,
         -8.6562e-04,  1.2076e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([349])
Runing Epoch 003 train loss 0.1257 costs 00: 05: 30
------------------------------------------------------
max nr of interactions per user: 1709
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0130,  0.0529,  0.1424,  ..., -0.0006,  0.0011, -0.0003],
        [ 0.0129,  0.0411,  0.1337,  ...,  0.0013,  0.0017, -0.0010],
        [ 0.0132,  0.0410,  0.1350,  ...,  0.0005,  0.0021, -0.0007],
        ...,
        [ 0.0129,  0.0529,  0.1418,  ..., -0.0002,  0.0010, -0.0005],
        [ 0.0129,  0.0430,  0.1026,  ..., -0.0003,  0.0015, -0.0021],
        [ 0.0136,  0.0547,  0.1278,  ...,  0.0005, -0.0006,  0.0014]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1694
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3283e-02,  5.2639e-02,  1.4193e-01,  ..., -9.7496e-04,
          1.5125e-03,  5.2275e-04],
        [ 1.2848e-02,  4.3232e-02,  1.0276e-01,  ..., -3.1620e-04,
          1.4837e-03, -1.3891e-03],
        [ 1.4529e-02,  4.8342e-02,  1.0991e-01,  ...,  1.1744e-06,
          5.4638e-05,  2.5278e-03],
        ...,
        [ 1.3844e-02,  5.4408e-02,  1.2777e-01,  ...,  2.0592e-04,
         -6.3600e-06,  2.0822e-03],
        [ 1.4209e-02,  4.8409e-02,  1.0857e-01,  ...,  7.6813e-04,
         -2.8350e-04,  2.2129e-03],
        [ 1.3668e-02,  5.4449e-02,  1.2704e-01,  ...,  6.2249e-04,
         -1.9171e-04,  1.9111e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1682
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.4616e-02,  4.8277e-02,  1.0978e-01,  ...,  2.4246e-05,
          2.5451e-04,  2.9577e-03],
        [ 1.3141e-02,  4.3341e-02,  1.0420e-01,  ..., -1.2153e-03,
          1.7592e-03, -4.1238e-04],
        [ 1.4388e-02,  5.4214e-02,  1.2835e-01,  ..., -5.1405e-04,
          6.4113e-04,  2.7995e-03],
        ...,
        [ 1.2822e-02,  4.3410e-02,  1.0288e-01,  ..., -4.5392e-04,
          1.4220e-03, -7.3351e-04],
        [ 1.3090e-02,  4.1453e-02,  1.3153e-01,  ...,  8.5767e-04,
          1.5336e-03,  7.7206e-04],
        [ 1.3894e-02,  5.4323e-02,  1.2632e-01,  ...,  6.6699e-04,
          1.1535e-04,  2.3044e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1764
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3891e-02,  5.2626e-02,  1.3887e-01,  ..., -7.4152e-04,
          1.5257e-03,  1.5550e-03],
        [ 1.2969e-02,  4.3581e-02,  1.0304e-01,  ..., -5.2600e-04,
          1.2575e-03, -1.3091e-04],
        [ 1.4432e-02,  4.8205e-02,  1.0831e-01,  ...,  8.5380e-04,
         -8.3810e-06,  3.0246e-03],
        ...,
        [ 1.2969e-02,  4.3581e-02,  1.0304e-01,  ..., -5.2600e-04,
          1.2575e-03, -1.3091e-04],
        [ 1.3713e-02,  5.2667e-02,  1.3819e-01,  ..., -3.4038e-04,
          1.3509e-03,  1.3929e-03],
        [ 1.2676e-02,  4.3665e-02,  1.0184e-01,  ...,  1.9541e-04,
          9.4339e-04, -4.3933e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1582
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3238e-02,  4.3810e-02,  1.0327e-01,  ..., -3.5051e-04,
          1.1513e-03,  4.0942e-04],
        [ 1.3238e-02,  4.3810e-02,  1.0327e-01,  ..., -3.5051e-04,
          1.1513e-03,  4.0942e-04],
        [ 1.4086e-02,  4.2021e-02,  1.2957e-01,  ...,  5.9706e-04,
          1.0813e-03,  2.3108e-03],
        ...,
        [ 1.3056e-02,  4.3853e-02,  1.0258e-01,  ...,  6.2690e-05,
          9.6734e-04,  2.2594e-04],
        [ 1.4756e-02,  5.3835e-02,  1.2555e-01,  ...,  5.1380e-04,
          6.1755e-04,  3.1703e-03],
        [ 1.5080e-02,  5.3771e-02,  1.2681e-01,  ..., -2.3328e-04,
          9.4908e-04,  3.4983e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1646
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0144,  0.0420,  0.1290,  ...,  0.0006,  0.0009,  0.0029],
        [ 0.0132,  0.0438,  0.1031,  ...,  0.0004,  0.0009,  0.0006],
        [ 0.0150,  0.0477,  0.1091,  ...,  0.0011,  0.0004,  0.0037],
        ...,
        [ 0.0135,  0.0437,  0.1044,  ..., -0.0003,  0.0013,  0.0010],
        [ 0.0137,  0.0437,  0.1050,  ..., -0.0007,  0.0014,  0.0011],
        [ 0.0132,  0.0438,  0.1031,  ...,  0.0004,  0.0009,  0.0006]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1901
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0143,  0.0520,  0.1353,  ..., -0.0004,  0.0014,  0.0023],
        [ 0.0144,  0.0420,  0.1282,  ...,  0.0005,  0.0008,  0.0032],
        [ 0.0132,  0.0437,  0.1043,  ...,  0.0002,  0.0010,  0.0010],
        ...,
        [ 0.0146,  0.0474,  0.1088,  ...,  0.0016,  0.0003,  0.0036],
        [ 0.0143,  0.0520,  0.1353,  ..., -0.0004,  0.0014,  0.0023],
        [ 0.0130,  0.0437,  0.1037,  ...,  0.0006,  0.0008,  0.0008]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1692
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.2971e-02,  4.4034e-02,  1.0440e-01,  ...,  6.5595e-04,
          6.8431e-04,  1.0948e-03],
        [ 1.4527e-02,  5.2749e-02,  1.2424e-01,  ...,  6.5053e-04,
          9.5416e-04,  3.2817e-03],
        [ 1.4846e-02,  5.2685e-02,  1.2546e-01,  ..., -8.1913e-05,
          1.2778e-03,  3.6103e-03],
        ...,
        [ 1.4846e-02,  5.2685e-02,  1.2546e-01,  ..., -8.1913e-05,
          1.2778e-03,  3.6103e-03],
        [ 1.4747e-02,  4.7300e-02,  1.1034e-01,  ...,  9.2176e-04,
          6.3016e-04,  3.9591e-03],
        [ 1.4846e-02,  5.2685e-02,  1.2546e-01,  ..., -8.1913e-05,
          1.2778e-03,  3.6103e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1629
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3886e-02,  5.3107e-02,  1.3301e-01,  ..., -4.0792e-04,
          1.0666e-03,  2.3252e-03],
        [ 1.4197e-02,  5.3357e-02,  1.2401e-01,  ...,  5.4130e-04,
          1.0113e-03,  3.2534e-03],
        [ 1.2770e-02,  4.5056e-02,  1.0520e-01,  ...,  6.9924e-04,
          6.0043e-04,  1.3440e-03],
        ...,
        [ 1.4513e-02,  5.3311e-02,  1.2522e-01,  ..., -1.8904e-04,
          1.3334e-03,  3.5836e-03],
        [ 1.4388e-02,  4.3816e-02,  1.2701e-01,  ...,  3.7175e-05,
          2.8010e-04,  3.7494e-03],
        [ 1.4059e-02,  5.3076e-02,  1.3366e-01,  ..., -8.0230e-04,
          1.2414e-03,  2.5038e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1679
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.4203e-02,  4.4823e-02,  1.2640e-01,  ...,  3.2968e-04,
          7.5350e-05,  3.8406e-03],
        [ 1.3706e-02,  5.3750e-02,  1.3278e-01,  ..., -5.8580e-04,
          1.1601e-03,  2.4054e-03],
        [ 1.3031e-02,  4.5960e-02,  1.0773e-01,  ..., -1.6075e-04,
          1.0171e-03,  1.9463e-03],
        ...,
        [ 1.3588e-02,  5.3882e-02,  1.2291e-01,  ...,  1.0893e-03,
          8.7072e-04,  2.8927e-03],
        [ 1.3724e-02,  4.8714e-02,  1.0989e-01,  ...,  1.8441e-03,
          3.8129e-04,  3.5985e-03],
        [ 1.2546e-02,  4.6016e-02,  1.0588e-01,  ...,  9.4995e-04,
          5.2488e-04,  1.4367e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1714
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3524e-02,  4.9293e-02,  1.1061e-01,  ...,  1.4749e-03,
          5.9512e-04,  3.5184e-03],
        [ 1.3216e-02,  5.4282e-02,  1.3156e-01,  ..., -4.8301e-04,
          1.0701e-03,  2.1037e-03],
        [ 1.4159e-02,  4.5627e-02,  1.2664e-01,  ..., -2.0231e-04,
          2.0849e-04,  4.0487e-03],
        ...,
        [ 1.3038e-02,  4.9351e-02,  1.0875e-01,  ...,  2.6220e-03,
          9.4189e-05,  3.0112e-03],
        [ 1.3216e-02,  5.4282e-02,  1.3156e-01,  ..., -4.8301e-04,
          1.0701e-03,  2.1037e-03],
        [ 1.2458e-02,  4.6881e-02,  1.0693e-01,  ...,  6.9916e-04,
          6.4378e-04,  1.5324e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1698
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3123e-02,  5.4553e-02,  1.2301e-01,  ...,  2.4713e-04,
          1.2248e-03,  2.3414e-03],
        [ 1.2975e-02,  4.9741e-02,  1.0899e-01,  ...,  2.5509e-03,
          8.7238e-05,  2.6007e-03],
        [ 1.3272e-02,  4.9711e-02,  1.1016e-01,  ...,  1.8225e-03,
          4.0576e-04,  2.9214e-03],
        ...,
        [ 1.3480e-02,  4.6341e-02,  1.2467e-01,  ...,  6.4396e-04,
         -2.9016e-04,  3.4226e-03],
        [ 1.3272e-02,  4.9711e-02,  1.1016e-01,  ...,  1.8225e-03,
          4.0576e-04,  2.9214e-03],
        [ 1.3480e-02,  4.6341e-02,  1.2467e-01,  ...,  6.4396e-04,
         -2.9016e-04,  3.4226e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1671
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0123,  0.0481,  0.1083,  ...,  0.0010,  0.0007,  0.0011],
        [ 0.0124,  0.0550,  0.1311,  ..., -0.0006,  0.0014,  0.0015],
        [ 0.0130,  0.0469,  0.1242,  ...,  0.0013, -0.0002,  0.0032],
        ...,
        [ 0.0123,  0.0548,  0.1215,  ...,  0.0013,  0.0011,  0.0015],
        [ 0.0126,  0.0481,  0.1095,  ...,  0.0002,  0.0010,  0.0014],
        [ 0.0126,  0.0481,  0.1095,  ...,  0.0002,  0.0010,  0.0014]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1703
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.2582e-02,  5.0178e-02,  1.1134e-01,  ...,  2.0701e-03,
          6.9699e-04,  2.1847e-03],
        [ 1.2652e-02,  4.7131e-02,  1.2508e-01,  ...,  1.2948e-03,
          1.8693e-04,  3.1704e-03],
        [ 1.1774e-02,  5.4996e-02,  1.3057e-01,  ..., -7.7075e-05,
          1.5341e-03,  1.0241e-03],
        ...,
        [ 1.2652e-02,  4.7131e-02,  1.2508e-01,  ...,  1.2948e-03,
          1.8693e-04,  3.1704e-03],
        [ 1.2301e-02,  4.8504e-02,  1.1046e-01,  ...,  4.5306e-04,
          1.1009e-03,  1.2017e-03],
        [ 1.1774e-02,  5.4996e-02,  1.3057e-01,  ..., -7.7075e-05,
          1.5341e-03,  1.0241e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1771
Model output shape: torch.Size([349, 2810])
model output: tensor([[0.0116, 0.0551, 0.1305,  ..., 0.0004, 0.0017, 0.0006],
        [0.0121, 0.0489, 0.1106,  ..., 0.0013, 0.0008, 0.0007],
        [0.0122, 0.0548, 0.1236,  ..., 0.0008, 0.0018, 0.0010],
        ...,
        [0.0122, 0.0504, 0.1105,  ..., 0.0032, 0.0003, 0.0014],
        [0.0121, 0.0489, 0.1106,  ..., 0.0013, 0.0008, 0.0007],
        [0.0130, 0.0504, 0.1136,  ..., 0.0015, 0.0011, 0.0022]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([349])
Runing Epoch 004 train loss 0.1261 costs 00: 05: 30
------------------------------------------------------
max nr of interactions per user: 1816
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0116,  0.0479,  0.1237,  ...,  0.0032, -0.0003,  0.0021],
        [ 0.0129,  0.0505,  0.1146,  ...,  0.0014,  0.0011,  0.0018],
        [ 0.0120,  0.0548,  0.1241,  ...,  0.0008,  0.0018,  0.0006],
        ...,
        [ 0.0120,  0.0493,  0.1119,  ...,  0.0012,  0.0007,  0.0005],
        [ 0.0117,  0.0479,  0.1243,  ...,  0.0029, -0.0002,  0.0023],
        [ 0.0120,  0.0493,  0.1119,  ...,  0.0012,  0.0007,  0.0005]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1601
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0128,  0.0511,  0.1144,  ...,  0.0017,  0.0004,  0.0011],
        [ 0.0123,  0.0501,  0.1131,  ...,  0.0010,  0.0004,  0.0002],
        [ 0.0128,  0.0511,  0.1144,  ...,  0.0017,  0.0004,  0.0011],
        ...,
        [ 0.0109,  0.0561,  0.1306,  ...,  0.0006,  0.0012, -0.0005],
        [ 0.0106,  0.0561,  0.1295,  ...,  0.0012,  0.0008, -0.0008],
        [ 0.0116,  0.0554,  0.1233,  ...,  0.0013,  0.0011, -0.0003]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1926
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0109,  0.0499,  0.1250,  ...,  0.0030, -0.0010,  0.0015],
        [ 0.0117,  0.0559,  0.1251,  ...,  0.0005,  0.0010, -0.0004],
        [ 0.0114,  0.0559,  0.1240,  ...,  0.0011,  0.0007, -0.0007],
        ...,
        [ 0.0109,  0.0499,  0.1250,  ...,  0.0030, -0.0010,  0.0015],
        [ 0.0111,  0.0499,  0.1257,  ...,  0.0026, -0.0008,  0.0017],
        [ 0.0117,  0.0559,  0.1251,  ...,  0.0005,  0.0010, -0.0004]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1675
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 9.8567e-03,  5.7837e-02,  1.3022e-01,  ...,  1.0893e-03,
          7.0630e-05, -1.2782e-03],
        [ 1.0500e-02,  5.1163e-02,  1.2554e-01,  ...,  2.8140e-03,
         -1.3522e-03,  1.4465e-03],
        [ 1.2254e-02,  5.1560e-02,  1.1565e-01,  ...,  2.5700e-04,
         -2.3161e-04, -1.9557e-05],
        ...,
        [ 1.0500e-02,  5.1163e-02,  1.2554e-01,  ...,  2.8140e-03,
         -1.3522e-03,  1.4465e-03],
        [ 1.3158e-02,  5.2194e-02,  1.1768e-01,  ...,  3.4049e-04,
          3.7953e-05,  9.7108e-04],
        [ 1.1162e-02,  5.6552e-02,  1.2403e-01,  ...,  1.0923e-03,
          2.0561e-04, -9.6394e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1638
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.0534e-02,  5.2385e-02,  1.2723e-01,  ...,  1.7710e-03,
         -1.1235e-03,  1.6230e-03],
        [ 1.2634e-02,  5.2368e-02,  1.1810e-01,  ..., -9.5523e-04,
          1.6479e-05,  1.8879e-04],
        [ 1.2365e-02,  5.2315e-02,  1.1692e-01,  ..., -3.1162e-04,
         -2.6048e-04, -8.1819e-05],
        ...,
        [ 1.0137e-02,  5.2308e-02,  1.2549e-01,  ...,  2.7226e-03,
         -1.5333e-03,  1.2272e-03],
        [ 1.2365e-02,  5.2315e-02,  1.1692e-01,  ..., -3.1162e-04,
         -2.6048e-04, -8.1819e-05],
        [ 9.9645e-03,  5.8820e-02,  1.3180e-01,  ...,  1.1967e-06,
          3.1739e-04, -1.1644e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1695
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.0151e-02,  5.3241e-02,  1.2628e-01,  ...,  1.9424e-03,
         -1.3270e-03,  1.4446e-03],
        [ 1.2730e-02,  5.3188e-02,  1.1879e-01,  ..., -1.5051e-03,
          1.2258e-04,  2.6473e-04],
        [ 1.2902e-02,  5.3233e-02,  1.1682e-01,  ...,  5.7823e-04,
         -4.6767e-04,  3.0402e-04],
        ...,
        [ 1.1408e-02,  5.7713e-02,  1.2552e-01,  ..., -2.8054e-04,
          4.1253e-04, -9.7820e-04],
        [ 9.6593e-03,  5.9435e-02,  1.3074e-01,  ...,  1.5154e-04,
          1.1281e-04, -1.3842e-03],
        [ 1.1673e-02,  5.7777e-02,  1.2670e-01,  ..., -9.2124e-04,
          6.8748e-04, -7.0927e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1633
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.0174e-02,  5.3623e-02,  1.2628e-01,  ...,  1.4201e-03,
         -1.2133e-03,  1.4958e-03],
        [ 1.3658e-02,  5.3339e-02,  1.1860e-01,  ..., -6.5400e-04,
         -6.3605e-05,  6.4513e-04],
        [ 1.0008e-02,  5.9666e-02,  1.3142e-01,  ..., -7.4182e-04,
          3.7888e-04, -1.1859e-03],
        ...,
        [ 1.0044e-02,  5.3597e-02,  1.2572e-01,  ...,  1.7271e-03,
         -1.3448e-03,  1.3663e-03],
        [ 1.0030e-02,  5.9655e-02,  1.3144e-01,  ..., -7.5395e-04,
          3.8194e-04, -1.1987e-03],
        [ 1.2790e-02,  5.3360e-02,  1.1814e-01,  ..., -1.3782e-03,
         -4.6451e-05,  4.8577e-05]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1796
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3727e-02,  5.2995e-02,  1.1905e-01,  ..., -7.7836e-04,
         -3.0982e-05,  6.2086e-04],
        [ 1.3877e-02,  5.3034e-02,  1.1975e-01,  ..., -1.1619e-03,
          1.3074e-04,  7.9211e-04],
        [ 1.3598e-02,  5.2973e-02,  1.1850e-01,  ..., -4.7328e-04,
         -1.6141e-04,  4.9060e-04],
        ...,
        [ 9.7972e-03,  5.3507e-02,  1.2616e-01,  ...,  1.3474e-03,
         -1.1456e-03,  1.4901e-03],
        [ 1.1790e-02,  5.7304e-02,  1.2586e-01,  ..., -7.9721e-04,
          5.3477e-04, -9.8612e-04],
        [ 1.1790e-02,  5.7304e-02,  1.2586e-01,  ..., -7.9721e-04,
          5.3477e-04, -9.8612e-04]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1635
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.2424e-02,  5.6733e-02,  1.2683e-01,  ..., -1.3380e-03,
          9.4087e-04, -8.6890e-04],
        [ 1.2424e-02,  5.6733e-02,  1.2683e-01,  ..., -1.3380e-03,
          9.4087e-04, -8.6890e-04],
        [ 1.3975e-02,  5.2431e-02,  1.1927e-01,  ..., -7.6726e-04,
          1.1826e-04,  4.8188e-04],
        ...,
        [ 1.2711e-02,  5.2906e-02,  1.1844e-01,  ..., -1.3646e-03,
          2.2186e-05, -2.2533e-04],
        [ 1.2711e-02,  5.2906e-02,  1.1844e-01,  ..., -1.3646e-03,
          2.2186e-05, -2.2533e-04],
        [ 9.9666e-03,  5.8880e-02,  1.3008e-01,  ..., -2.9497e-04,
          3.9068e-04, -1.5196e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1680
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3313e-02,  5.2643e-02,  1.1996e-01,  ..., -2.1759e-03,
          5.4031e-04,  8.2090e-05],
        [ 1.0381e-02,  5.3269e-02,  1.2476e-01,  ...,  1.3806e-03,
         -8.9043e-04,  1.2716e-03],
        [ 1.3050e-02,  5.2602e-02,  1.1884e-01,  ..., -1.5623e-03,
          2.7815e-04, -1.7880e-04],
        ...,
        [ 1.0427e-02,  5.8448e-02,  1.2861e-01,  ...,  1.8457e-04,
          4.0405e-04, -1.7290e-03],
        [ 1.0711e-02,  5.8496e-02,  1.2984e-01,  ..., -4.9997e-04,
          6.9728e-04, -1.4319e-03],
        [ 1.2623e-02,  5.6036e-02,  1.2453e-01,  ..., -1.7501e-04,
          6.8639e-04, -1.3401e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1618
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3123e-02,  5.2228e-02,  1.1848e-01,  ..., -1.2303e-03,
          4.1358e-04, -2.4803e-04],
        [ 1.3096e-02,  5.5216e-02,  1.2412e-01,  ...,  9.2421e-05,
          9.8152e-04, -1.2729e-03],
        [ 1.0766e-02,  5.2955e-02,  1.2457e-01,  ...,  1.0016e-03,
         -4.5665e-04,  1.4481e-03],
        ...,
        [ 1.0553e-02,  5.7766e-02,  1.2652e-01,  ...,  1.0546e-03,
          3.9924e-04, -1.9796e-03],
        [ 1.3357e-02,  5.5249e-02,  1.2522e-01,  ..., -5.1353e-04,
          1.2444e-03, -1.0157e-03],
        [ 1.1007e-02,  5.7811e-02,  1.2850e-01,  ..., -6.5944e-05,
          8.7934e-04, -1.5002e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1655
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 1.3058e-02,  5.1976e-02,  1.1903e-01,  ..., -1.1327e-03,
          8.0581e-04, -1.4807e-04],
        [ 1.3160e-02,  5.1981e-02,  1.1942e-01,  ..., -1.3467e-03,
          9.0111e-04, -6.4402e-05],
        [ 1.4539e-02,  5.0686e-02,  1.1825e-01,  ...,  5.5802e-04,
          6.2028e-04,  2.8817e-04],
        ...,
        [ 1.1018e-02,  5.7297e-02,  1.2681e-01,  ...,  7.0428e-04,
          9.6630e-04, -1.7243e-03],
        [ 1.2902e-02,  5.1957e-02,  1.1834e-01,  ..., -7.5175e-04,
          6.3862e-04, -3.2011e-04],
        [ 1.1018e-02,  5.7297e-02,  1.2681e-01,  ...,  7.0428e-04,
          9.6630e-04, -1.7243e-03]], device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1686
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0110,  0.0563,  0.1255,  ...,  0.0011,  0.0012, -0.0018],
        [ 0.0132,  0.0536,  0.1224,  ...,  0.0012,  0.0014, -0.0014],
        [ 0.0129,  0.0515,  0.1190,  ..., -0.0008,  0.0011, -0.0002],
        ...,
        [ 0.0132,  0.0536,  0.1224,  ...,  0.0012,  0.0014, -0.0014],
        [ 0.0133,  0.0536,  0.1231,  ...,  0.0008,  0.0016, -0.0012],
        [ 0.0146,  0.0499,  0.1183,  ...,  0.0007,  0.0010,  0.0004]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1713
Model output shape: torch.Size([400, 2810])
model output: tensor([[ 0.0131,  0.0529,  0.1221,  ...,  0.0012,  0.0017, -0.0012],
        [ 0.0124,  0.0513,  0.1185,  ..., -0.0004,  0.0012, -0.0002],
        [ 0.0122,  0.0513,  0.1174,  ...,  0.0002,  0.0009, -0.0005],
        ...,
        [ 0.0120,  0.0513,  0.1170,  ...,  0.0004,  0.0008, -0.0006],
        [ 0.0122,  0.0513,  0.1174,  ...,  0.0002,  0.0009, -0.0005],
        [ 0.0124,  0.0513,  0.1185,  ..., -0.0004,  0.0012, -0.0002]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([400])
max nr of interactions per user: 1729
Model output shape: torch.Size([349, 2810])
model output: tensor([[ 0.0119,  0.0512,  0.1183,  ..., -0.0003,  0.0014, -0.0003],
        [ 0.0106,  0.0546,  0.1229,  ...,  0.0012,  0.0016, -0.0017],
        [ 0.0116,  0.0512,  0.1173,  ...,  0.0003,  0.0012, -0.0005],
        ...,
        [ 0.0115,  0.0512,  0.1168,  ...,  0.0006,  0.0010, -0.0006],
        [ 0.0094,  0.0509,  0.1170,  ...,  0.0032, -0.0004,  0.0005],
        [ 0.0129,  0.0520,  0.1216,  ...,  0.0011,  0.0021, -0.0010]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
Shape of the weights: torch.Size([349])
[Valid]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0117
0.0115
0.0104
0.0101
 0.0075
0.0141
0.0308
0.0566
 0.013
0.0148
0.0205
0.0301
 0.0335
0.039
0.0441
0.0464

[Test]: Precisions (4), Recalls (4), NDCGs (4), MRRs (4):

0.0069
0.0067
0.0061
0.0056
 0.0083
0.0157
0.035
0.0602
 0.0086
0.0111
0.0176
0.0256
 0.0185
0.0222
0.0259
0.0277

Runing Epoch 005 train loss 0.1254 costs 00: 05: 32
------------------------------------------------------
